WIKIDOT.modules.CreateAccountModule={};WIKIDOT.modules.CreateAccountModule.vars={};WIKIDOT.modules.CreateAccountModule.listeners={cancel:function(b){var a=getQueryString("origUrl","/");window.location.href=a},nextClick:function(d,b){if(!b){b=0}WIKIDOT.modules.CreateAccountModule.vars.formName=b;WIKIDOT.modules.CreateAccountModule.vars.formData=OZONE.utils.formToArray("createaccount-form"+b);var c=OZONE.utils.formToArray("createaccount-form"+b);c.action="CreateAccount3Action";c.event="step0";OZONE.ajax.requestModule(null,c,WIKIDOT.modules.CreateAccountModule.callbacks.nextClick);var a=new OZONE.dialogs.WaitBox();a.content="Validating data...";a.show()},createAccountFBC:function(c,a,d){var b=$j('input[name="fbApiKey"]').val();FB.init({appId:b,status:true,cookie:true,xfbml:true,oauth:true});FB.login(function(e){if(e.authResponse){FB.api("/me",function(g){if(g!=null){var f=new OZONE.dialogs.WaitBox();f.content="Waiting...";f.show();var h=OZONE.utils.formToArray("createaccountfbc-form0");if(!h){h=new Object();if(c){h.start=c}if(a){h.originSiteId=a}if(d){h.invitationHash=d}}h.fbUser=g;h.action="CreateAccount3Action";h.event="createAccountFBC";OZONE.ajax.requestModule(null,h,WIKIDOT.modules.CreateAccountModule.callbacks.createAccountFBC)}})}},{scope:"email"})}};WIKIDOT.modules.CreateAccountModule.callbacks={nextClick:function(e){if(e.status=="form_errors"){OZONE.dialog.cleanAll();var a="<h2>Error!</h2><ul>";var f=e.formErrors;for(var b in f){a+="<li>"+f[b]+"</li>"}a+="</ul>";$j("h1.title,p.login-hint").hide()}if((e.status=="form_errors")||(e.status=="email_failed")){if(typeof(Recaptcha)!="undefined"){Recaptcha.reload()}if(e.captcha){$j("#createaccount-captcha").html(e.captcha)}if(e.timeNow){$j('input[name="time"]').val(e.timeNow)}OZONE.dialog.cleanAll();$("ca-reg"+WIKIDOT.modules.CreateAccountModule.vars.formName+"-errors").style.display="block";$j("#ca-reg"+WIKIDOT.modules.CreateAccountModule.vars.formName+"-errors").html(a);return}if(!WIKIDOT.utils.handleError(e)){return}var d=e.uri;if(e.skipEmailConfirmation){var c=new OZONE.dialogs.SuccessBox();c.timeout=10000;c.content="New account created!";c.show();if(!d){d="/default--flow/login__CreateAccount3Screen"}}if(!d){d="/default--flow/login__CreateAccount2Screen"}setTimeout(function(){window.location.href=d},2000)},createAccountFBC:function(a){if(a.newUrl){window.location.href=a.newUrl+"/afterlogin.php";return}if(a.start){var b=a.originSite||WIKIREQUEST.info.siteId;var g=USE_SSL?"https":"http";var c=g+"://"+URL_HOST+"/default--flow/login__CreateAccountFBCScreen?originSiteId="+b;if(a.invitationHash){c+="&invitationHash="+a.invitationHash}var j=window.location.href=c;j.focus();return}if(a.status=="form_errors"){OZONE.dialog.cleanAll();var k="The data you have submitted contains following errors:<ul>";var h=a.formErrors;for(var e in h){k+="<li>"+h[e]+"</li>"}k+="</ul>";$j("#cafbc-reg0-errors").show();$j("#cafbc-reg0-errors").html(k);$j("h1.title,p.login-hint").hide();return}if(!WIKIDOT.utils.handleError(a)){return}var d=a.uri;var f=new OZONE.dialogs.SuccessBox();f.timeout=10000;f.content="New account created!";f.show();setTimeout(function(){window.location.href=d;return},2000)}};WIKIDOT.modules.CreateAccountModule.init=function(){if(WIKIDOT.modules.CreateAccountModule.vars.formData!=null){p=WIKIDOT.modules.CreateAccountModule.vars.formData;document.forms.caform.name.value=p.name;document.forms.caform.password.value=p.password;document.forms.caform.password2.value=p.password2;document.forms.caform.email.value=p.email;document.forms.caform.captcha.value=p.captcha;if(p.language=="en"){$("new-site-lang-en").checked=true}else{$("new-site-lang-pl").checked=true}document.forms.caform.tos.checked=true}};WIKIDOT.modules.CreateAccountModule.init();function getQueryString(b,d){if(d==null){d=""}b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=new RegExp("[\\?&]"+b+"=([^&#]*)");var a=c.exec(window.location.href);if(a==null){return d}else{return decodeURIComponent(a[1])}};