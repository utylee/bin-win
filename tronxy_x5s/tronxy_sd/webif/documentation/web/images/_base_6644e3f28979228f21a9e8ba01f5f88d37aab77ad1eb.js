var Prototype={Version:"1.7",Browser:function(){var a=navigator.userAgent,b=Object.prototype.toString.call(window.opera)=="[object Opera]";return{IE:!!window.attachEvent&&!b,Opera:b,WebKit:a.indexOf("AppleWebKit/")>-1,Gecko:a.indexOf("Gecko")>-1&&a.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile/.test(a)}}(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:function(){var a=window.Element||window.HTMLElement;return!!(a&&a.prototype)}(),SpecificElementExtensions:function(){if(typeof window.HTMLDivElement!==
"undefined")return true;var a=document.createElement("div"),b=document.createElement("form"),c=false;if(a.__proto__&&a.__proto__!==b.__proto__)c=true;return c}()},ScriptFragment:"<script[^>]*>([\\S\\s]*?)<\/script>",JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(a){return a}};if(Prototype.Browser.MobileSafari)Prototype.BrowserFeatures.SpecificElementExtensions=false;
var Abstract={},Try={these:function(){for(var a,b=0,c=arguments.length;b<c;b++){var d=arguments[b];try{a=d();break}catch(e){}}return a}},Class=function(){function a(){}function b(){function e(){this.initialize.apply(this,arguments)}var g=null,n=$A(arguments);if(Object.isFunction(n[0]))g=n.shift();Object.extend(e,Class.Methods);e.superclass=g;e.subclasses=[];if(g){a.prototype=g.prototype;e.prototype=new a;g.subclasses.push(e)}g=0;for(var l=n.length;g<l;g++)e.addMethods(n[g]);if(!e.prototype.initialize)e.prototype.initialize=
Prototype.emptyFunction;return e.prototype.constructor=e}function c(e){var g=this.superclass&&this.superclass.prototype,n=Object.keys(e);if(d){e.toString!=Object.prototype.toString&&n.push("toString");e.valueOf!=Object.prototype.valueOf&&n.push("valueOf")}for(var l=0,m=n.length;l<m;l++){var r=n[l],B=e[r];if(g&&Object.isFunction(B)&&B.argumentNames()[0]=="$super"){var z=B;B=function(E){return function(){return g[E].apply(this,arguments)}}(r).wrap(z);B.valueOf=z.valueOf.bind(z);B.toString=z.toString.bind(z)}this.prototype[r]=
B}return this}var d=function(){for(var e in{toString:1})if(e==="toString")return false;return true}();return{create:b,Methods:{addMethods:c}}}();
(function(){function a(u){switch(u){case null:return k;case void 0:return p}switch(typeof u){case "boolean":return o;case "number":return t;case "string":return x}return v}function b(u,A){for(var G in A)u[G]=A[G];return u}function c(u){try{if(j(u))return"undefined";if(u===null)return"null";return u.inspect?u.inspect():String(u)}catch(A){if(A instanceof RangeError)return"...";throw A;}}function d(u){return e("",{"":u},[])}function e(u,A,G){A=A[u];var I=typeof A;if(a(A)===v&&typeof A.toJSON==="function")A=
A.toJSON(u);u=f.call(A);switch(u){case M:case K:case N:A=A.valueOf()}switch(A){case null:return"null";case true:return"true";case false:return"false"}I=typeof A;switch(I){case "string":return A.inspect(true);case "number":return isFinite(A)?String(A):"null";case "object":I=0;for(var L=G.length;I<L;I++)if(G[I]===A)throw new TypeError;G.push(A);var O=[];if(u===q){I=0;for(L=A.length;I<L;I++){var P=e(I,A,G);O.push(typeof P==="undefined"?"null":P)}O="["+O.join(",")+"]"}else{var Q=Object.keys(A);I=0;for(L=
Q.length;I<L;I++){u=Q[I];P=e(u,A,G);typeof P!=="undefined"&&O.push(u.inspect(true)+":"+P)}O="{"+O.join(",")+"}"}G.pop();return O}}function g(u){return JSON.stringify(u)}function n(u){return $H(u).toQueryString()}function l(u){return u&&u.toHTML?u.toHTML():String.interpret(u)}function m(u){if(a(u)!==v)throw new TypeError;var A=[];for(var G in u)u.hasOwnProperty(G)&&A.push(G);return A}function r(u){var A=[];for(var G in u)A.push(u[G]);return A}function B(u){return b({},u)}function z(u){return!!(u&&
u.nodeType==1)}function E(u){return f.call(u)===q}function F(u){return u instanceof Hash}function J(u){return f.call(u)===H}function D(u){return f.call(u)===N}function y(u){return f.call(u)===M}function h(u){return f.call(u)===C}function j(u){return typeof u==="undefined"}var f=Object.prototype.toString,k="Null",p="Undefined",o="Boolean",t="Number",x="String",v="Object",H="[object Function]",K="[object Boolean]",M="[object Number]",N="[object String]",q="[object Array]",C="[object Date]",w=window.JSON&&
typeof JSON.stringify==="function"&&JSON.stringify(0)==="0"&&typeof JSON.stringify(Prototype.K)==="undefined";if(typeof Array.isArray=="function"&&Array.isArray([])&&!Array.isArray({}))E=Array.isArray;b(Object,{extend:b,inspect:c,toJSON:w?g:d,toQueryString:n,toHTML:l,keys:Object.keys||m,values:r,clone:B,isElement:z,isArray:E,isHash:F,isFunction:J,isString:D,isNumber:y,isDate:h,isUndefined:j})})();
Object.extend(Function.prototype,function(){function a(z,E){for(var F=z.length,J=E.length;J--;)z[F+J]=E[J];return z}function b(z,E){z=B.call(z,0);return a(z,E)}function c(){var z=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return z.length==1&&!z[0]?[]:z}function d(z){if(arguments.length<2&&Object.isUndefined(arguments[0]))return this;var E=this,F=B.call(arguments,1);return function(){var J=b(F,arguments);
return E.apply(z,J)}}function e(z){var E=this,F=B.call(arguments,1);return function(J){J=a([J||window.event],F);return E.apply(z,J)}}function g(){if(!arguments.length)return this;var z=this,E=B.call(arguments,0);return function(){var F=b(E,arguments);return z.apply(this,F)}}function n(z){var E=this,F=B.call(arguments,1);z*=1E3;return window.setTimeout(function(){return E.apply(E,F)},z)}function l(){return this.delay.apply(this,a([0.01],arguments))}function m(z){var E=this;return function(){var F=
a([E.bind(this)],arguments);return z.apply(this,F)}}function r(){if(this._methodized)return this._methodized;var z=this;return this._methodized=function(){var E=a([this],arguments);return z.apply(null,E)}}var B=Array.prototype.slice;return{argumentNames:c,bind:d,bindAsEventListener:e,curry:g,delay:n,defer:l,wrap:m,methodize:r}}());
(function(a){function b(){return this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+"Z"}function c(){return this.toISOString()}if(!a.toISOString)a.toISOString=b;if(!a.toJSON)a.toJSON=c})(Date.prototype);RegExp.prototype.match=RegExp.prototype.test;
RegExp.escape=function(a){return String(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")};
var PeriodicalExecuter=Class.create({initialize:function(a,b){this.callback=a;this.frequency=b;this.currentlyExecuting=false;this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1E3)},execute:function(){this.callback(this)},stop:function(){if(this.timer){clearInterval(this.timer);this.timer=null}},onTimerEvent:function(){if(!this.currentlyExecuting)try{this.currentlyExecuting=true;this.execute();this.currentlyExecuting=false}catch(a){this.currentlyExecuting=
false;throw a;}}});Object.extend(String,{interpret:function(a){return a==null?"":String(a)},specialChar:{"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r","\\":"\\\\"}});
Object.extend(String.prototype,function(){function a(w){if(Object.isFunction(w))return w;var u=new Template(w);return function(A){return u.evaluate(A)}}function b(w,u){var A="",G=this,I;u=a(u);if(Object.isString(w))w=RegExp.escape(w);if(!(w.length||w.source)){u=u("");return u+G.split("").join(u)+u}for(;G.length>0;)if(I=G.match(w)){A+=G.slice(0,I.index);A+=String.interpret(u(I));G=G.slice(I.index+I[0].length)}else{A+=G;G=""}return A}function c(w,u,A){u=a(u);A=Object.isUndefined(A)?1:A;return this.gsub(w,
function(G){if(--A<0)return G[0];return u(G)})}function d(w,u){this.gsub(w,u);return String(this)}function e(w,u){w=w||30;u=Object.isUndefined(u)?"...":u;return this.length>w?this.slice(0,w-u.length)+u:String(this)}function g(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}function n(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")}function l(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"")}function m(){var w=new RegExp(Prototype.ScriptFragment,"img"),
u=new RegExp(Prototype.ScriptFragment,"im");return(this.match(w)||[]).map(function(A){return(A.match(u)||["",""])[1]})}function r(){return this.extractScripts().map(function(w){return eval(w)})}function B(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function z(){return this.stripTags().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function E(w){var u=this.strip().match(/([^?#]*)(#.*)?$/);if(!u)return{};return u[1].split(w||"&").inject({},function(A,
G){if((G=G.split("="))[0]){var I=decodeURIComponent(G.shift());G=G.length>1?G.join("="):G[0];if(G!=undefined)G=decodeURIComponent(G);if(I in A){Object.isArray(A[I])||(A[I]=[A[I]]);A[I].push(G)}else A[I]=G}return A})}function F(){return this.split("")}function J(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-1)+1)}function D(w){return w<1?"":(new Array(w+1)).join(this)}function y(){return this.replace(/-+(.)?/g,function(w,u){return u?u.toUpperCase():""})}function h(){return this.charAt(0).toUpperCase()+
this.substring(1).toLowerCase()}function j(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()}function f(){return this.replace(/_/g,"-")}function k(w){var u=this.replace(/[\x00-\x1f\\]/g,function(A){if(A in String.specialChar)return String.specialChar[A];return"\\u00"+A.charCodeAt().toPaddedString(2,16)});if(w)return'"'+u.replace(/"/g,'\\"')+'"';return"'"+u.replace(/'/g,"\\'")+"'"}function p(w){return this.replace(w||
Prototype.JSONFilter,"$1")}function o(){var w=this;if(w.blank())return false;w=w.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@");w=w.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]");w=w.replace(/(?:^|:|,)(?:\s*\[)+/g,"");return/^[\],:{}\s]*$/.test(w)}function t(w){var u=this.unfilterJSON(),A=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;if(A.test(u))u=u.replace(A,function(I){return"\\u"+("0000"+I.charCodeAt(0).toString(16)).slice(-4)});
try{if(!w||u.isJSON())return eval("("+u+")")}catch(G){}throw new SyntaxError("Badly formed JSON string: "+this.inspect());}function x(){var w=this.unfilterJSON();return JSON.parse(w)}function v(w){return this.indexOf(w)>-1}function H(w){return this.lastIndexOf(w,0)===0}function K(w){var u=this.length-w.length;return u>=0&&this.indexOf(w,u)===u}function M(){return this==""}function N(){return/^\s*$/.test(this)}function q(w,u){return(new Template(this,u)).evaluate(w)}var C=window.JSON&&typeof JSON.parse===
"function"&&JSON.parse('{"test": true}').test;return{gsub:b,sub:c,scan:d,truncate:e,strip:String.prototype.trim||g,stripTags:n,stripScripts:l,extractScripts:m,evalScripts:r,escapeHTML:B,unescapeHTML:z,toQueryParams:E,parseQuery:E,toArray:F,succ:J,times:D,camelize:y,capitalize:h,underscore:j,dasherize:f,inspect:k,unfilterJSON:p,isJSON:o,evalJSON:C?x:t,include:v,startsWith:H,endsWith:K,empty:M,blank:N,interpolate:q}}());
var Template=Class.create({initialize:function(a,b){this.template=a.toString();this.pattern=b||Template.Pattern},evaluate:function(a){if(a&&Object.isFunction(a.toTemplateReplacements))a=a.toTemplateReplacements();return this.template.gsub(this.pattern,function(b){if(a==null)return b[1]+"";var c=b[1]||"";if(c=="\\")return b[2];var d=a,e=b[3],g=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;b=g.exec(e);if(b==null)return c;for(;b!=null;){var n=b[1].startsWith("[")?b[2].replace(/\\\\]/g,"]"):b[1];d=d[n];if(null==
d||""==b[3])break;e=e.substring("["==b[3]?b[1].length:b[0].length);b=g.exec(e)}return c+String.interpret(d)})}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;
var $break={},Enumerable=function(){function a(o,t){var x=0;try{this._each(function(H){o.call(t,H,x++)})}catch(v){if(v!=$break)throw v;}return this}function b(o,t,x){var v=-o,H=[],K=this.toArray();if(o<1)return K;for(;(v+=o)<K.length;)H.push(K.slice(v,v+o));return H.collect(t,x)}function c(o,t){o=o||Prototype.K;var x=true;this.each(function(v,H){x=x&&!!o.call(t,v,H);if(!x)throw $break;});return x}function d(o,t){o=o||Prototype.K;var x=false;this.each(function(v,H){if(x=!!o.call(t,v,H))throw $break;
});return x}function e(o,t){o=o||Prototype.K;var x=[];this.each(function(v,H){x.push(o.call(t,v,H))});return x}function g(o,t){var x;this.each(function(v,H){if(o.call(t,v,H)){x=v;throw $break;}});return x}function n(o,t){var x=[];this.each(function(v,H){o.call(t,v,H)&&x.push(v)});return x}function l(o,t,x){t=t||Prototype.K;var v=[];if(Object.isString(o))o=new RegExp(RegExp.escape(o));this.each(function(H,K){o.match(H)&&v.push(t.call(x,H,K))});return v}function m(o){if(Object.isFunction(this.indexOf))if(this.indexOf(o)!=
-1)return true;var t=false;this.each(function(x){if(x==o){t=true;throw $break;}});return t}function r(o,t){t=Object.isUndefined(t)?null:t;return this.eachSlice(o,function(x){for(;x.length<o;)x.push(t);return x})}function B(o,t,x){this.each(function(v,H){o=t.call(x,o,v,H)});return o}function z(o){var t=$A(arguments).slice(1);return this.map(function(x){return x[o].apply(x,t)})}function E(o,t){o=o||Prototype.K;var x;this.each(function(v,H){v=o.call(t,v,H);if(x==null||v>=x)x=v});return x}function F(o,
t){o=o||Prototype.K;var x;this.each(function(v,H){v=o.call(t,v,H);if(x==null||v<x)x=v});return x}function J(o,t){o=o||Prototype.K;var x=[],v=[];this.each(function(H,K){(o.call(t,H,K)?x:v).push(H)});return[x,v]}function D(o){var t=[];this.each(function(x){t.push(x[o])});return t}function y(o,t){var x=[];this.each(function(v,H){o.call(t,v,H)||x.push(v)});return x}function h(o,t){return this.map(function(x,v){return{value:x,criteria:o.call(t,x,v)}}).sort(function(x,v){x=x.criteria;v=v.criteria;return x<
v?-1:x>v?1:0}).pluck("value")}function j(){return this.map()}function f(){var o=Prototype.K,t=$A(arguments);if(Object.isFunction(t.last()))o=t.pop();var x=[this].concat(t).map($A);return this.map(function(v,H){return o(x.pluck(H))})}function k(){return this.toArray().length}function p(){return"#<Enumerable:"+this.toArray().inspect()+">"}return{each:a,eachSlice:b,all:c,every:c,any:d,some:d,collect:e,map:e,detect:g,findAll:n,select:n,filter:n,grep:l,include:m,member:m,inGroupsOf:r,inject:B,invoke:z,
max:E,min:F,partition:J,pluck:D,reject:y,sortBy:h,toArray:j,entries:j,zip:f,size:k,inspect:p,find:g}}();function $A(a){if(!a)return[];if("toArray"in Object(a))return a.toArray();for(var b=a.length||0,c=new Array(b);b--;)c[b]=a[b];return c}function $w(a){if(!Object.isString(a))return[];return(a=a.strip())?a.split(/\s+/):[]}Array.from=$A;
(function(){function a(f,k){for(var p=0,o=this.length>>>0;p<o;p++)p in this&&f.call(k,this[p],p,this)}function b(){this.length=0;return this}function c(){return this[0]}function d(){return this[this.length-1]}function e(){return this.select(function(f){return f!=null})}function g(){return this.inject([],function(f,k){if(Object.isArray(k))return f.concat(k.flatten());f.push(k);return f})}function n(){var f=h.call(arguments,0);return this.select(function(k){return!f.include(k)})}function l(f){return(f===
false?this.toArray():this)._reverse()}function m(f){return this.inject([],function(k,p,o){if(0==o||(f?k.last()!=p:!k.include(p)))k.push(p);return k})}function r(f){return this.uniq().findAll(function(k){return f.detect(function(p){return k===p})})}function B(){return h.call(this,0)}function z(){return this.length}function E(){return"["+this.map(Object.inspect).join(", ")+"]"}function F(f,k){k||(k=0);var p=this.length;if(k<0)k=p+k;for(;k<p;k++)if(this[k]===f)return k;return-1}function J(f,k){k=isNaN(k)?
this.length:(k<0?this.length+k:k)+1;f=this.slice(0,k).reverse().indexOf(f);return f<0?f:k-f-1}function D(){for(var f=h.call(this,0),k,p=0,o=arguments.length;p<o;p++){k=arguments[p];if(Object.isArray(k)&&!("callee"in k))for(var t=0,x=k.length;t<x;t++)f.push(k[t]);else f.push(k)}return f}var y=Array.prototype,h=y.slice,j=y.forEach;j||(j=a);Object.extend(y,Enumerable);if(!y._reverse)y._reverse=y.reverse;Object.extend(y,{_each:j,clear:b,first:c,last:d,compact:e,flatten:g,without:n,reverse:l,uniq:m,intersect:r,
clone:B,toArray:B,size:z,inspect:E});if(function(){return[].concat(arguments)[0][0]!==1}(1,2))y.concat=D;if(!y.indexOf)y.indexOf=F;if(!y.lastIndexOf)y.lastIndexOf=J})();function $H(a){return new Hash(a)}
var Hash=Class.create(Enumerable,function(){function a(D){this._object=Object.isHash(D)?D.toObject():Object.clone(D)}function b(D){for(var y in this._object){var h=this._object[y],j=[y,h];j.key=y;j.value=h;D(j)}}function c(D,y){return this._object[D]=y}function d(D){if(this._object[D]!==Object.prototype[D])return this._object[D]}function e(D){var y=this._object[D];delete this._object[D];return y}function g(){return Object.clone(this._object)}function n(){return this.pluck("key")}function l(){return this.pluck("value")}
function m(D){var y=this.detect(function(h){return h.value===D});return y&&y.key}function r(D){return this.clone().update(D)}function B(D){return(new Hash(D)).inject(this,function(y,h){y.set(h.key,h.value);return y})}function z(D,y){if(Object.isUndefined(y))return D;return D+"="+encodeURIComponent(String.interpret(y))}function E(){return this.inject([],function(D,y){var h=encodeURIComponent(y.key);if((y=y.value)&&typeof y=="object"){if(Object.isArray(y)){for(var j=[],f=0,k=y.length,p;f<k;f++){p=y[f];
j.push(z(h,p))}return D.concat(j)}}else D.push(z(h,y));return D}).join("&")}function F(){return"#<Hash:{"+this.map(function(D){return D.map(Object.inspect).join(": ")}).join(", ")+"}>"}function J(){return new Hash(this)}return{initialize:a,_each:b,set:c,get:d,unset:e,toObject:g,toTemplateReplacements:g,keys:n,values:l,index:m,merge:r,update:B,toQueryString:E,inspect:F,toJSON:g,clone:J}}());Hash.from=$H;
Object.extend(Number.prototype,function(){function a(){return this.toPaddedString(2,16)}function b(){return this+1}function c(m,r){$R(0,this,true).each(m,r);return this}function d(m,r){r=this.toString(r||10);return"0".times(m-r.length)+r}function e(){return Math.abs(this)}function g(){return Math.round(this)}function n(){return Math.ceil(this)}function l(){return Math.floor(this)}return{toColorPart:a,succ:b,times:c,toPaddedString:d,abs:e,round:g,ceil:n,floor:l}}());
function $R(a,b,c){return new ObjectRange(a,b,c)}
var ObjectRange=Class.create(Enumerable,function(){function a(d,e,g){this.start=d;this.end=e;this.exclusive=g}function b(d){for(var e=this.start;this.include(e);){d(e);e=e.succ()}}function c(d){if(d<this.start)return false;if(this.exclusive)return d<this.end;return d<=this.end}return{initialize:a,_each:b,include:c}}()),Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||
false},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(a){this.responders._each(a)},register:function(a){this.include(a)||this.responders.push(a)},unregister:function(a){this.responders=this.responders.without(a)},dispatch:function(a,b,c,d){this.each(function(e){if(Object.isFunction(e[a]))try{e[a].apply(e,[b,c,d])}catch(g){}})}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}});
Ajax.Base=Class.create({initialize:function(a){this.options={method:"post",asynchronous:true,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:"",evalJSON:true,evalJS:true};Object.extend(this.options,a||{});this.options.method=this.options.method.toLowerCase();if(Object.isHash(this.options.parameters))this.options.parameters=this.options.parameters.toObject()}});
Ajax.Request=Class.create(Ajax.Base,{_complete:false,initialize:function($super,b,c){$super(c);this.transport=Ajax.getTransport();this.request(b)},request:function(a){this.url=a;this.method=this.options.method;a=Object.isString(this.options.parameters)?this.options.parameters:Object.toQueryString(this.options.parameters);if(!["get","post"].include(this.method)){a+=(a?"&":"")+"_method="+this.method;this.method="post"}if(a&&this.method==="get")this.url+=(this.url.include("?")?"&":"?")+a;this.parameters=
a.toQueryParams();try{var b=new Ajax.Response(this);this.options.onCreate&&this.options.onCreate(b);Ajax.Responders.dispatch("onCreate",this,b);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);this.options.asynchronous&&this.respondToReadyState.bind(this).defer(1);this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();this.body=this.method=="post"?this.options.postBody||a:null;this.transport.send(this.body);!this.options.asynchronous&&
this.transport.overrideMimeType&&this.onStateChange()}catch(c){this.dispatchException(c)}},onStateChange:function(){var a=this.transport.readyState;a>1&&!(a==4&&this._complete)&&this.respondToReadyState(this.transport.readyState)},setRequestHeaders:function(){var a={"X-Requested-With":"XMLHttpRequest","X-Prototype-Version":Prototype.Version,Accept:"text/javascript, text/html, application/xml, text/xml, */*"};if(this.method=="post"){a["Content-type"]=this.options.contentType+(this.options.encoding?
"; charset="+this.options.encoding:"");if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005)a.Connection="close"}if(typeof this.options.requestHeaders=="object"){var b=this.options.requestHeaders;if(Object.isFunction(b.push))for(var c=0,d=b.length;c<d;c+=2)a[b[c]]=b[c+1];else $H(b).each(function(g){a[g.key]=g.value})}for(var e in a)this.transport.setRequestHeader(e,a[e])},success:function(){var a=this.getStatus();return!a||a>=200&&a<300||a==304},getStatus:function(){try{if(this.transport.status===
1223)return 204;return this.transport.status||0}catch(a){return 0}},respondToReadyState:function(a){a=Ajax.Request.Events[a];var b=new Ajax.Response(this);if(a=="Complete"){try{this._complete=true;(this.options["on"+b.status]||this.options["on"+(this.success()?"Success":"Failure")]||Prototype.emptyFunction)(b,b.headerJSON)}catch(c){this.dispatchException(c)}var d=b.getHeader("Content-type");if(this.options.evalJS=="force"||this.options.evalJS&&this.isSameOrigin()&&d&&d.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i))this.evalResponse()}try{(this.options["on"+
a]||Prototype.emptyFunction)(b,b.headerJSON);Ajax.Responders.dispatch("on"+a,this,b,b.headerJSON)}catch(e){this.dispatchException(e)}if(a=="Complete")this.transport.onreadystatechange=Prototype.emptyFunction},isSameOrigin:function(){var a=this.url.match(/^\s*https?:\/\/[^\/]*/);return!a||a[0]=="#{protocol}//#{domain}#{port}".interpolate({protocol:location.protocol,domain:document.domain,port:location.port?":"+location.port:""})},getHeader:function(a){try{return this.transport.getResponseHeader(a)||
null}catch(b){return null}},evalResponse:function(){try{return eval((this.transport.responseText||"").unfilterJSON())}catch(a){this.dispatchException(a)}},dispatchException:function(a){(this.options.onException||Prototype.emptyFunction)(this,a);Ajax.Responders.dispatch("onException",this,a)}});Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];
Ajax.Response=Class.create({initialize:function(a){this.request=a;a=this.transport=a.transport;var b=this.readyState=a.readyState;if(b>2&&!Prototype.Browser.IE||b==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=String.interpret(a.responseText);this.headerJSON=this._getHeaderJSON()}if(b==4){a=a.responseXML;this.responseXML=Object.isUndefined(a)?null:a;this.responseJSON=this._getResponseJSON()}},status:0,statusText:"",getStatus:Ajax.Request.prototype.getStatus,
getStatusText:function(){try{return this.transport.statusText||""}catch(a){return""}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders()}catch(a){return null}},getResponseHeader:function(a){return this.transport.getResponseHeader(a)},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders()},_getHeaderJSON:function(){var a=this.getHeader("X-JSON");if(!a)return null;a=decodeURIComponent(escape(a));try{return a.evalJSON(this.request.options.sanitizeJSON||
!this.request.isSameOrigin())}catch(b){this.request.dispatchException(b)}},_getResponseJSON:function(){var a=this.request.options;if(!a.evalJSON||a.evalJSON!="force"&&!(this.getHeader("Content-type")||"").include("application/json")||this.responseText.blank())return null;try{return this.responseText.evalJSON(a.sanitizeJSON||!this.request.isSameOrigin())}catch(b){this.request.dispatchException(b)}}});
Ajax.Updater=Class.create(Ajax.Request,{initialize:function($super,b,c,d){this.container={success:b.success||b,failure:b.failure||(b.success?null:b)};d=Object.clone(d);var e=d.onComplete;d.onComplete=function(g,n){this.updateContent(g.responseText);Object.isFunction(e)&&e(g,n)}.bind(this);$super(c,d)},updateContent:function(a){var b=this.container[this.success()?"success":"failure"],c=this.options;c.evalScripts||(a=a.stripScripts());if(b=$(b))if(c.insertion)if(Object.isString(c.insertion)){var d=
{};d[c.insertion]=a;b.insert(d)}else c.insertion(b,a);else b.update(a)}});
Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function($super,b,c,d){$super(d);this.onComplete=this.options.onComplete;this.frequency=this.options.frequency||2;this.decay=this.options.decay||1;this.updater={};this.container=b;this.url=c;this.start()},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent()},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments)},
updateComplete:function(a){if(this.options.decay){this.decay=a.responseText==this.lastText?this.decay*this.options.decay:1;this.lastText=a.responseText}this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency)},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options)}});
function $(a){if(arguments.length>1){for(var b=0,c=[],d=arguments.length;b<d;b++)c.push($(arguments[b]));return c}if(Object.isString(a))a=document.getElementById(a);return Element.extend(a)}if(Prototype.BrowserFeatures.XPath)document._getElementsByXPath=function(a,b){var c=[];a=document.evaluate(a,$(b)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);b=0;for(var d=a.snapshotLength;b<d;b++)c.push(Element.extend(a.snapshotItem(b)));return c};if(!Node)var Node={};
Node.ELEMENT_NODE||Object.extend(Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12});
(function(a){function b(e,g){if(e==="select")return false;if("type"in g)return false;return true}var c=function(){try{var e=document.createElement('<input name="x">');return e.tagName.toLowerCase()==="input"&&e.name==="x"}catch(g){return false}}(),d=a.Element;a.Element=function(e,g){g=g||{};e=e.toLowerCase();var n=Element.cache;if(c&&g.name){e="<"+e+' name="'+g.name+'">';delete g.name;return Element.writeAttribute(document.createElement(e),g)}n[e]||(n[e]=Element.extend(document.createElement(e)));
e=b(e,g)?n[e].cloneNode(false):document.createElement(e);return Element.writeAttribute(e,g)};Object.extend(a.Element,d||{});if(d)a.Element.prototype=d.prototype})(this);Element.idCounter=1;Element.cache={};Element._purgeElement=function(a){var b=a._prototypeUID;if(b){Element.stopObserving(a);a._prototypeUID=void 0;delete Element.Storage[b]}};
Element.Methods={visible:function(a){return $(a).style.display!="none"},toggle:function(a){a=$(a);Element[Element.visible(a)?"hide":"show"](a);return a},hide:function(a){a=$(a);a.style.display="none";return a},show:function(a){a=$(a);a.style.display="";return a},remove:function(a){a=$(a);a.parentNode.removeChild(a);return a},update:function(){function a(n,l){n=$(n);for(var m=Element._purgeElement,r=n.getElementsByTagName("*"),B=r.length;B--;)m(r[B]);if(l&&l.toElement)l=l.toElement();if(Object.isElement(l))return n.update().insert(l);
l=Object.toHTML(l);m=n.tagName.toUpperCase();if(m==="SCRIPT"&&g){n.text=l;return n}if(e)if(m in Element._insertionTranslations.tags){for(;n.firstChild;)n.removeChild(n.firstChild);Element._getContentFromAnonymousElement(m,l.stripScripts()).each(function(z){n.appendChild(z)})}else if(d&&Object.isString(l)&&l.indexOf("<link")>-1){for(;n.firstChild;)n.removeChild(n.firstChild);Element._getContentFromAnonymousElement(m,l.stripScripts(),true).each(function(z){n.appendChild(z)})}else n.innerHTML=l.stripScripts();
else n.innerHTML=l.stripScripts();l.evalScripts.bind(l).defer();return n}var b=function(){var n=document.createElement("select"),l=true;n.innerHTML='<option value="test">test</option>';if(n.options&&n.options[0])l=n.options[0].nodeName.toUpperCase()!=="OPTION";return l}(),c=function(){try{var n=document.createElement("table");if(n&&n.tBodies){n.innerHTML="<tbody><tr><td>test</td></tr></tbody>";return typeof n.tBodies[0]=="undefined"}}catch(l){return true}}(),d=function(){try{var n=document.createElement("div");
n.innerHTML="<link>";return n.childNodes.length===0}catch(l){return true}}(),e=b||c||d,g=function(){var n=document.createElement("script"),l=false;try{n.appendChild(document.createTextNode(""));l=!n.firstChild||n.firstChild&&n.firstChild.nodeType!==3}catch(m){l=true}return l}();return a}(),replace:function(a,b){a=$(a);if(b&&b.toElement)b=b.toElement();else if(!Object.isElement(b)){b=Object.toHTML(b);var c=a.ownerDocument.createRange();c.selectNode(a);b.evalScripts.bind(b).defer();b=c.createContextualFragment(b.stripScripts())}a.parentNode.replaceChild(b,
a);return a},insert:function(a,b){a=$(a);if(Object.isString(b)||Object.isNumber(b)||Object.isElement(b)||b&&(b.toElement||b.toHTML))b={bottom:b};var c,d,e;for(var g in b){c=b[g];g=g.toLowerCase();d=Element._insertionTranslations[g];if(c&&c.toElement)c=c.toElement();if(Object.isElement(c))d(a,c);else{c=Object.toHTML(c);e=(g=="before"||g=="after"?a.parentNode:a).tagName.toUpperCase();e=Element._getContentFromAnonymousElement(e,c.stripScripts());if(g=="top"||g=="after")e.reverse();e.each(d.curry(a));
c.evalScripts.bind(c).defer()}}return a},wrap:function(a,b,c){a=$(a);if(Object.isElement(b))$(b).writeAttribute(c||{});else b=Object.isString(b)?new Element(b,c):new Element("div",b);a.parentNode&&a.parentNode.replaceChild(b,a);b.appendChild(a);return b},inspect:function(a){a=$(a);var b="<"+a.tagName.toLowerCase();$H({id:"id",className:"class"}).each(function(c){var d=c.first();c=c.last();if(d=(a[d]||"").toString())b+=" "+c+"="+d.inspect(true)});return b+">"},recursivelyCollect:function(a,b,c){a=
$(a);c=c||-1;for(var d=[];a=a[b];){a.nodeType==1&&d.push(Element.extend(a));if(d.length==c)break}return d},ancestors:function(a){return Element.recursivelyCollect(a,"parentNode")},descendants:function(a){return Element.select(a,"*")},firstDescendant:function(a){for(a=$(a).firstChild;a&&a.nodeType!=1;)a=a.nextSibling;return $(a)},immediateDescendants:function(a){var b=[];for(a=$(a).firstChild;a;){a.nodeType===1&&b.push(Element.extend(a));a=a.nextSibling}return b},previousSiblings:function(a){return Element.recursivelyCollect(a,
"previousSibling")},nextSiblings:function(a){return Element.recursivelyCollect(a,"nextSibling")},siblings:function(a){a=$(a);return Element.previousSiblings(a).reverse().concat(Element.nextSiblings(a))},match:function(a,b){a=$(a);if(Object.isString(b))return Prototype.Selector.match(a,b);return b.match(a)},up:function(a,b,c){a=$(a);if(arguments.length==1)return $(a.parentNode);var d=Element.ancestors(a);return Object.isNumber(b)?d[b]:Prototype.Selector.find(d,b,c)},down:function(a,b,c){a=$(a);if(arguments.length==
1)return Element.firstDescendant(a);return Object.isNumber(b)?Element.descendants(a)[b]:Element.select(a,b)[c||0]},previous:function(a,b,c){a=$(a);if(Object.isNumber(b)){c=b;b=false}Object.isNumber(c)||(c=0);return b?Prototype.Selector.find(a.previousSiblings(),b,c):a.recursivelyCollect("previousSibling",c+1)[c]},next:function(a,b,c){a=$(a);if(Object.isNumber(b)){c=b;b=false}Object.isNumber(c)||(c=0);if(b)return Prototype.Selector.find(a.nextSiblings(),b,c);else{Object.isNumber(c);return a.recursivelyCollect("nextSibling",
c+1)[c]}},select:function(a){a=$(a);var b=Array.prototype.slice.call(arguments,1).join(", ");return Prototype.Selector.select(b,a)},adjacent:function(a){a=$(a);var b=Array.prototype.slice.call(arguments,1).join(", ");return Prototype.Selector.select(b,a.parentNode).without(a)},identify:function(a){a=$(a);var b=Element.readAttribute(a,"id");if(b)return b;do b="anonymous_element_"+Element.idCounter++;while($(b));Element.writeAttribute(a,"id",b);return b},readAttribute:function(a,b){a=$(a);if(Prototype.Browser.IE){var c=
Element._attributeTranslations.read;if(c.values[b])return c.values[b](a,b);if(c.names[b])b=c.names[b];if(b.include(":"))return!a.attributes||!a.attributes[b]?null:a.attributes[b].value}return a.getAttribute(b)},writeAttribute:function(a,b,c){a=$(a);var d={},e=Element._attributeTranslations.write;if(typeof b=="object")d=b;else d[b]=Object.isUndefined(c)?true:c;for(var g in d){b=e.names[g]||g;c=d[g];if(e.values[g])b=e.values[g](a,c);if(c===false||c===null)a.removeAttribute(b);else c===true?a.setAttribute(b,
b):a.setAttribute(b,c)}return a},getHeight:function(a){return Element.getDimensions(a).height},getWidth:function(a){return Element.getDimensions(a).width},classNames:function(a){return new Element.ClassNames(a)},hasClassName:function(a,b){if(a=$(a)){a=a.className;return a.length>0&&(a==b||(new RegExp("(^|\\s)"+b+"(\\s|$)")).test(a))}},addClassName:function(a,b){if(a=$(a)){Element.hasClassName(a,b)||(a.className+=(a.className?" ":"")+b);return a}},removeClassName:function(a,b){if(a=$(a)){a.className=
a.className.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)")," ").strip();return a}},toggleClassName:function(a,b){if(a=$(a))return Element[Element.hasClassName(a,b)?"removeClassName":"addClassName"](a,b)},cleanWhitespace:function(a){a=$(a);for(var b=a.firstChild;b;){var c=b.nextSibling;b.nodeType==3&&!/\S/.test(b.nodeValue)&&a.removeChild(b);b=c}return a},empty:function(a){return $(a).innerHTML.blank()},descendantOf:function(a,b){a=$(a);b=$(b);if(a.compareDocumentPosition)return(a.compareDocumentPosition(b)&
8)===8;if(b.contains)return b.contains(a)&&b!==a;for(;a=a.parentNode;)if(a==b)return true;return false},scrollTo:function(a){a=$(a);var b=Element.cumulativeOffset(a);window.scrollTo(b[0],b[1]);return a},getStyle:function(a,b){a=$(a);b=b=="float"?"cssFloat":b.camelize();var c=a.style[b];if(!c||c=="auto")c=(a=document.defaultView.getComputedStyle(a,null))?a[b]:null;if(b=="opacity")return c?parseFloat(c):1;return c=="auto"?null:c},getOpacity:function(a){return $(a).getStyle("opacity")},setStyle:function(a,
b){a=$(a);var c=a.style;if(Object.isString(b)){a.style.cssText+=";"+b;return b.include("opacity")?a.setOpacity(b.match(/opacity:\s*(\d?\.?\d*)/)[1]):a}for(var d in b)if(d=="opacity")a.setOpacity(b[d]);else c[d=="float"||d=="cssFloat"?Object.isUndefined(c.styleFloat)?"cssFloat":"styleFloat":d]=b[d];return a},setOpacity:function(a,b){a=$(a);a.style.opacity=b==1||b===""?"":b<1.0E-5?0:b;return a},makePositioned:function(a){a=$(a);var b=Element.getStyle(a,"position");if(b=="static"||!b){a._madePositioned=
true;a.style.position="relative";if(Prototype.Browser.Opera){a.style.top=0;a.style.left=0}}return a},undoPositioned:function(a){a=$(a);if(a._madePositioned){a._madePositioned=undefined;a.style.position=a.style.top=a.style.left=a.style.bottom=a.style.right=""}return a},makeClipping:function(a){a=$(a);if(a._overflow)return a;a._overflow=Element.getStyle(a,"overflow")||"auto";if(a._overflow!=="hidden")a.style.overflow="hidden";return a},undoClipping:function(a){a=$(a);if(!a._overflow)return a;a.style.overflow=
a._overflow=="auto"?"":a._overflow;a._overflow=null;return a},clonePosition:function(a,b,c){c=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},c||{});b=$(b);var d=Element.viewportOffset(b),e=[0,0],g=null;a=$(a);if(Element.getStyle(a,"position")=="absolute"){g=Element.getOffsetParent(a);e=Element.viewportOffset(g)}if(g==document.body){e[0]-=document.body.offsetLeft;e[1]-=document.body.offsetTop}if(c.setLeft)a.style.left=d[0]-e[0]+c.offsetLeft+"px";if(c.setTop)a.style.top=
d[1]-e[1]+c.offsetTop+"px";if(c.setWidth)a.style.width=b.offsetWidth+"px";if(c.setHeight)a.style.height=b.offsetHeight+"px";return a}};Object.extend(Element.Methods,{getElementsBySelector:Element.Methods.select,childElements:Element.Methods.immediateDescendants});Element._attributeTranslations={write:{names:{className:"class",htmlFor:"for"},values:{}}};
if(Prototype.Browser.Opera){Element.Methods.getStyle=Element.Methods.getStyle.wrap(function(a,b,c){switch(c){case "height":case "width":if(!Element.visible(b))return null;var d=parseInt(a(b,c),10);if(d!==b["offset"+c.capitalize()])return d+"px";return(c==="height"?["border-top-width","padding-top","padding-bottom","border-bottom-width"]:["border-left-width","padding-left","padding-right","border-right-width"]).inject(d,function(e,g){g=a(b,g);return g===null?e:e-parseInt(g,10)})+"px";default:return a(b,
c)}});Element.Methods.readAttribute=Element.Methods.readAttribute.wrap(function(a,b,c){if(c==="title")return b.title;return a(b,c)})}else if(Prototype.Browser.IE){Element.Methods.getStyle=function(a,b){a=$(a);b=b=="float"||b=="cssFloat"?"styleFloat":b.camelize();var c=a.style[b];if(!c&&a.currentStyle)c=a.currentStyle[b];if(b=="opacity"){if(c=(a.getStyle("filter")||"").match(/alpha\(opacity=(.*)\)/))if(c[1])return parseFloat(c[1])/100;return 1}if(c=="auto"){if((b=="width"||b=="height")&&a.getStyle("display")!=
"none")return a["offset"+b.capitalize()]+"px";return null}return c};Element.Methods.setOpacity=function(a,b){function c(g){return g.replace(/alpha\([^\)]*\)/gi,"")}a=$(a);var d=a.currentStyle;if(d&&!d.hasLayout||!d&&a.style.zoom=="normal")a.style.zoom=1;d=a.getStyle("filter");var e=a.style;if(b==1||b===""){(d=c(d))?(e.filter=d):e.removeAttribute("filter");return a}else if(b<1.0E-5)b=0;e.filter=c(d)+"alpha(opacity="+b*100+")";return a};Element._attributeTranslations=function(){var a="className",b=
"for",c=document.createElement("div");c.setAttribute(a,"x");if(c.className!=="x"){c.setAttribute("class","x");if(c.className==="x")a="class"}c=null;c=document.createElement("label");c.setAttribute(b,"x");if(c.htmlFor!=="x"){c.setAttribute("htmlFor","x");if(c.htmlFor==="x")b="htmlFor"}c=null;return{read:{names:{"class":a,className:a,"for":b,htmlFor:b},values:{_getAttr:function(d,e){return d.getAttribute(e)},_getAttr2:function(d,e){return d.getAttribute(e,2)},_getAttrNode:function(d,e){return(d=d.getAttributeNode(e))?
d.value:""},_getEv:function(){var d=document.createElement("div"),e;d.onclick=Prototype.emptyFunction;d=d.getAttribute("onclick");if(String(d).indexOf("{")>-1)e=function(g,n){n=g.getAttribute(n);if(!n)return null;n=n.toString();n=n.split("{")[1];n=n.split("}")[0];return n.strip()};else if(d==="")e=function(g,n){n=g.getAttribute(n);if(!n)return null;return n.strip()};d=null;return e}(),_flag:function(d,e){return $(d).hasAttribute(e)?e:null},style:function(d){return d.style.cssText.toLowerCase()},title:function(d){return d.title}}}}}();
Element._attributeTranslations.write={names:Object.extend({cellpadding:"cellPadding",cellspacing:"cellSpacing"},Element._attributeTranslations.read.names),values:{checked:function(a,b){a.checked=!!b},style:function(a,b){a.style.cssText=b?b:""}}};Element._attributeTranslations.has={};$w("colSpan rowSpan vAlign dateTime accessKey tabIndex encType maxLength readOnly longDesc frameBorder").each(function(a){Element._attributeTranslations.write.names[a.toLowerCase()]=a;Element._attributeTranslations.has[a.toLowerCase()]=
a});(function(a){Object.extend(a,{href:a._getAttr2,src:a._getAttr2,type:a._getAttr,action:a._getAttrNode,disabled:a._flag,checked:a._flag,readonly:a._flag,multiple:a._flag,onload:a._getEv,onunload:a._getEv,onclick:a._getEv,ondblclick:a._getEv,onmousedown:a._getEv,onmouseup:a._getEv,onmouseover:a._getEv,onmousemove:a._getEv,onmouseout:a._getEv,onfocus:a._getEv,onblur:a._getEv,onkeypress:a._getEv,onkeydown:a._getEv,onkeyup:a._getEv,onsubmit:a._getEv,onreset:a._getEv,onselect:a._getEv,onchange:a._getEv})})(Element._attributeTranslations.read.values);
Prototype.BrowserFeatures.ElementExtensions&&function(){function a(b){b=b.getElementsByTagName("*");for(var c=[],d=0,e;e=b[d];d++)e.tagName!=="!"&&c.push(e);return c}Element.Methods.down=function(b,c,d){b=$(b);if(arguments.length==1)return b.firstDescendant();return Object.isNumber(c)?a(b)[c]:Element.select(b,c)[d||0]}}()}else if(Prototype.Browser.Gecko&&/rv:1\.8\.0/.test(navigator.userAgent))Element.Methods.setOpacity=function(a,b){a=$(a);a.style.opacity=b==1?0.999999:b===""?"":b<1.0E-5?0:b;return a};
else if(Prototype.Browser.WebKit)Element.Methods.setOpacity=function(a,b){a=$(a);a.style.opacity=b==1||b===""?"":b<1.0E-5?0:b;if(b==1)if(a.tagName.toUpperCase()=="IMG"&&a.width){a.width++;a.width--}else try{var c=document.createTextNode(" ");a.appendChild(c);a.removeChild(c)}catch(d){}return a};
if("outerHTML"in document.documentElement)Element.Methods.replace=function(a,b){a=$(a);if(b&&b.toElement)b=b.toElement();if(Object.isElement(b)){a.parentNode.replaceChild(b,a);return a}b=Object.toHTML(b);var c=a.parentNode,d=c.tagName.toUpperCase();if(Element._insertionTranslations.tags[d]){var e=a.next();d=Element._getContentFromAnonymousElement(d,b.stripScripts());c.removeChild(a);e?d.each(function(g){c.insertBefore(g,e)}):d.each(function(g){c.appendChild(g)})}else a.outerHTML=b.stripScripts();
b.evalScripts.bind(b).defer();return a};Element._returnOffset=function(a,b){var c=[a,b];c.left=a;c.top=b;return c};Element._getContentFromAnonymousElement=function(a,b,c){var d=new Element("div");a=Element._insertionTranslations.tags[a];var e=false;if(a)e=true;else if(c){e=true;a=["","",0]}if(e){d.innerHTML="&nbsp;"+a[0]+b+a[1];d.removeChild(d.firstChild);for(b=a[2];b--;)d=d.firstChild}else d.innerHTML=b;return $A(d.childNodes)};
Element._insertionTranslations={before:function(a,b){a.parentNode.insertBefore(b,a)},top:function(a,b){a.insertBefore(b,a.firstChild)},bottom:function(a,b){a.appendChild(b)},after:function(a,b){a.parentNode.insertBefore(b,a.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}};
(function(){var a=Element._insertionTranslations.tags;Object.extend(a,{THEAD:a.TBODY,TFOOT:a.TBODY,TH:a.TD})})();Element.Methods.Simulated={hasAttribute:function(a,b){b=Element._attributeTranslations.has[b]||b;a=$(a).getAttributeNode(b);return!!(a&&a.specified)}};Element.Methods.ByTag={};Object.extend(Element,Element.Methods);
(function(a){if(!Prototype.BrowserFeatures.ElementExtensions&&a.__proto__){window.HTMLElement={};window.HTMLElement.prototype=a.__proto__;Prototype.BrowserFeatures.ElementExtensions=true}})(document.createElement("div"));
Element.extend=function(){function a(g){if(typeof window.Element!="undefined"){var n=window.Element.prototype;if(n){var l="_"+(Math.random()+"").slice(2);g=document.createElement(g);n[l]="x";g=g[l]!=="x";delete n[l];return g}}return false}function b(g,n){for(var l in n){var m=n[l];if(Object.isFunction(m)&&!(l in g))g[l]=m.methodize()}}var c=a("object");if(Prototype.BrowserFeatures.SpecificElementExtensions){if(c)return function(g){if(g&&typeof g._extendedByPrototype=="undefined"){var n=g.tagName;
if(n&&/^(?:object|applet|embed)$/i.test(n)){b(g,Element.Methods);b(g,Element.Methods.Simulated);b(g,Element.Methods.ByTag[n.toUpperCase()])}}return g};return Prototype.K}var d={},e=Element.Methods.ByTag;c=Object.extend(function(g){if(!g||typeof g._extendedByPrototype!="undefined"||g.nodeType!=1||g==window)return g;var n=Object.clone(d),l=g.tagName.toUpperCase();e[l]&&Object.extend(n,e[l]);b(g,n);g._extendedByPrototype=Prototype.emptyFunction;return g},{refresh:function(){if(!Prototype.BrowserFeatures.ElementExtensions){Object.extend(d,
Element.Methods);Object.extend(d,Element.Methods.Simulated)}}});c.refresh();return c}();Element.hasAttribute=document.documentElement.hasAttribute?function(a,b){return a.hasAttribute(b)}:Element.Methods.Simulated.hasAttribute;
Element.addMethods=function(a){function b(m){m=m.toUpperCase();Element.Methods.ByTag[m]||(Element.Methods.ByTag[m]={});Object.extend(Element.Methods.ByTag[m],a)}function c(m,r,B){B=B||false;for(var z in m){var E=m[z];if(Object.isFunction(E))if(!B||!(z in r))r[z]=E.methodize()}}function d(m){var r,B={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:"Heading",H2:"Heading",H3:"Heading",H4:"Heading",H5:"Heading",H6:"Heading",
Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:"TableSection",TFOOT:"TableSection",TBODY:"TableSection",TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"};if(B[m])r="HTML"+B[m]+"Element";if(window[r])return window[r];r="HTML"+m+"Element";if(window[r])return window[r];r="HTML"+m.capitalize()+"Element";if(window[r])return window[r];m=document.createElement(m);return m.__proto__||m.constructor.prototype}
var e=Prototype.BrowserFeatures,g=Element.Methods.ByTag;if(!a){Object.extend(Form,Form.Methods);Object.extend(Form.Element,Form.Element.Methods);Object.extend(Element.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods),BUTTON:Object.clone(Form.Element.Methods)})}if(arguments.length==2){var n=a;a=arguments[1]}if(n)Object.isArray(n)?n.each(b):b(n);else Object.extend(Element.Methods,
a||{});n=window.HTMLElement?HTMLElement.prototype:Element.prototype;if(e.ElementExtensions){c(Element.Methods,n);c(Element.Methods.Simulated,n,true)}if(e.SpecificElementExtensions)for(var l in Element.Methods.ByTag){e=d(l);Object.isUndefined(e)||c(g[l],e.prototype)}Object.extend(Element,Element.Methods);delete Element.ByTag;Element.extend.refresh&&Element.extend.refresh();Element.cache={}};
document.viewport={getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()}},getScrollOffsets:function(){return Element._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)}};
(function(a){function b(){if(d.WebKit&&!e.evaluate)return document;if(d.Opera&&window.parseFloat(window.opera.version())<9.5)return document.body;return document.documentElement}function c(l){g||(g=b());n[l]="client"+l;a["get"+l]=function(){return g[n[l]]};return a["get"+l]()}var d=Prototype.Browser,e=document,g,n={};a.getWidth=c.curry("Width");a.getHeight=c.curry("Height")})(document.viewport);Element.Storage={UID:1};
Element.addMethods({getStorage:function(a){if(a=$(a)){if(a===window)a=0;else{if(typeof a._prototypeUID==="undefined")a._prototypeUID=Element.Storage.UID++;a=a._prototypeUID}Element.Storage[a]||(Element.Storage[a]=$H());return Element.Storage[a]}},store:function(a,b,c){if(a=$(a)){arguments.length===2?Element.getStorage(a).update(b):Element.getStorage(a).set(b,c);return a}},retrieve:function(a,b,c){if(a=$(a)){a=Element.getStorage(a);var d=a.get(b);if(Object.isUndefined(d)){a.set(b,c);d=c}return d}},
clone:function(a,b){if(a=$(a)){a=a.cloneNode(b);a._prototypeUID=void 0;if(b){b=Element.select(a,"*");for(var c=b.length;c--;)b[c]._prototypeUID=void 0}return Element.extend(a)}},purge:function(a){if(a=$(a)){var b=Element._purgeElement;b(a);a=a.getElementsByTagName("*");for(var c=a.length;c--;)b(a[c]);return null}}});
(function(){function a(f){f=f.match(/^(\d+)%?$/i);if(!f)return null;return Number(f[1])/100}function b(f,k,p){var o=null;if(Object.isElement(f)){o=f;f=o.getStyle(k)}if(f===null)return null;if(/^(?:-)?\d+(\.\d+)?(px)?$/i.test(f))return window.parseFloat(f);var t=f.include("%"),x=p===document.viewport;if(/\d/.test(f)&&o&&o.runtimeStyle&&!(t&&x)){p=o.style.left;k=o.runtimeStyle.left;o.runtimeStyle.left=o.currentStyle.left;o.style.left=f||0;f=o.style.pixelLeft;o.style.left=p;o.runtimeStyle.left=k;return f}if(o&&
t){p=p||o.parentNode;f=a(f);t=null;o.getStyle("position");o=k.include("left")||k.include("right")||k.include("width");k=k.include("top")||k.include("bottom")||k.include("height");if(p===document.viewport)if(o)t=document.viewport.getWidth();else{if(k)t=document.viewport.getHeight()}else if(o)t=$(p).measure("width");else if(k)t=$(p).measure("height");return t===null?0:t*f}return 0}function c(f){for(;f&&f.parentNode;){if(f.getStyle("display")==="none")return false;f=$(f.parentNode)}return true}function d(f){if(f.include("border"))f+=
"-width";return f.camelize()}function e(f,k){return new Element.Layout(f,k)}function g(f,k){return $(f).getLayout().get(k)}function n(f){f=$(f);var k=Element.getStyle(f,"display");if(k&&k!=="none")return{width:f.offsetWidth,height:f.offsetHeight};k=f.style;k={visibility:k.visibility,position:k.position,display:k.display};var p={visibility:"hidden",display:"block"};if(k.position!=="fixed")p.position="absolute";Element.setStyle(f,p);p={width:f.offsetWidth,height:f.offsetHeight};Element.setStyle(f,k);
return p}function l(f){f=$(f);if(y(f)||h(f)||J(f)||D(f))return $(document.body);if(Element.getStyle(f,"display")!=="inline"&&f.offsetParent)return $(f.offsetParent);for(;(f=f.parentNode)&&f!==document.body;)if(Element.getStyle(f,"position")!=="static")return D(f)?$(document.body):$(f);return $(document.body)}function m(f){f=$(f);var k=0,p=0;if(f.parentNode){do{k+=f.offsetTop||0;p+=f.offsetLeft||0;f=f.offsetParent}while(f)}return new Element.Offset(p,k)}function r(f){f=$(f);var k=f.getLayout(),p=0,
o=0;do{p+=f.offsetTop||0;o+=f.offsetLeft||0;if(f=f.offsetParent){if(J(f))break;if(Element.getStyle(f,"position")!=="static")break}}while(f);o-=k.get("margin-top");p-=k.get("margin-left");return new Element.Offset(o,p)}function B(f){var k=0,p=0;do{k+=f.scrollTop||0;p+=f.scrollLeft||0;f=f.parentNode}while(f);return new Element.Offset(p,k)}function z(f){$(t);var k=0,p=0,o=document.body,t=f;do{k+=t.offsetTop||0;p+=t.offsetLeft||0;if(t.offsetParent==o&&Element.getStyle(t,"position")=="absolute")break}while(t=
t.offsetParent);t=f;do if(t!=o){k-=t.scrollTop||0;p-=t.scrollLeft||0}while(t=t.parentNode);return new Element.Offset(p,k)}function E(f){f=$(f);if(Element.getStyle(f,"position")==="absolute")return f;var k=l(f),p=f.viewportOffset();k=k.viewportOffset();p=p.relativeTo(k);k=f.getLayout();f.store("prototype_absolutize_original_styles",{left:f.getStyle("left"),top:f.getStyle("top"),width:f.getStyle("width"),height:f.getStyle("height")});f.setStyle({position:"absolute",top:p.top+"px",left:p.left+"px",width:k.get("width")+
"px",height:k.get("height")+"px"});return f}function F(f){f=$(f);if(Element.getStyle(f,"position")==="relative")return f;var k=f.retrieve("prototype_absolutize_original_styles");k&&f.setStyle(k);return f}function J(f){return f.nodeName.toUpperCase()==="BODY"}function D(f){return f.nodeName.toUpperCase()==="HTML"}function y(f){return f.nodeType===Node.DOCUMENT_NODE}function h(f){return f!==document.body&&!Element.descendantOf(f,document.body)}var j=Prototype.K;if("currentStyle"in document.documentElement)j=
function(f){if(!f.currentStyle.hasLayout)f.style.zoom=1;return f};Element.Layout=Class.create(Hash,{initialize:function($super,k,p){$super();this.element=$(k);Element.Layout.PROPERTIES.each(function(o){this._set(o,null)},this);if(p){this._preComputing=true;this._begin();Element.Layout.PROPERTIES.each(this._compute,this);this._end();this._preComputing=false}},_set:function(f,k){return Hash.prototype.set.call(this,f,k)},set:function(){throw"Properties of Element.Layout are read-only.";},get:function($super,
k){var p=$super(k);return p===null?this._compute(k):p},_begin:function(){if(!this._prepared){var f=this.element;if(!c(f)){f.store("prototype_original_styles",{position:f.style.position||"",width:f.style.width||"",visibility:f.style.visibility||"",display:f.style.display||""});var k=f.getStyle("position"),p=f.getStyle("width");if(p==="0px"||p===null){f.style.display="block";p=f.getStyle("width")}var o=k==="fixed"?document.viewport:f.parentNode;f.setStyle({position:"absolute",visibility:"hidden",display:"block"});
var t=f.getStyle("width");k=p&&t===p?b(f,"width",o):k==="absolute"||k==="fixed"?b(f,"width",o):$(f.parentNode).getLayout().get("width")-this.get("margin-left")-this.get("border-left")-this.get("padding-left")-this.get("padding-right")-this.get("border-right")-this.get("margin-right");f.setStyle({width:k+"px"})}this._prepared=true}},_end:function(){var f=this.element,k=f.retrieve("prototype_original_styles");f.store("prototype_original_styles",null);f.setStyle(k);this._prepared=false},_compute:function(f){var k=
Element.Layout.COMPUTATIONS;if(!(f in k))throw"Property not found.";return this._set(f,k[f].call(this,this.element))},toObject:function(){var f=$A(arguments),k={};(f.length===0?Element.Layout.PROPERTIES:f.join(" ").split(" ")).each(function(p){if(Element.Layout.PROPERTIES.include(p)){var o=this.get(p);if(o!=null)k[p]=o}},this);return k},toHash:function(){var f=this.toObject.apply(this,arguments);return new Hash(f)},toCSS:function(){var f=$A(arguments),k={};(f.length===0?Element.Layout.PROPERTIES:
f.join(" ").split(" ")).each(function(p){if(Element.Layout.PROPERTIES.include(p))if(!Element.Layout.COMPOSITE_PROPERTIES.include(p)){var o=this.get(p);if(o!=null)k[d(p)]=o+"px"}},this);return k},inspect:function(){return"#<Element.Layout>"}});Object.extend(Element.Layout,{PROPERTIES:$w("height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height"),
COMPOSITE_PROPERTIES:$w("padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height"),COMPUTATIONS:{height:function(){this._preComputing||this._begin();var f=this.get("border-box-height");if(f<=0){this._preComputing||this._end();return 0}var k=this.get("border-top"),p=this.get("border-bottom"),o=this.get("padding-top"),t=this.get("padding-bottom");this._preComputing||this._end();return f-k-p-o-t},width:function(){this._preComputing||this._begin();var f=
this.get("border-box-width");if(f<=0){this._preComputing||this._end();return 0}var k=this.get("border-left"),p=this.get("border-right"),o=this.get("padding-left"),t=this.get("padding-right");this._preComputing||this._end();return f-k-p-o-t},"padding-box-height":function(){var f=this.get("height"),k=this.get("padding-top"),p=this.get("padding-bottom");return f+k+p},"padding-box-width":function(){var f=this.get("width"),k=this.get("padding-left"),p=this.get("padding-right");return f+k+p},"border-box-height":function(f){this._preComputing||
this._begin();f=f.offsetHeight;this._preComputing||this._end();return f},"border-box-width":function(f){this._preComputing||this._begin();f=f.offsetWidth;this._preComputing||this._end();return f},"margin-box-height":function(){var f=this.get("border-box-height"),k=this.get("margin-top"),p=this.get("margin-bottom");if(f<=0)return 0;return f+k+p},"margin-box-width":function(){var f=this.get("border-box-width"),k=this.get("margin-left"),p=this.get("margin-right");if(f<=0)return 0;return f+k+p},top:function(f){return f.positionedOffset().top},
bottom:function(f){var k=f.positionedOffset();f=f.getOffsetParent().measure("height");var p=this.get("border-box-height");return f-p-k.top},left:function(f){return f.positionedOffset().left},right:function(f){var k=f.positionedOffset();f=f.getOffsetParent().measure("width");var p=this.get("border-box-width");return f-p-k.left},"padding-top":function(f){return b(f,"paddingTop")},"padding-bottom":function(f){return b(f,"paddingBottom")},"padding-left":function(f){return b(f,"paddingLeft")},"padding-right":function(f){return b(f,
"paddingRight")},"border-top":function(f){return b(f,"borderTopWidth")},"border-bottom":function(f){return b(f,"borderBottomWidth")},"border-left":function(f){return b(f,"borderLeftWidth")},"border-right":function(f){return b(f,"borderRightWidth")},"margin-top":function(f){return b(f,"marginTop")},"margin-bottom":function(f){return b(f,"marginBottom")},"margin-left":function(f){return b(f,"marginLeft")},"margin-right":function(f){return b(f,"marginRight")}}});"getBoundingClientRect"in document.documentElement&&
Object.extend(Element.Layout.COMPUTATIONS,{right:function(f){var k=j(f.getOffsetParent());f=f.getBoundingClientRect();return(k.getBoundingClientRect().right-f.right).round()},bottom:function(f){var k=j(f.getOffsetParent());f=f.getBoundingClientRect();return(k.getBoundingClientRect().bottom-f.bottom).round()}});Element.Offset=Class.create({initialize:function(f,k){this.left=f.round();this.top=k.round();this[0]=this.left;this[1]=this.top},relativeTo:function(f){return new Element.Offset(this.left-f.left,
this.top-f.top)},inspect:function(){return"#<Element.Offset left: #{left} top: #{top}>".interpolate(this)},toString:function(){return"[#{left}, #{top}]".interpolate(this)},toArray:function(){return[this.left,this.top]}});if(Prototype.Browser.IE){l=l.wrap(function(f,k){k=$(k);if(y(k)||h(k)||J(k)||D(k))return $(document.body);var p=k.getStyle("position");if(p!=="static")return f(k);k.setStyle({position:"relative"});f=f(k);k.setStyle({position:p});return f});r=r.wrap(function(f,k){k=$(k);if(!k.parentNode)return new Element.Offset(0,
0);var p=k.getStyle("position");if(p!=="static")return f(k);var o=k.getOffsetParent();o&&o.getStyle("position")==="fixed"&&j(o);k.setStyle({position:"relative"});f=f(k);k.setStyle({position:p});return f})}else if(Prototype.Browser.Webkit)m=function(f){f=$(f);var k=0,p=0;do{k+=f.offsetTop||0;p+=f.offsetLeft||0;if(f.offsetParent==document.body)if(Element.getStyle(f,"position")=="absolute")break;f=f.offsetParent}while(f);return new Element.Offset(p,k)};Element.addMethods({getLayout:e,measure:g,getDimensions:n,
getOffsetParent:l,cumulativeOffset:m,positionedOffset:r,cumulativeScrollOffset:B,viewportOffset:z,absolutize:E,relativize:F});"getBoundingClientRect"in document.documentElement&&Element.addMethods({viewportOffset:function(f){f=$(f);if(h(f))return new Element.Offset(0,0);f=f.getBoundingClientRect();var k=document.documentElement;return new Element.Offset(f.left-k.clientLeft,f.top-k.clientTop)}})})();window.$$=function(){var a=$A(arguments).join(", ");return Prototype.Selector.select(a,document)};
Prototype.Selector=function(){function a(){throw new Error('Method "Prototype.Selector.select" must be defined.');}function b(){throw new Error('Method "Prototype.Selector.match" must be defined.');}function c(g,n,l){l=l||0;var m=Prototype.Selector.match,r=g.length,B=0,z;for(z=0;z<r;z++)if(m(g[z],n)&&l==B++)return Element.extend(g[z])}function d(g){for(var n=0,l=g.length;n<l;n++)Element.extend(g[n]);return g}var e=Prototype.K;return{select:a,match:b,find:c,extendElements:Element.extend===e?e:d,extendElement:Element.extend}}();
Prototype._original_property=window.Sizzle;
(function(){function a(h,j,f,k,p,o){p=h=="previousSibling"&&!o;for(var t=0,x=k.length;t<x;t++){var v=k[t];if(v){if(p&&v.nodeType===1){v.sizcache=f;v.sizset=t}v=v[h];for(var H=false;v;){if(v.sizcache===f){H=k[v.sizset];break}if(v.nodeType===1&&!o){v.sizcache=f;v.sizset=t}if(v.nodeName===j){H=v;break}v=v[h]}k[t]=H}}}function b(h,j,f,k,p,o){p=h=="previousSibling"&&!o;for(var t=0,x=k.length;t<x;t++){var v=k[t];if(v){if(p&&v.nodeType===1){v.sizcache=f;v.sizset=t}v=v[h];for(var H=false;v;){if(v.sizcache===
f){H=k[v.sizset];break}if(v.nodeType===1){if(!o){v.sizcache=f;v.sizset=t}if(typeof j!=="string"){if(v===j){H=true;break}}else if(l.filter(j,[v]).length>0){H=v;break}}v=v[h]}k[t]=H}}}var c=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d=0,e=Object.prototype.toString,g=false,n=true;[0,0].sort(function(){n=false;return 0});var l=function(h,j,f,k){f=f||[];var p=j=j||document;if(j.nodeType!==1&&j.nodeType!==9)return[];
if(!h||typeof h!=="string")return f;for(var o=[],t,x,v,H,K=true,M=D(j),N=h;(c.exec(""),t=c.exec(N))!==null;){N=t[3];o.push(t[1]);if(t[2]){H=t[3];break}}if(o.length>1&&r.exec(h))if(o.length===2&&m.relative[o[0]])x=y(o[0]+o[1],j);else for(x=m.relative[o[0]]?[j]:l(o.shift(),j);o.length;){h=o.shift();if(m.relative[h])h+=o.shift();x=y(h,x)}else{if(!k&&o.length>1&&j.nodeType===9&&!M&&m.match.ID.test(o[0])&&!m.match.ID.test(o[o.length-1])){t=l.find(o.shift(),j,M);j=t.expr?l.filter(t.expr,t.set)[0]:t.set[0]}if(j){t=
k?{expr:o.pop(),set:z(k)}:l.find(o.pop(),o.length===1&&(o[0]==="~"||o[0]==="+")&&j.parentNode?j.parentNode:j,M);x=t.expr?l.filter(t.expr,t.set):t.set;if(o.length>0)v=z(x);else K=false;for(;o.length;){var q=o.pop();t=q;if(m.relative[q])t=o.pop();else q="";if(t==null)t=j;m.relative[q](v,t,M)}}else v=[]}v||(v=x);if(!v)throw"Syntax error, unrecognized expression: "+(q||h);if(e.call(v)==="[object Array]")if(K)if(j&&j.nodeType===1)for(h=0;v[h]!=null;h++){if(v[h]&&(v[h]===true||v[h].nodeType===1&&J(j,v[h])))f.push(x[h])}else for(h=
0;v[h]!=null;h++)v[h]&&v[h].nodeType===1&&f.push(x[h]);else f.push.apply(f,v);else z(v,f);if(H){l(H,p,f,k);l.uniqueSort(f)}return f};l.uniqueSort=function(h){if(F){g=n;h.sort(F);if(g)for(var j=1;j<h.length;j++)h[j]===h[j-1]&&h.splice(j--,1)}return h};l.matches=function(h,j){return l(h,null,null,j)};l.find=function(h,j,f){var k,p;if(!h)return[];for(var o=0,t=m.order.length;o<t;o++){var x=m.order[o];if(p=m.leftMatch[x].exec(h)){var v=p[1];p.splice(1,1);if(v.substr(v.length-1)!=="\\"){p[1]=(p[1]||"").replace(/\\/g,
"");k=m.find[x](p,j,f);if(k!=null){h=h.replace(m.match[x],"");break}}}}k||(k=j.getElementsByTagName("*"));return{set:k,expr:h}};l.filter=function(h,j,f,k){for(var p=h,o=[],t=j,x,v,H=j&&j[0]&&D(j[0]);h&&j.length;){for(var K in m.filter)if((x=m.match[K].exec(h))!=null){var M=m.filter[K],N,q;v=false;if(t==o)o=[];if(m.preFilter[K])if(x=m.preFilter[K](x,t,f,o,k,H)){if(x===true)continue}else v=N=true;if(x)for(var C=0;(q=t[C])!=null;C++)if(q){N=M(q,x,C,t);var w=k^!!N;if(f&&N!=null)if(w)v=true;else t[C]=
false;else if(w){o.push(q);v=true}}if(N!==undefined){f||(t=o);h=h.replace(m.match[K],"");if(!v)return[];break}}if(h==p)if(v==null)throw"Syntax error, unrecognized expression: "+h;else break;p=h}return t};var m=l.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,
CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(h){return h.getAttribute("href")}},relative:{"+":function(h,j,f){var k=typeof j==="string",p=k&&!/\W/.test(j);k=k&&!p;if(p&&!f)j=j.toUpperCase();f=0;p=h.length;for(var o;f<p;f++)if(o=h[f]){for(;(o=o.previousSibling)&&
o.nodeType!==1;);h[f]=k||o&&o.nodeName===j?o||false:o===j}k&&l.filter(j,h,true)},">":function(h,j,f){var k=typeof j==="string";if(k&&!/\W/.test(j)){j=f?j:j.toUpperCase();f=0;for(var p=h.length;f<p;f++){var o=h[f];if(o){k=o.parentNode;h[f]=k.nodeName===j?k:false}}}else{f=0;for(p=h.length;f<p;f++)if(o=h[f])h[f]=k?o.parentNode:o.parentNode===j;k&&l.filter(j,h,true)}},"":function(h,j,f){var k=d++,p=b;if(!/\W/.test(j)){var o=j=f?j:j.toUpperCase();p=a}p("parentNode",j,k,h,o,f)},"~":function(h,j,f){var k=
d++,p=b;if(typeof j==="string"&&!/\W/.test(j)){var o=j=f?j:j.toUpperCase();p=a}p("previousSibling",j,k,h,o,f)}},find:{ID:function(h,j,f){if(typeof j.getElementById!=="undefined"&&!f)return(h=j.getElementById(h[1]))?[h]:[]},NAME:function(h,j){if(typeof j.getElementsByName!=="undefined"){var f=[];j=j.getElementsByName(h[1]);for(var k=0,p=j.length;k<p;k++)j[k].getAttribute("name")===h[1]&&f.push(j[k]);return f.length===0?null:f}},TAG:function(h,j){return j.getElementsByTagName(h[1])}},preFilter:{CLASS:function(h,
j,f,k,p,o){h=" "+h[1].replace(/\\/g,"")+" ";if(o)return h;o=0;for(var t;(t=j[o])!=null;o++)if(t)if(p^(t.className&&(" "+t.className+" ").indexOf(h)>=0))f||k.push(t);else if(f)j[o]=false;return false},ID:function(h){return h[1].replace(/\\/g,"")},TAG:function(h,j){for(var f=0;j[f]===false;f++);return j[f]&&D(j[f])?h[1]:h[1].toUpperCase()},CHILD:function(h){if(h[1]=="nth"){var j=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(h[2]=="even"&&"2n"||h[2]=="odd"&&"2n+1"||!/\D/.test(h[2])&&"0n+"+h[2]||h[2]);h[2]=j[1]+(j[2]||
1)-0;h[3]=j[3]-0}h[0]=d++;return h},ATTR:function(h,j,f,k,p,o){j=h[1].replace(/\\/g,"");if(!o&&m.attrMap[j])h[1]=m.attrMap[j];if(h[2]==="~=")h[4]=" "+h[4]+" ";return h},PSEUDO:function(h,j,f,k,p){if(h[1]==="not")if((c.exec(h[3])||"").length>1||/^\w/.test(h[3]))h[3]=l(h[3],null,null,j);else{h=l.filter(h[3],j,f,true^p);f||k.push.apply(k,h);return false}else if(m.match.POS.test(h[0])||m.match.CHILD.test(h[0]))return true;return h},POS:function(h){h.unshift(true);return h}},filters:{enabled:function(h){return h.disabled===
false&&h.type!=="hidden"},disabled:function(h){return h.disabled===true},checked:function(h){return h.checked===true},selected:function(h){return h.selected===true},parent:function(h){return!!h.firstChild},empty:function(h){return!h.firstChild},has:function(h,j,f){return!!l(f[3],h).length},header:function(h){return/h\d/i.test(h.nodeName)},text:function(h){return"text"===h.type},radio:function(h){return"radio"===h.type},checkbox:function(h){return"checkbox"===h.type},file:function(h){return"file"===
h.type},password:function(h){return"password"===h.type},submit:function(h){return"submit"===h.type},image:function(h){return"image"===h.type},reset:function(h){return"reset"===h.type},button:function(h){return"button"===h.type||h.nodeName.toUpperCase()==="BUTTON"},input:function(h){return/input|select|textarea|button/i.test(h.nodeName)}},setFilters:{first:function(h,j){return j===0},last:function(h,j,f,k){return j===k.length-1},even:function(h,j){return j%2===0},odd:function(h,j){return j%2===1},
lt:function(h,j,f){return j<f[3]-0},gt:function(h,j,f){return j>f[3]-0},nth:function(h,j,f){return f[3]-0==j},eq:function(h,j,f){return f[3]-0==j}},filter:{PSEUDO:function(h,j,f,k){var p=j[1],o=m.filters[p];if(o)return o(h,f,j,k);else if(p==="contains")return(h.textContent||h.innerText||"").indexOf(j[3])>=0;else if(p==="not"){j=j[3];f=0;for(k=j.length;f<k;f++)if(j[f]===h)return false;return true}},CHILD:function(h,j){var f=j[1],k=h;switch(f){case "only":case "first":for(;k=k.previousSibling;)if(k.nodeType===
1)return false;if(f=="first")return true;k=h;case "last":for(;k=k.nextSibling;)if(k.nodeType===1)return false;return true;case "nth":f=j[2];var p=j[3];if(f==1&&p==0)return true;j=j[0];var o=h.parentNode;if(o&&(o.sizcache!==j||!h.nodeIndex)){var t=0;for(k=o.firstChild;k;k=k.nextSibling)if(k.nodeType===1)k.nodeIndex=++t;o.sizcache=j}h=h.nodeIndex-p;return f==0?h==0:h%f==0&&h/f>=0}},ID:function(h,j){return h.nodeType===1&&h.getAttribute("id")===j},TAG:function(h,j){return j==="*"&&h.nodeType===1||h.nodeName===
j},CLASS:function(h,j){return(" "+(h.className||h.getAttribute("class"))+" ").indexOf(j)>-1},ATTR:function(h,j){var f=j[1];h=m.attrHandle[f]?m.attrHandle[f](h):h[f]!=null?h[f]:h.getAttribute(f);f=h+"";var k=j[2];j=j[4];return h==null?k==="!=":k==="="?f===j:k==="*="?f.indexOf(j)>=0:k==="~="?(" "+f+" ").indexOf(j)>=0:!j?f&&h!==false:k==="!="?f!=j:k==="^="?f.indexOf(j)===0:k==="$="?f.substr(f.length-j.length)===j:k==="|="?f===j||f.substr(0,j.length+1)===j+"-":false},POS:function(h,j,f,k){var p=m.setFilters[j[2]];
if(p)return p(h,f,j,k)}}},r=m.match.POS;for(var B in m.match){m.match[B]=new RegExp(m.match[B].source+/(?![^\[]*\])(?![^\(]*\))/.source);m.leftMatch[B]=new RegExp(/(^(?:.|\r|\n)*?)/.source+m.match[B].source)}var z=function(h,j){h=Array.prototype.slice.call(h,0);if(j){j.push.apply(j,h);return j}return h};try{Array.prototype.slice.call(document.documentElement.childNodes,0)}catch(E){z=function(h,j){j=j||[];if(e.call(h)==="[object Array]")Array.prototype.push.apply(j,h);else if(typeof h.length==="number")for(var f=
0,k=h.length;f<k;f++)j.push(h[f]);else for(f=0;h[f];f++)j.push(h[f]);return j}}var F;if(document.documentElement.compareDocumentPosition)F=function(h,j){if(!h.compareDocumentPosition||!j.compareDocumentPosition){if(h==j)g=true;return 0}h=h.compareDocumentPosition(j)&4?-1:h===j?0:1;if(h===0)g=true;return h};else if("sourceIndex"in document.documentElement)F=function(h,j){if(!h.sourceIndex||!j.sourceIndex){if(h==j)g=true;return 0}h=h.sourceIndex-j.sourceIndex;if(h===0)g=true;return h};else if(document.createRange)F=
function(h,j){if(!h.ownerDocument||!j.ownerDocument){if(h==j)g=true;return 0}var f=h.ownerDocument.createRange(),k=j.ownerDocument.createRange();f.setStart(h,0);f.setEnd(h,0);k.setStart(j,0);k.setEnd(j,0);h=f.compareBoundaryPoints(Range.START_TO_END,k);if(h===0)g=true;return h};(function(){var h=document.createElement("div"),j="script"+(new Date).getTime();h.innerHTML="<a name='"+j+"'/>";var f=document.documentElement;f.insertBefore(h,f.firstChild);if(document.getElementById(j)){m.find.ID=function(k,
p,o){if(typeof p.getElementById!=="undefined"&&!o)return(p=p.getElementById(k[1]))?p.id===k[1]||typeof p.getAttributeNode!=="undefined"&&p.getAttributeNode("id").nodeValue===k[1]?[p]:undefined:[]};m.filter.ID=function(k,p){var o=typeof k.getAttributeNode!=="undefined"&&k.getAttributeNode("id");return k.nodeType===1&&o&&o.nodeValue===p}}f.removeChild(h);f=h=null})();(function(){var h=document.createElement("div");h.appendChild(document.createComment(""));if(h.getElementsByTagName("*").length>0)m.find.TAG=
function(j,f){f=f.getElementsByTagName(j[1]);if(j[1]==="*"){j=[];for(var k=0;f[k];k++)f[k].nodeType===1&&j.push(f[k]);f=j}return f};h.innerHTML="<a href='#'></a>";if(h.firstChild&&typeof h.firstChild.getAttribute!=="undefined"&&h.firstChild.getAttribute("href")!=="#")m.attrHandle.href=function(j){return j.getAttribute("href",2)};h=null})();document.querySelectorAll&&function(){var h=l,j=document.createElement("div");j.innerHTML="<p class='TEST'></p>";if(!(j.querySelectorAll&&j.querySelectorAll(".TEST").length===
0)){l=function(k,p,o,t){p=p||document;if(!t&&p.nodeType===9&&!D(p))try{return z(p.querySelectorAll(k),o)}catch(x){}return h(k,p,o,t)};for(var f in h)l[f]=h[f];j=null}}();document.getElementsByClassName&&document.documentElement.getElementsByClassName&&function(){var h=document.createElement("div");h.innerHTML="<div class='test e'></div><div class='test'></div>";if(h.getElementsByClassName("e").length!==0){h.lastChild.className="e";if(h.getElementsByClassName("e").length!==1){m.order.splice(1,0,"CLASS");
m.find.CLASS=function(j,f,k){if(typeof f.getElementsByClassName!=="undefined"&&!k)return f.getElementsByClassName(j[1])};h=null}}}();var J=document.compareDocumentPosition?function(h,j){return h.compareDocumentPosition(j)&16}:function(h,j){return h!==j&&(h.contains?h.contains(j):true)},D=function(h){return h.nodeType===9&&h.documentElement.nodeName!=="HTML"||!!h.ownerDocument&&h.ownerDocument.documentElement.nodeName!=="HTML"},y=function(h,j){var f=[],k="",p;for(j=j.nodeType?[j]:j;p=m.match.PSEUDO.exec(h);){k+=
p[0];h=h.replace(m.match.PSEUDO,"")}h=m.relative[h]?h+"*":h;p=0;for(var o=j.length;p<o;p++)l(h,j[p],f);return l.filter(k,f)};window.Sizzle=l})();(function(a){function b(e,g){return d(a(e,g||document))}function c(e,g){return a.matches(g,[e]).length==1}var d=Prototype.Selector.extendElements;Prototype.Selector.engine=a;Prototype.Selector.select=b;Prototype.Selector.match=c})(Sizzle);window.Sizzle=Prototype._original_property;delete Prototype._original_property;
var Form={reset:function(a){a=$(a);a.reset();return a},serializeElements:function(a,b){if(typeof b!="object")b={hash:!!b};else if(Object.isUndefined(b.hash))b.hash=true;var c,d,e=false,g=b.submit,n;if(b.hash){b={};n=function(l,m,r){if(m in l){Object.isArray(l[m])||(l[m]=[l[m]]);l[m].push(r)}else l[m]=r;return l}}else{b="";n=function(l,m,r){return l+(l?"&":"")+encodeURIComponent(m)+"="+encodeURIComponent(r)}}return a.inject(b,function(l,m){if(!m.disabled&&m.name){c=m.name;d=$(m).getValue();if(d!=null&&
m.type!="file"&&(m.type!="submit"||!e&&g!==false&&(!g||c==g)&&(e=true)))l=n(l,c,d)}return l})}};
Form.Methods={serialize:function(a,b){return Form.serializeElements(Form.getElements(a),b)},getElements:function(a){a=$(a).getElementsByTagName("*");for(var b,c=[],d=Form.Element.Serializers,e=0;b=a[e];e++)c.push(b);return c.inject([],function(g,n){d[n.tagName.toLowerCase()]&&g.push(Element.extend(n));return g})},getInputs:function(a,b,c){a=$(a);a=a.getElementsByTagName("input");if(!b&&!c)return $A(a).map(Element.extend);for(var d=0,e=[],g=a.length;d<g;d++){var n=a[d];b&&n.type!=b||c&&n.name!=c||
e.push(Element.extend(n))}return e},disable:function(a){a=$(a);Form.getElements(a).invoke("disable");return a},enable:function(a){a=$(a);Form.getElements(a).invoke("enable");return a},findFirstElement:function(a){a=$(a).getElements().findAll(function(c){return"hidden"!=c.type&&!c.disabled});var b=a.findAll(function(c){return c.hasAttribute("tabIndex")&&c.tabIndex>=0}).sortBy(function(c){return c.tabIndex}).first();return b?b:a.find(function(c){return/^(?:input|select|textarea)$/i.test(c.tagName)})},
focusFirstElement:function(a){a=$(a);var b=a.findFirstElement();b&&b.activate();return a},request:function(a,b){a=$(a);b=Object.clone(b||{});var c=b.parameters,d=a.readAttribute("action")||"";if(d.blank())d=window.location.href;b.parameters=a.serialize(true);if(c){if(Object.isString(c))c=c.toQueryParams();Object.extend(b.parameters,c)}if(a.hasAttribute("method")&&!b.method)b.method=a.method;return new Ajax.Request(d,b)}};
Form.Element={focus:function(a){$(a).focus();return a},select:function(a){$(a).select();return a}};
Form.Element.Methods={serialize:function(a){a=$(a);if(!a.disabled&&a.name){var b=a.getValue();if(b!=undefined){var c={};c[a.name]=b;return Object.toQueryString(c)}}return""},getValue:function(a){a=$(a);var b=a.tagName.toLowerCase();return Form.Element.Serializers[b](a)},setValue:function(a,b){a=$(a);var c=a.tagName.toLowerCase();Form.Element.Serializers[c](a,b);return a},clear:function(a){$(a).value="";return a},present:function(a){return $(a).value!=""},activate:function(a){a=$(a);try{a.focus();
if(a.select&&(a.tagName.toLowerCase()!="input"||!/^(?:button|reset|submit)$/i.test(a.type)))a.select()}catch(b){}return a},disable:function(a){a=$(a);a.disabled=true;return a},enable:function(a){a=$(a);a.disabled=false;return a}};var Field=Form.Element,$F=Form.Element.Methods.getValue;
Form.Element.Serializers=function(){function a(l,m){switch(l.type.toLowerCase()){case "checkbox":case "radio":return b(l,m);default:return c(l,m)}}function b(l,m){if(Object.isUndefined(m))return l.checked?l.value:null;else l.checked=!!m}function c(l,m){if(Object.isUndefined(m))return l.value;else l.value=m}function d(l,m){if(Object.isUndefined(m))return(l.type==="select-one"?e:g)(l);for(var r,B,z=!Object.isArray(m),E=0,F=l.length;E<F;E++){r=l.options[E];B=this.optionValue(r);if(z){if(B==m){r.selected=
true;return}}else r.selected=m.include(B)}}function e(l){var m=l.selectedIndex;return m>=0?n(l.options[m]):null}function g(l){var m,r=l.length;if(!r)return null;var B=0;for(m=[];B<r;B++){var z=l.options[B];z.selected&&m.push(n(z))}return m}function n(l){return Element.hasAttribute(l,"value")?l.value:l.text}return{input:a,inputSelector:b,textarea:c,select:d,selectOne:e,selectMany:g,optionValue:n,button:c}}();
Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,b,c,d){$super(d,c);this.element=$(b);this.lastValue=this.getValue()},execute:function(){var a=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(a)?this.lastValue!=a:String(this.lastValue)!=String(a)){this.callback(this.element,a);this.lastValue=a}}});Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element)}});
Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element)}});
Abstract.EventObserver=Class.create({initialize:function(a,b){this.element=$(a);this.callback=b;this.lastValue=this.getValue();this.element.tagName.toLowerCase()=="form"?this.registerFormCallbacks():this.registerCallback(this.element)},onElementEvent:function(){var a=this.getValue();if(this.lastValue!=a){this.callback(this.element,a);this.lastValue=a}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this)},registerCallback:function(a){if(a.type)switch(a.type.toLowerCase()){case "checkbox":case "radio":Event.observe(a,
"click",this.onElementEvent.bind(this));break;default:Event.observe(a,"change",this.onElementEvent.bind(this));break}}});Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element)}});
(function(){function a(q,C){return q.which?q.which===C+1:q.button===C}function b(q,C){return q.button===t[C]}function c(q,C){switch(C){case 0:return q.which==1&&!q.metaKey;case 1:return q.which==2||q.which==1&&q.metaKey;case 2:return q.which==3;default:return false}}function d(q){return o(q,0)}function e(q){return o(q,1)}function g(q){return o(q,2)}function n(q){q=j.extend(q);var C=q.target,w=q.type;if((q=q.currentTarget)&&q.tagName)if(w==="load"||w==="error"||w==="click"&&q.tagName.toLowerCase()===
"input"&&q.type==="radio")C=q;if(C.nodeType==Node.TEXT_NODE)C=C.parentNode;return Element.extend(C)}function l(q,C){q=j.element(q);if(!C)return q;for(;q;){if(Object.isElement(q)&&Prototype.Selector.match(q,C))return Element.extend(q);q=q.parentNode}}function m(q){return{x:r(q),y:B(q)}}function r(q){var C=document.documentElement,w=document.body||{scrollLeft:0};return q.pageX||q.clientX+(C.scrollLeft||w.scrollLeft)-(C.clientLeft||0)}function B(q){var C=document.documentElement,w=document.body||{scrollTop:0};
return q.pageY||q.clientY+(C.scrollTop||w.scrollTop)-(C.clientTop||0)}function z(q){j.extend(q);q.preventDefault();q.stopPropagation();q.stopped=true}function E(q,C,w){var u=Element.retrieve(q,"prototype_event_registry");if(Object.isUndefined(u)){K.push(q);u=Element.retrieve(q,"prototype_event_registry",$H())}var A=u.get(C);if(Object.isUndefined(A)){A=[];u.set(C,A)}if(A.pluck("handler").include(w))return false;var G;if(C.include(":"))G=function(I){if(Object.isUndefined(I.eventName))return false;if(I.eventName!==
C)return false;j.extend(I,q);w.call(q,I)};else if(!k&&(C==="mouseenter"||C==="mouseleave")){if(C==="mouseenter"||C==="mouseleave")G=function(I){j.extend(I,q);for(var L=I.relatedTarget;L&&L!==q;)try{L=L.parentNode}catch(O){L=q}L!==q&&w.call(q,I)}}else G=function(I){j.extend(I,q);w.call(q,I)};G.handler=w;A.push(G);return G}function F(){for(var q=0,C=K.length;q<C;q++){j.stopObserving(K[q]);K[q]=null}}function J(q,C,w){q=$(q);w=E(q,C,w);if(!w)return q;if(C.include(":"))if(q.addEventListener)q.addEventListener("dataavailable",
w,false);else{q.attachEvent("ondataavailable",w);q.attachEvent("onlosecapture",w)}else{C=M(C);q.addEventListener?q.addEventListener(C,w,false):q.attachEvent("on"+C,w)}return q}function D(q,C,w){q=$(q);var u=Element.retrieve(q,"prototype_event_registry");if(!u)return q;if(!C){u.each(function(L){D(q,L.key)});return q}var A=u.get(C);if(!A)return q;if(!w){A.each(function(L){D(q,C,L.handler)});return q}for(var G=A.length,I;G--;)if(A[G].handler===w){I=A[G];break}if(!I)return q;if(C.include(":"))if(q.removeEventListener)q.removeEventListener("dataavailable",
I,false);else{q.detachEvent("ondataavailable",I);q.detachEvent("onlosecapture",I)}else{w=M(C);q.removeEventListener?q.removeEventListener(w,I,false):q.detachEvent("on"+w,I)}u.set(C,A.without(I));return q}function y(q,C,w,u){q=$(q);if(Object.isUndefined(u))u=true;if(q==document&&document.createEvent&&!q.dispatchEvent)q=document.documentElement;var A;if(document.createEvent){A=document.createEvent("HTMLEvents");A.initEvent("dataavailable",u,true)}else{A=document.createEventObject();A.eventType=u?"ondataavailable":
"onlosecapture"}A.eventName=C;A.memo=w||{};document.createEvent?q.dispatchEvent(A):q.fireEvent(A.eventType,A);return j.extend(A)}function h(q,C,w,u){q=$(q);if(Object.isFunction(w)&&Object.isUndefined(u)){u=w;w=null}return(new j.Handler(q,C,w,u)).start()}var j={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,cache:{}},f=document.documentElement,k="onmouseenter"in f&&"onmouseleave"in
f,p=function(){return false};if(window.attachEvent)p=window.addEventListener?function(q){return!(q instanceof window.Event)}:function(){return true};var o,t={0:1,1:4,2:2};o=window.attachEvent?window.addEventListener?function(q,C){return p(q)?b(q,C):a(q,C)}:b:Prototype.Browser.WebKit?c:a;j.Methods={isLeftClick:d,isMiddleClick:e,isRightClick:g,element:n,findElement:l,pointer:m,pointerX:r,pointerY:B,stop:z};var x=Object.keys(j.Methods).inject({},function(q,C){q[C]=j.Methods[C].methodize();return q});
if(window.attachEvent){function v(q){switch(q.type){case "mouseover":case "mouseenter":q=q.fromElement;break;case "mouseout":case "mouseleave":q=q.toElement;break;default:return null}return Element.extend(q)}var H={stopPropagation:function(){this.cancelBubble=true},preventDefault:function(){this.returnValue=false},inspect:function(){return"[object Event]"}};j.extend=function(q,C){if(!q)return false;if(!p(q))return q;if(q._extendedByPrototype)return q;q._extendedByPrototype=Prototype.emptyFunction;
var w=j.pointer(q);Object.extend(q,{target:q.srcElement||C,relatedTarget:v(q),pageX:w.x,pageY:w.y});Object.extend(q,x);Object.extend(q,H);return q}}else j.extend=Prototype.K;if(window.addEventListener){j.prototype=window.Event.prototype||document.createEvent("HTMLEvents").__proto__;Object.extend(j.prototype,x)}var K=[];Prototype.Browser.IE&&window.attachEvent("onunload",F);Prototype.Browser.WebKit&&window.addEventListener("unload",Prototype.emptyFunction,false);var M=Prototype.K,N={mouseenter:"mouseover",
mouseleave:"mouseout"};k||(M=function(q){return N[q]||q});j.Handler=Class.create({initialize:function(q,C,w,u){this.element=$(q);this.eventName=C;this.selector=w;this.callback=u;this.handler=this.handleEvent.bind(this)},start:function(){j.observe(this.element,this.eventName,this.handler);return this},stop:function(){j.stopObserving(this.element,this.eventName,this.handler);return this},handleEvent:function(q){var C=j.findElement(q,this.selector);C&&this.callback.call(this.element,q,C)}});Object.extend(j,
j.Methods);Object.extend(j,{fire:y,observe:J,stopObserving:D,on:h});Element.addMethods({fire:y,observe:J,stopObserving:D,on:h});Object.extend(document,{fire:y.methodize(),observe:J.methodize(),stopObserving:D.methodize(),on:h.methodize(),loaded:false});if(window.Event)Object.extend(window.Event,j);else window.Event=j})();
(function(){function a(){if(!document.loaded){d&&window.clearTimeout(d);document.loaded=true;document.fire("dom:loaded")}}function b(){if(document.readyState==="complete"){document.stopObserving("readystatechange",b);a()}}function c(){try{document.documentElement.doScroll("left")}catch(e){d=c.defer();return}a()}var d;if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,false);else{document.observe("readystatechange",b);if(window==top)d=c.defer()}Event.observe(window,"load",
a)})();Element.addMethods();Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.Methods.childOf=Element.Methods.descendantOf;
var Insertion={Before:function(a,b){return Element.insert(a,{before:b})},Top:function(a,b){return Element.insert(a,{top:b})},Bottom:function(a,b){return Element.insert(a,{bottom:b})},After:function(a,b){return Element.insert(a,{after:b})}},$continue=new Error('"throw $continue" is deprecated, use "return" instead'),Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||
document.documentElement.scrollTop||document.body.scrollTop||0},within:function(a,b,c){if(this.includeScrollOffsets)return this.withinIncludingScrolloffsets(a,b,c);this.xcomp=b;this.ycomp=c;this.offset=Element.cumulativeOffset(a);return c>=this.offset[1]&&c<this.offset[1]+a.offsetHeight&&b>=this.offset[0]&&b<this.offset[0]+a.offsetWidth},withinIncludingScrolloffsets:function(a,b,c){var d=Element.cumulativeScrollOffset(a);this.xcomp=b+d[0]-this.deltaX;this.ycomp=c+d[1]-this.deltaY;this.offset=Element.cumulativeOffset(a);
return this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+a.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+a.offsetWidth},overlap:function(a,b){if(!a)return 0;if(a=="vertical")return(this.offset[1]+b.offsetHeight-this.ycomp)/b.offsetHeight;if(a=="horizontal")return(this.offset[0]+b.offsetWidth-this.xcomp)/b.offsetWidth},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(a){Position.prepare();return Element.absolutize(a)},
relativize:function(a){Position.prepare();return Element.relativize(a)},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(a,b,c){c=c||{};return Element.clonePosition(b,a,c)}};
if(!document.getElementsByClassName)document.getElementsByClassName=function(a){function b(c){return c.blank()?null:"[contains(concat(' ', @class, ' '), ' "+c+" ')]"}a.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(c,d){d=d.toString().strip();return(d=/\s/.test(d)?$w(d).map(b).join(""):b(d))?document._getElementsByXPath(".//*"+d,c):[]}:function(c,d){d=d.toString().strip();var e=[],g=/\s/.test(d)?$w(d):null;if(!g&&!d)return e;c=$(c).getElementsByTagName("*");d=" "+d+" ";for(var n=
0,l,m;l=c[n];n++)if(l.className&&(m=" "+l.className+" ")&&(m.include(d)||g&&g.all(function(r){return!r.toString().blank()&&m.include(" "+r+" ")})))e.push(Element.extend(l));return e};return function(c,d){return $(d||document.body).getElementsByClassName(c)}}(Element.Methods);Element.ClassNames=Class.create();
Element.ClassNames.prototype={initialize:function(a){this.element=$(a)},_each:function(a){this.element.className.split(/\s+/).select(function(b){return b.length>0})._each(a)},set:function(a){this.element.className=a},add:function(a){this.include(a)||this.set($A(this).concat(a).join(" "))},remove:function(a){this.include(a)&&this.set($A(this).without(a).join(" "))},toString:function(){return $A(this).join(" ")}};Object.extend(Element.ClassNames.prototype,Enumerable);
(function(){window.Selector=Class.create({initialize:function(a){this.expression=a.strip()},findElements:function(a){return Prototype.Selector.select(this.expression,a)},match:function(a){return Prototype.Selector.match(a,this.expression)},toString:function(){return this.expression},inspect:function(){return"#<Selector: "+this.expression+">"}});Object.extend(Selector,{matchElements:function(a,b){for(var c=Prototype.Selector.match,d=[],e=0,g=a.length;e<g;e++){var n=a[e];c(n,b)&&d.push(Element.extend(n))}return d},
findElement:function(a,b,c){c=c||0;for(var d=0,e,g=0,n=a.length;g<n;g++){e=a[g];if(Prototype.Selector.match(e,b)&&c===d++)return Element.extend(e)}},findChildElements:function(a,b){b=b.toArray().join(", ");return Prototype.Selector.select(b,a||document)}})})();
var Builder={NODEMAP:{AREA:"map",CAPTION:"table",COL:"table",COLGROUP:"table",LEGEND:"fieldset",OPTGROUP:"select",OPTION:"select",PARAM:"object",TBODY:"table",TD:"table",TFOOT:"table",TH:"table",THEAD:"table",TR:"table"},node:function(a,b,c){a=a.toUpperCase();var d=document.createElement(this.NODEMAP[a]||"div");try{d.innerHTML="<"+a+"></"+a+">"}catch(e){}var g=d.firstChild||null;if(g&&g.tagName.toUpperCase()!=a)g=g.getElementsByTagName(a)[0];g||(g=document.createElement(a));if(g){if(b)if(this._isStringOrNumber(b)||
b instanceof Array||b.tagName)this._children(g,b);else{var n=this._attributes(b);if(n.length){try{d.innerHTML="<"+a+" "+n+"></"+a+">"}catch(l){}g=d.firstChild||null;if(!g){g=document.createElement(a);for(attr in b)g[attr=="class"?"className":attr]=b[attr]}if(g.tagName.toUpperCase()!=a)g=d.getElementsByTagName(a)[0]}}c&&this._children(g,c);return g}},_text:function(a){return document.createTextNode(a)},ATTR_MAP:{className:"class",htmlFor:"for"},_attributes:function(a){var b=[];for(attribute in a)b.push((attribute in
this.ATTR_MAP?this.ATTR_MAP[attribute]:attribute)+'="'+a[attribute].toString().escapeHTML().gsub(/"/,"&quot;")+'"');return b.join(" ")},_children:function(a,b){if(b.tagName)a.appendChild(b);else if(typeof b=="object")b.flatten().each(function(c){if(typeof c=="object")a.appendChild(c);else Builder._isStringOrNumber(c)&&a.appendChild(Builder._text(c))});else Builder._isStringOrNumber(b)&&a.appendChild(Builder._text(b))},_isStringOrNumber:function(a){return typeof a=="string"||typeof a=="number"},build:function(a){var b=
this.node("div");$(b).update(a.strip());return b.down()},dump:function(a){if(typeof a!="object"&&typeof a!="function")a=window;"A ABBR ACRONYM ADDRESS APPLET AREA B BASE BASEFONT BDO BIG BLOCKQUOTE BODY BR BUTTON CAPTION CENTER CITE CODE COL COLGROUP DD DEL DFN DIR DIV DL DT EM FIELDSET FONT FORM FRAME FRAMESET H1 H2 H3 H4 H5 H6 HEAD HR HTML I IFRAME IMG INPUT INS ISINDEX KBD LABEL LEGEND LI LINK MAP MENU META NOFRAMES NOSCRIPT OBJECT OL OPTGROUP OPTION P PARAM PRE Q S SAMP SCRIPT SELECT SMALL SPAN STRIKE STRONG STYLE SUB SUP TABLE TBODY TD TEXTAREA TFOOT TH THEAD TITLE TR TT U UL VAR".split(/\s+/).each(function(b){a[b]=
function(){return Builder.node.apply(Builder,[b].concat($A(arguments)))}})}};String.prototype.parseColor=function(a){var b="#";if(this.slice(0,4)=="rgb("){var c=this.slice(4,this.length-1).split(","),d=0;do b+=parseInt(c[d]).toColorPart();while(++d<3)}else if(this.slice(0,1)=="#"){if(this.length==4)for(d=1;d<4;d++)b+=(this.charAt(d)+this.charAt(d)).toLowerCase();if(this.length==7)b=this.toLowerCase()}return b.length==7?b:a||this};
Element.collectTextNodes=function(a){return $A($(a).childNodes).collect(function(b){return b.nodeType==3?b.nodeValue:b.hasChildNodes()?Element.collectTextNodes(b):""}).flatten().join("")};Element.collectTextNodesIgnoreClass=function(a,b){return $A($(a).childNodes).collect(function(c){return c.nodeType==3?c.nodeValue:c.hasChildNodes()&&!Element.hasClassName(c,b)?Element.collectTextNodesIgnoreClass(c,b):""}).flatten().join("")};
Element.setContentZoom=function(a,b){a=$(a);a.setStyle({fontSize:b/100+"em"});Prototype.Browser.WebKit&&window.scrollBy(0,0);return a};Element.getInlineOpacity=function(a){return $(a).style.opacity||""};Element.forceRerendering=function(a){try{a=$(a);var b=document.createTextNode(" ");a.appendChild(b);a.removeChild(b)}catch(c){}};
var Effect={_elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},Transitions:{linear:Prototype.K,sinoidal:function(a){return-Math.cos(a*Math.PI)/2+0.5},reverse:function(a){return 1-a},flicker:function(a){a=-Math.cos(a*Math.PI)/4+0.75+Math.random()/4;return a>1?1:a},wobble:function(a){return-Math.cos(a*Math.PI*9*a)/2+0.5},pulse:function(a,b){b=b||5;return(a%(1/b)*b).round()==0?a*b*2-(a*b*2).floor():
1-(a*b*2-(a*b*2).floor())},spring:function(a){return 1-Math.cos(a*4.5*Math.PI)*Math.exp(-a*6)},none:function(){return 0},full:function(){return 1}},DefaultOptions:{duration:1,fps:100,sync:false,from:0,to:1,delay:0,queue:"parallel"},tagifyText:function(a){var b="position:relative";if(Prototype.Browser.IE)b+=";zoom:1";a=$(a);$A(a.childNodes).each(function(c){if(c.nodeType==3){c.nodeValue.toArray().each(function(d){a.insertBefore((new Element("span",{style:b})).update(d==" "?String.fromCharCode(160):
d),c)});Element.remove(c)}})},multiple:function(a,b,c){a=(typeof a=="object"||Object.isFunction(a))&&a.length?a:$(a).childNodes;var d=Object.extend({speed:0.1,delay:0},c||{}),e=d.delay;$A(a).each(function(g,n){new b(g,Object.extend(d,{delay:n*d.speed+e}))})},PAIRS:{slide:["SlideDown","SlideUp"],blind:["BlindDown","BlindUp"],appear:["Appear","Fade"]},toggle:function(a,b,c){a=$(a);b=(b||"appear").toLowerCase();c=Object.extend({queue:{position:"end",scope:a.id||"global",limit:1}},c||{});Effect[a.visible()?
Effect.PAIRS[b][1]:Effect.PAIRS[b][0]](a,c)}};Effect.DefaultOptions.transition=Effect.Transitions.sinoidal;
Effect.ScopedQueue=Class.create(Enumerable,{initialize:function(){this.effects=[];this.interval=null},_each:function(a){this.effects._each(a)},add:function(a){var b=(new Date).getTime();switch(Object.isString(a.options.queue)?a.options.queue:a.options.queue.position){case "front":this.effects.findAll(function(c){return c.state=="idle"}).each(function(c){c.startOn+=a.finishOn;c.finishOn+=a.finishOn});break;case "with-last":b=this.effects.pluck("startOn").max()||b;break;case "end":b=this.effects.pluck("finishOn").max()||
b;break}a.startOn+=b;a.finishOn+=b;if(!a.options.queue.limit||this.effects.length<a.options.queue.limit)this.effects.push(a);if(!this.interval)this.interval=setInterval(this.loop.bind(this),15)},remove:function(a){this.effects=this.effects.reject(function(b){return b==a});if(this.effects.length==0){clearInterval(this.interval);this.interval=null}},loop:function(){for(var a=(new Date).getTime(),b=0,c=this.effects.length;b<c;b++)this.effects[b]&&this.effects[b].loop(a)}});
Effect.Queues={instances:$H(),get:function(a){if(!Object.isString(a))return a;return this.instances.get(a)||this.instances.set(a,new Effect.ScopedQueue)}};Effect.Queue=Effect.Queues.get("global");
Effect.Base=Class.create({position:null,start:function(a){function b(c,d){return(c[d+"Internal"]?"this.options."+d+"Internal(this);":"")+(c[d]?"this.options."+d+"(this);":"")}if(a&&a.transition===false)a.transition=Effect.Transitions.linear;this.options=Object.extend(Object.extend({},Effect.DefaultOptions),a||{});this.currentFrame=0;this.state="idle";this.startOn=this.options.delay*1E3;this.finishOn=this.startOn+this.options.duration*1E3;this.fromToDelta=this.options.to-this.options.from;this.totalTime=
this.finishOn-this.startOn;this.totalFrames=this.options.fps*this.options.duration;eval('this.render = function(pos){ if (this.state=="idle"){this.state="running";'+b(this.options,"beforeSetup")+(this.setup?"this.setup();":"")+b(this.options,"afterSetup")+'};if (this.state=="running"){pos=this.options.transition(pos)*'+this.fromToDelta+"+"+this.options.from+";this.position=pos;"+b(this.options,"beforeUpdate")+(this.update?"this.update(pos);":"")+b(this.options,"afterUpdate")+"}}");this.event("beforeStart");
this.options.sync||Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).add(this)},loop:function(a){if(a>=this.startOn)if(a>=this.finishOn){this.render(1);this.cancel();this.event("beforeFinish");this.finish&&this.finish();this.event("afterFinish")}else{a=(a-this.startOn)/this.totalTime;var b=(a*this.totalFrames).round();if(b>this.currentFrame){this.render(a);this.currentFrame=b}}},cancel:function(){this.options.sync||Effect.Queues.get(Object.isString(this.options.queue)?
"global":this.options.queue.scope).remove(this);this.state="finished"},event:function(a){this.options[a+"Internal"]&&this.options[a+"Internal"](this);this.options[a]&&this.options[a](this)},inspect:function(){var a=$H();for(property in this)Object.isFunction(this[property])||a.set(property,this[property]);return"#<Effect:"+a.inspect()+",options:"+$H(this.options).inspect()+">"}});
Effect.Parallel=Class.create(Effect.Base,{initialize:function(a,b){this.effects=a||[];this.start(b)},update:function(a){this.effects.invoke("render",a)},finish:function(a){this.effects.each(function(b){b.render(1);b.cancel();b.event("beforeFinish");b.finish&&b.finish(a);b.event("afterFinish")})}});
Effect.Tween=Class.create(Effect.Base,{initialize:function(a,b,c){a=Object.isString(a)?$(a):a;var d=$A(arguments),e=d.last();d=d.length==5?d[3]:null;this.method=Object.isFunction(e)?e.bind(a):Object.isFunction(a[e])?a[e].bind(a):function(g){a[e]=g};this.start(Object.extend({from:b,to:c},d||{}))},update:function(a){this.method(a)}});Effect.Event=Class.create(Effect.Base,{initialize:function(a){this.start(Object.extend({duration:0},a||{}))},update:Prototype.emptyFunction});
Effect.Opacity=Class.create(Effect.Base,{initialize:function(a,b){this.element=$(a);if(!this.element)throw Effect._elementDoesNotExistError;Prototype.Browser.IE&&!this.element.currentStyle.hasLayout&&this.element.setStyle({zoom:1});this.start(Object.extend({from:this.element.getOpacity()||0,to:1},b||{}))},update:function(a){this.element.setOpacity(a)}});
Effect.Move=Class.create(Effect.Base,{initialize:function(a,b){this.element=$(a);if(!this.element)throw Effect._elementDoesNotExistError;this.start(Object.extend({x:0,y:0,mode:"relative"},b||{}))},setup:function(){this.element.makePositioned();this.originalLeft=parseFloat(this.element.getStyle("left")||"0");this.originalTop=parseFloat(this.element.getStyle("top")||"0");if(this.options.mode=="absolute"){this.options.x-=this.originalLeft;this.options.y-=this.originalTop}},update:function(a){this.element.setStyle({left:(this.options.x*
a+this.originalLeft).round()+"px",top:(this.options.y*a+this.originalTop).round()+"px"})}});Effect.MoveBy=function(a,b,c,d){return new Effect.Move(a,Object.extend({x:c,y:b},d||{}))};
Effect.Scale=Class.create(Effect.Base,{initialize:function(a,b,c){this.element=$(a);if(!this.element)throw Effect._elementDoesNotExistError;this.start(Object.extend({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:"box",scaleFrom:100,scaleTo:b},c||{}))},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=this.element.getStyle("position");this.originalStyle={};["top","left","width","height","fontSize"].each(function(b){this.originalStyle[b]=
this.element.style[b]}.bind(this));this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var a=this.element.getStyle("font-size")||"100%";["em","px","%","pt"].each(function(b){if(a.indexOf(b)>0){this.fontSize=parseFloat(a);this.fontSizeType=b}}.bind(this));this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;this.dims=null;if(this.options.scaleMode=="box")this.dims=[this.element.offsetHeight,this.element.offsetWidth];if(/^content/.test(this.options.scaleMode))this.dims=
[this.element.scrollHeight,this.element.scrollWidth];if(!this.dims)this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth]},update:function(a){a=this.options.scaleFrom/100+this.factor*a;this.options.scaleContent&&this.fontSize&&this.element.setStyle({fontSize:this.fontSize*a+this.fontSizeType});this.setDimensions(this.dims[0]*a,this.dims[1]*a)},finish:function(){this.restoreAfterFinish&&this.element.setStyle(this.originalStyle)},setDimensions:function(a,b){var c={};
if(this.options.scaleX)c.width=b.round()+"px";if(this.options.scaleY)c.height=a.round()+"px";if(this.options.scaleFromCenter){a=(a-this.dims[0])/2;b=(b-this.dims[1])/2;if(this.elementPositioning=="absolute"){if(this.options.scaleY)c.top=this.originalTop-a+"px";if(this.options.scaleX)c.left=this.originalLeft-b+"px"}else{if(this.options.scaleY)c.top=-a+"px";if(this.options.scaleX)c.left=-b+"px"}}this.element.setStyle(c)}});
Effect.Highlight=Class.create(Effect.Base,{initialize:function(a,b){this.element=$(a);if(!this.element)throw Effect._elementDoesNotExistError;this.start(Object.extend({startcolor:"#ffff99"},b||{}))},setup:function(){if(this.element.getStyle("display")=="none")this.cancel();else{this.oldStyle={};if(!this.options.keepBackgroundImage){this.oldStyle.backgroundImage=this.element.getStyle("background-image");this.element.setStyle({backgroundImage:"none"})}if(!this.options.endcolor)this.options.endcolor=
this.element.getStyle("background-color").parseColor("#ffffff");if(!this.options.restorecolor)this.options.restorecolor=this.element.getStyle("background-color");this._base=$R(0,2).map(function(a){return parseInt(this.options.startcolor.slice(a*2+1,a*2+3),16)}.bind(this));this._delta=$R(0,2).map(function(a){return parseInt(this.options.endcolor.slice(a*2+1,a*2+3),16)-this._base[a]}.bind(this))}},update:function(a){this.element.setStyle({backgroundColor:$R(0,2).inject("#",function(b,c,d){return b+
(this._base[d]+this._delta[d]*a).round().toColorPart()}.bind(this))})},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}))}});Effect.ScrollTo=function(a,b){b=b||{};var c=document.viewport.getScrollOffsets();a=$(a).cumulativeOffset();var d=(window.height||document.body.scrollHeight)-document.viewport.getHeight();if(b.offset)a[1]+=b.offset;return new Effect.Tween(null,c.top,a[1]>d?d:a[1],b,function(e){scrollTo(c.left,e.round())})};
Effect.Fade=function(a,b){a=$(a);var c=a.getInlineOpacity();b=Object.extend({from:a.getOpacity()||1,to:0,afterFinishInternal:function(d){d.options.to==0&&d.element.hide().setStyle({opacity:c})}},b||{});return new Effect.Opacity(a,b)};
Effect.Appear=function(a,b){a=$(a);b=Object.extend({from:a.getStyle("display")=="none"?0:a.getOpacity()||0,to:1,afterFinishInternal:function(c){c.element.forceRerendering()},beforeSetup:function(c){c.element.setOpacity(c.options.from).show()}},b||{});return new Effect.Opacity(a,b)};
Effect.Puff=function(a,b){a=$(a);var c={opacity:a.getInlineOpacity(),position:a.getStyle("position"),top:a.style.top,left:a.style.left,width:a.style.width,height:a.style.height};return new Effect.Parallel([new Effect.Scale(a,200,{sync:true,scaleFromCenter:true,scaleContent:true,restoreAfterFinish:true}),new Effect.Opacity(a,{sync:true,to:0})],Object.extend({duration:1,beforeSetupInternal:function(d){Position.absolutize(d.effects[0].element)},afterFinishInternal:function(d){d.effects[0].element.hide().setStyle(c)}},
b||{}))};Effect.BlindUp=function(a,b){a=$(a);a.makeClipping();return new Effect.Scale(a,0,Object.extend({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(c){c.element.hide().undoClipping()}},b||{}))};
Effect.BlindDown=function(a,b){a=$(a);var c=a.getDimensions();return new Effect.Scale(a,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:c.height,originalWidth:c.width},restoreAfterFinish:true,afterSetup:function(d){d.element.makeClipping().setStyle({height:"0px"}).show()},afterFinishInternal:function(d){d.element.undoClipping()}},b||{}))};
Effect.SwitchOff=function(a,b){a=$(a);var c=a.getInlineOpacity();return new Effect.Appear(a,Object.extend({duration:0.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(d){new Effect.Scale(d.element,1,{duration:0.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetup:function(e){e.element.makePositioned().makeClipping()},afterFinishInternal:function(e){e.element.hide().undoClipping().undoPositioned().setStyle({opacity:c})}})}},b||{}))};
Effect.DropOut=function(a,b){a=$(a);var c={top:a.getStyle("top"),left:a.getStyle("left"),opacity:a.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(a,{x:0,y:100,sync:true}),new Effect.Opacity(a,{sync:true,to:0})],Object.extend({duration:0.5,beforeSetup:function(d){d.effects[0].element.makePositioned()},afterFinishInternal:function(d){d.effects[0].element.hide().undoPositioned().setStyle(c)}},b||{}))};
Effect.Shake=function(a,b){a=$(a);b=Object.extend({distance:20,duration:0.5},b||{});var c=parseFloat(b.distance),d=parseFloat(b.duration)/10,e={top:a.getStyle("top"),left:a.getStyle("left")};return new Effect.Move(a,{x:c,y:0,duration:d,afterFinishInternal:function(g){new Effect.Move(g.element,{x:-c*2,y:0,duration:d*2,afterFinishInternal:function(n){new Effect.Move(n.element,{x:c*2,y:0,duration:d*2,afterFinishInternal:function(l){new Effect.Move(l.element,{x:-c*2,y:0,duration:d*2,afterFinishInternal:function(m){new Effect.Move(m.element,
{x:c*2,y:0,duration:d*2,afterFinishInternal:function(r){new Effect.Move(r.element,{x:-c,y:0,duration:d,afterFinishInternal:function(B){B.element.undoPositioned().setStyle(e)}})}})}})}})}})}})};
Effect.SlideDown=function(a,b){a=$(a).cleanWhitespace();var c=a.down().getStyle("bottom"),d=a.getDimensions();return new Effect.Scale(a,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:d.height,originalWidth:d.width},restoreAfterFinish:true,afterSetup:function(e){e.element.makePositioned();e.element.down().makePositioned();window.opera&&e.element.setStyle({top:""});e.element.makeClipping().setStyle({height:"0px"}).show()},afterUpdateInternal:function(e){e.element.down().setStyle({bottom:e.dims[0]-
e.element.clientHeight+"px"})},afterFinishInternal:function(e){e.element.undoClipping().undoPositioned();e.element.down().undoPositioned().setStyle({bottom:c})}},b||{}))};
Effect.SlideUp=function(a,b){a=$(a).cleanWhitespace();var c=a.down().getStyle("bottom"),d=a.getDimensions();return new Effect.Scale(a,window.opera?0:1,Object.extend({scaleContent:false,scaleX:false,scaleMode:"box",scaleFrom:100,scaleMode:{originalHeight:d.height,originalWidth:d.width},restoreAfterFinish:true,afterSetup:function(e){e.element.makePositioned();e.element.down().makePositioned();window.opera&&e.element.setStyle({top:""});e.element.makeClipping().show()},afterUpdateInternal:function(e){e.element.down().setStyle({bottom:e.dims[0]-
e.element.clientHeight+"px"})},afterFinishInternal:function(e){e.element.hide().undoClipping().undoPositioned();e.element.down().undoPositioned().setStyle({bottom:c})}},b||{}))};Effect.Squish=function(a){return new Effect.Scale(a,window.opera?1:0,{restoreAfterFinish:true,beforeSetup:function(b){b.element.makeClipping()},afterFinishInternal:function(b){b.element.hide().undoClipping()}})};
Effect.Grow=function(a,b){a=$(a);var c=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},b||{}),d={top:a.style.top,left:a.style.left,height:a.style.height,width:a.style.width,opacity:a.getInlineOpacity()},e=a.getDimensions(),g,n,l,m;switch(c.direction){case "top-left":g=n=l=m=0;break;case "top-right":g=e.width;n=m=0;l=-e.width;break;case "bottom-left":g=l=0;n=e.height;m=-e.height;break;
case "bottom-right":g=e.width;n=e.height;l=-e.width;m=-e.height;break;case "center":g=e.width/2;n=e.height/2;l=-e.width/2;m=-e.height/2;break}return new Effect.Move(a,{x:g,y:n,duration:0.01,beforeSetup:function(r){r.element.hide().makeClipping().makePositioned()},afterFinishInternal:function(r){new Effect.Parallel([new Effect.Opacity(r.element,{sync:true,to:1,from:0,transition:c.opacityTransition}),new Effect.Move(r.element,{x:l,y:m,sync:true,transition:c.moveTransition}),new Effect.Scale(r.element,
100,{scaleMode:{originalHeight:e.height,originalWidth:e.width},sync:true,scaleFrom:window.opera?1:0,transition:c.scaleTransition,restoreAfterFinish:true})],Object.extend({beforeSetup:function(B){B.effects[0].element.setStyle({height:"0px"}).show()},afterFinishInternal:function(B){B.effects[0].element.undoClipping().undoPositioned().setStyle(d)}},c))}})};
Effect.Shrink=function(a,b){a=$(a);b=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},b||{});var c={top:a.style.top,left:a.style.left,height:a.style.height,width:a.style.width,opacity:a.getInlineOpacity()},d=a.getDimensions(),e,g;switch(b.direction){case "top-left":e=g=0;break;case "top-right":e=d.width;g=0;break;case "bottom-left":e=0;g=d.height;break;case "bottom-right":e=d.width;g=
d.height;break;case "center":e=d.width/2;g=d.height/2;break}return new Effect.Parallel([new Effect.Opacity(a,{sync:true,to:0,from:1,transition:b.opacityTransition}),new Effect.Scale(a,window.opera?1:0,{sync:true,transition:b.scaleTransition,restoreAfterFinish:true}),new Effect.Move(a,{x:e,y:g,sync:true,transition:b.moveTransition})],Object.extend({beforeStartInternal:function(n){n.effects[0].element.makePositioned().makeClipping()},afterFinishInternal:function(n){n.effects[0].element.hide().undoClipping().undoPositioned().setStyle(c)}},
b))};Effect.Pulsate=function(a,b){a=$(a);var c=b||{},d=a.getInlineOpacity(),e=c.transition||Effect.Transitions.sinoidal;b=function(g){return e(1-Effect.Transitions.pulse(g,c.pulses))};b.bind(e);return new Effect.Opacity(a,Object.extend(Object.extend({duration:2,from:0,afterFinishInternal:function(g){g.element.setStyle({opacity:d})}},c),{transition:b}))};
Effect.Fold=function(a,b){a=$(a);var c={top:a.style.top,left:a.style.left,width:a.style.width,height:a.style.height};a.makeClipping();return new Effect.Scale(a,5,Object.extend({scaleContent:false,scaleX:false,afterFinishInternal:function(){new Effect.Scale(a,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(d){d.element.hide().undoClipping().setStyle(c)}})}},b||{}))};
Effect.Morph=Class.create(Effect.Base,{initialize:function(a,b){this.element=$(a);if(!this.element)throw Effect._elementDoesNotExistError;a=Object.extend({style:{}},b||{});if(Object.isString(a.style))if(a.style.include(":"))this.style=a.style.parseStyle();else{this.element.addClassName(a.style);this.style=$H(this.element.getStyles());this.element.removeClassName(a.style);var c=this.element.getStyles();this.style=this.style.reject(function(d){return d.value==c[d.key]});a.afterFinishInternal=function(d){d.element.addClassName(d.options.style);
d.transforms.each(function(e){d.element.style[e.style]=""})}}else this.style=$H(a.style);this.start(a)},setup:function(){function a(b){if(!b||["rgba(0, 0, 0, 0)","transparent"].include(b))b="#ffffff";b=b.parseColor();return $R(0,2).map(function(c){return parseInt(b.slice(c*2+1,c*2+3),16)})}this.transforms=this.style.map(function(b){var c=b[0];b=b[1];var d=null;if(b.parseColor("#zzzzzz")!="#zzzzzz"){b=b.parseColor();d="color"}else if(c=="opacity"){b=parseFloat(b);Prototype.Browser.IE&&!this.element.currentStyle.hasLayout&&
this.element.setStyle({zoom:1})}else if(Element.CSS_LENGTH.test(b)){d=b.match(/^([\+\-]?[0-9\.]+)(.*)$/);b=parseFloat(d[1]);d=d.length==3?d[2]:null}var e=this.element.getStyle(c);return{style:c.camelize(),originalValue:d=="color"?a(e):parseFloat(e||0),targetValue:d=="color"?a(b):b,unit:d}}.bind(this)).reject(function(b){return b.originalValue==b.targetValue||b.unit!="color"&&(isNaN(b.originalValue)||isNaN(b.targetValue))})},update:function(a){for(var b={},c,d=this.transforms.length;d--;)b[(c=this.transforms[d]).style]=
c.unit=="color"?"#"+Math.round(c.originalValue[0]+(c.targetValue[0]-c.originalValue[0])*a).toColorPart()+Math.round(c.originalValue[1]+(c.targetValue[1]-c.originalValue[1])*a).toColorPart()+Math.round(c.originalValue[2]+(c.targetValue[2]-c.originalValue[2])*a).toColorPart():(c.originalValue+(c.targetValue-c.originalValue)*a).toFixed(3)+(c.unit===null?"":c.unit);this.element.setStyle(b,true)}});
Effect.Transform=Class.create({initialize:function(a,b){this.tracks=[];this.options=b||{};this.addTracks(a)},addTracks:function(a){a.each(function(b){b=$H(b);var c=b.values().first();this.tracks.push($H({ids:b.keys().first(),effect:Effect.Morph,options:{style:c}}))}.bind(this));return this},play:function(){return new Effect.Parallel(this.tracks.map(function(a){var b=a.get("ids"),c=a.get("effect"),d=a.get("options");return[$(b)||$$(b)].flatten().map(function(e){return new c(e,Object.extend({sync:true},
d))})}).flatten(),this.options)}});Element.CSS_PROPERTIES=$w("backgroundColor backgroundPosition borderBottomColor borderBottomStyle borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth borderRightColor borderRightStyle borderRightWidth borderSpacing borderTopColor borderTopStyle borderTopWidth bottom clip color fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop markerOffset maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex");
Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;String.__parseStyleElement=document.createElement("div");
String.prototype.parseStyle=function(){var a,b=$H();if(Prototype.Browser.WebKit)a=(new Element("div",{style:this})).style;else{String.__parseStyleElement.innerHTML='<div style="'+this+'"></div>';a=String.__parseStyleElement.childNodes[0].style}Element.CSS_PROPERTIES.each(function(c){a[c]&&b.set(c,a[c])});Prototype.Browser.IE&&this.include("opacity")&&b.set("opacity",this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1]);return b};
Element.getStyles=document.defaultView&&document.defaultView.getComputedStyle?function(a){var b=document.defaultView.getComputedStyle($(a),null);return Element.CSS_PROPERTIES.inject({},function(c,d){c[d]=b[d];return c})}:function(a){a=$(a);var b=a.currentStyle,c;c=Element.CSS_PROPERTIES.inject({},function(d,e){d.set(e,b[e]);return d});c.opacity||c.set("opacity",a.getOpacity());return c};
Effect.Methods={morph:function(a,b,c){a=$(a);new Effect.Morph(a,Object.extend({style:b},c||{}));return a},visualEffect:function(a,b,c){a=$(a);b=b.dasherize().camelize();b=b.charAt(0).toUpperCase()+b.substring(1);new Effect[b](a,c);return a},highlight:function(a,b){a=$(a);new Effect.Highlight(a,b);return a}};
$w("fade appear grow shrink fold blindUp blindDown slideUp slideDown pulsate shake puff squish switchOff dropOut").each(function(a){Effect.Methods[a]=function(b,c){b=$(b);Effect[a.charAt(0).toUpperCase()+a.substring(1)](b,c);return b}});$w("getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles").each(function(a){Effect.Methods[a]=Element[a]});Element.addMethods(Effect.Methods);
var GetText={catalog:new Hash,update:function(a){GetText.catalog.merge(a)},get:function(a){var b=GetText.catalog[a]||a;if(arguments.length>1){values=$A(arguments).slice(1,arguments.length);b=b.replace(/%[sdf]/g,function(){return String(values.shift())})}return b}};function gettext(a){return GetText.get.apply(this,arguments)}function _(){return GetText.get.apply(this,arguments)}var postloaded_ads=[];function registerAd(a){postloaded_ads.push(a)}
function movePostloadedAds(){var a=detectBrowser();for(a=0;a<postloaded_ads.length;a++){var b=postloaded_ads[a],c=document.getElementsByClassName("postloaded_ad "+b)[0];if(c!=undefined){var d=c.getElementsByTagName("script");if(d!=null)for(i=0;i<d.length;i++){var e=d[i];if(e.src.replace!=undefined)e.src.replace="/javascripts/ads_empty_script.js";else e.src="/javascripts/ads_empty_script.js"}d=document.getElementsByClassName("advertising ad_container "+b)[0];d.innerHTML="";d.className="advertising served_ad "+
b;c.parentNode.removeChild(c);c.className="";d.appendChild(c)}}}if(typeof Origo=="undefined")Origo={};
var Application={useAssetServers:true,overlayElement:function(a){var b=$("origo_overlays");if(a)if(b)a(b);else{Application.onDocumentReady(function(){var c=Application.overlayElement();c&&a(c)});return null}else if(!b){b=$(document.createElement("div"));b.className="origo_embed overlays";b.id="origo_overlays";$(document.body).appendChild(b)}return b},onDocumentReady:function(a){document.readyState==="complete"||document.loaded?a():$(document).observe("dom:loaded",a)},assetHost:function(a){a||(a="");
return this.useAssetServers?"http://media"+(1+a.length%4)+".origo.no"+a:a}},LazyLoading={add:function(a,b){Event.observe(window,"load",function(){new Ajax.Request("/-/site/populate_fragments",{method:"GET",asynchronous:true,evalScripts:true,parameters:a})});b&&window.setInterval(function(){new Ajax.Request("/-/site/populate_fragments",{method:"GET",asynchronous:true,evalScripts:true,parameters:a})},12E4)}},Window={getDimensions:function(){var a,b;if(window.innerWidth){a=window.innerWidth;b=window.innerHeight}else if(document.documentElement&&
document.documentElement.clientWidth){a=document.documentElement.clientWidth;b=document.documentElement.clientHeight}else if(document.body&&document.body.clientWidth){a=document.documentElement.clientWidth;b=document.documentElement.clientHeight}else b=a=0;return{width:a,height:b}}},Browser={supportsFlash:function(){if(navigator.plugins&&navigator.mimeTypes.length)return navigator.plugins["Shockwave Flash"]!=null?true:new ActiveXObject("ShockwaveFlash.ShockwaveFlash")!=null?true:false}};
Object.extend(Event,{getKey:function(a){return typeof a.keyCode!="undefined"?a.keyCode:a.which}});function setCookie(a,b,c,d,e,g){document.cookie=a+"="+escape(b)+(c?"; expires="+c.toGMTString():"")+(d?"; path="+d:"")+(e?"; domain="+e:"")+(g?"; secure":"")}function getCookie(a){var b=document.cookie;a=a+"=";var c=b.indexOf("; "+a);if(c==-1){c=b.indexOf(a);if(c!=0)return null}else c+=2;var d=document.cookie.indexOf(";",c);if(d==-1)d=b.length;return unescape(b.substring(c+a.length,d))}
function detectBrowser(){var a="",b=navigator.userAgent.toLowerCase();if(b.indexOf("opera")!=-1)a="opera";else if(b.indexOf("safari")!=-1)a="safari";else if(b.indexOf("msie 8")!=-1)a="ie8";else if(b.indexOf("msie 7")!=-1)a="ie7";else if(b.indexOf("msie 6")!=-1)a="ie6";else if(b.indexOf("msie 5")!=-1)a="ie5";else if(b.indexOf("netscape")!=-1)a="netscape";else if(b.indexOf("firefox")!=-1)a="firefox";else if(b.indexOf("gecko")!=-1)a="mozilla";return a}
function absoluteOffset(a){a=$(a);var b=0,c=0;if(a.parentNode){var d=false;do{if(a.tagName.toLowerCase()=="body")d=true;b+=a.offsetTop||0;c+=a.offsetLeft||0;if(!d){b-=a.scrollTop||0;c-=a.scrollLeft||0}a=a.offsetParent}while(a)}return new Element.Offset(c,b)}var TokenCompletionContinuation=Class.create({initialize:function(a){this.excess=a},getExcess:function(){return this.excess}}),TokenField=Class.create();
TokenField.prototype={initialize:function(a,b,c){this.element=$(document.createElement("div"));this.containerElement=$(a);this.containerElement.appendChild(this.element);this.completer=b;this.options=c;this.create()},clear:function(){if(this.element){Element.getElementsBySelector(this.element,".token_field_atom").each(function(a){this.removeAtomByElement(a)}.bind(this));this.adaptSize();this.hideCompletions();this.deactivate()}},create:function(){if(this.element)if(!this.inputElement){this.element.style.cursor=
"text";this.element.observe("click",function(){this.activate()}.bind(this));var a=$(document.createElement("span"));a.style.position="relative";a.style.styleFloat="left";a.style.cssFloat="left";a.style.paddingTop="8px";a.style.display="block";a.style.overflow="hidden";a.style.width="0px";a.style.cssFloat="left";a.style.styleFloat="left";a.appendChild(document.createTextNode("Moo"));this.element.appendChild(a);a=$(document.createElement("input"));a.type="text";a._internal=true;a.setAttribute("autocomplete",
"off");a.style.position="absolute";a.style.left="0";a.style.top="-10000px";a.observe("focus",function(){this.aboutToEnableFakeInput||this.activate();this.aboutToEnableFakeInput=false}.bind(this));a.observe("keydown",function(d){switch(d.keyCode){case Event.KEY_BACKSPACE:this.removeSelectedAtom();Element.getElementsBySelector(this.element,".token_field_atom.token_field_atom_selected").length==0&&this.activate();Event.stop(d);break;case Event.KEY_LEFT:case Event.KEY_UP:this.selectPreviousAtom();break;
case Event.KEY_RIGHT:case Event.KEY_DOWN:this.selectNextAtom();break;case Event.KEY_RETURN:Event.stop(d);break}}.bind(this),true);a.observe("keypress",function(d){Event.getKey(d)==Event.KEY_RETURN&&Event.stop(d);if(d.charCode&&d.charCode!=0&&!(d.ctrlKey||d.shiftKey||d.metaKey||d.altKey)&&d.keyCode>40){this.inputElement.value+=String.fromCharCode(d.charCode);this.activate();Event.stop(d)}}.bind(this),false);this.fakeInputElement=a;var b=$(document.createElement("span"));b.style.styleFloat="left";b.style.cssFloat=
"left";b.style.overflow="hidden";b.style.width="0px";b.style.height="0px";b.style.display="block";b.appendChild(a);this.element.appendChild(b);var c=$(document.createElement("input"));c.type="text";c.setAttribute("autocomplete","off");c.setAttribute("style","float: left");c.style.styleFloat="left";c.style.border="none";c.style.backgroundColor="transparent";c.style.verticalAlign="baseline";if(navigator.userAgent.match(/MSIE/)){c.style.position="relative";c.style.top="2px"}c.observe("keypress",function(d){Event.getKey(d)==
Event.KEY_RETURN&&Event.stop(d);this.allowEntry()||Event.stop(d)}.bind(this));c.observe("keydown",function(d){var e=Event.getKey(d);switch(e){case Event.KEY_BACKSPACE:if(c.value==""){this.selectLastAtom();Event.stop(d)}break;case Event.KEY_LEFT:case Event.KEY_UP:this.completionBox||this.selectLastAtom();break;case Event.KEY_ESC:if(this.completionBox){this.hideCompletions();Event.stop(d)}break;default:this.allowEntry()||Event.stop(d)}if(e==Event.KEY_RETURN||e==Event.KEY_TAB||e==188)if(this.addCompletionAsAtom()||
e==Event.KEY_RETURN)Event.stop(d)}.bind(this),false);c.observe("keyup",function(d){d.keyCode!=Event.KEY_BACKSPACE&&this.deselectAtoms();switch(d.keyCode){case Event.KEY_UP:this.selectPreviousCompletion();break;case Event.KEY_DOWN:this.selectNextCompletion();break;default:this.offerCompletions(c.value)}}.bind(this),true);c.observe("blur",function(d){Event.element(d)&&this.deactivate()}.bind(this));this.element.appendChild(c);this.inputElement=c;a=$(document.createElement("div"));a.style.clear="both";
a.style.overflow="hidden";a.style.width="0px";a.style.height="0px";this.element.appendChild(a)}},activate:function(){this.fakeInputElement.disabled="";this.inputElement.show();this.inputElement.focus();this.containerElement.addClassName("focused")},deactivate:function(){this.containerElement.removeClassName("focused");if(this.inputElement.value==""){this.inputElement.hide();this.fakeInputElement.disabled=""}},allowEntry:function(){return this.options.singleToken?Element.getElementsBySelector(this.element,
".token_field_atom").length==0:true},adaptSize:function(){var a=0,b=Element.getElementsBySelector(this.element,".token_field_atom").last();if(b){a=Position.cumulativeOffset(b)[0]-Position.cumulativeOffset(this.element)[0]+Element.getDimensions(b).width;a+=parseInt(Element.getStyle(b,"marginRight").gsub(/px$/,""))}b=(parseInt(Element.getStyle(this.element,"paddingLeft").gsub(/px$/,""))||0)+(parseInt(Element.getStyle(this.element,"paddingRight").gsub(/px$/,""))||0);if(Element.getStyle(this.element,
"borderLeft")!="")b+=1;if(Element.getStyle(this.element,"borderRight")!="")b+=1;b+=14;var c=Element.getDimensions(this.element);a=c.width-b-a;if(a<100)a=Math.max(0,c.width-b);this.inputElement.style.width=a+"px"},hideCompletions:function(){if(this.completionBox){this.completionBox.remove();this._currentText=this.completionBox=null}},offerCompletions:function(a){if(this.allowEntry()){a=a.strip();if(a!=this._currentText){this._currentText=a;if(this.completionOfferTimeout){window.clearTimeout(this.completionOfferTimeout);
this.completionOfferTimeout=null}this.completionOfferTimeout=window.setTimeout(function(){var b=function(c){this.populateCompletions(a,c)}.bind(this);if(this.completer.beginComplete)this.completer.beginComplete(a,b)&&this.setProgressing(true);else b(this.completer.complete(a))}.bind(this),this.options.completionDelay||500)}}},populateCompletions:function(a,b){this.setProgressing(false);this.hideCompletions();if(a.length>0){var c=this.inputElement.cumulativeOffset();c.left-=this.inputElement.cumulativeScrollOffset().left;
c.left+=$(document.body).cumulativeScrollOffset().left;c.top-=this.inputElement.cumulativeScrollOffset().top;c.top+=$(document.body).cumulativeScrollOffset().top;var d=this.inputElement.getDimensions(),e=$(document.createElement("div"));e.className="token_field_completion_box";e.style.left=c.left+"px";e.style.top=c.top+d.height+"px";e.style.width=Math.max(200,d.width)+"px";if(b.length>0)b.each(function(g,n){if(g instanceof TokenCompletionContinuation){n=$(document.createElement("div"));n.innerHTML=
"&hellip; "+_("og %d andre",g.getExcess());n.className="token_field_completion_meta";e.appendChild(n)}else{var l=$(document.createElement("a"));l.style.display="block";l.addClassName("token_field_completion_item");l._cookie=g;if(g.iconUrl){var m=$(document.createElement("img"));m.addClassName("token_field_completion_item_image");m.src=g.iconUrl;m.alt="";l.appendChild(m)}m=g.text.toLowerCase().indexOf(a.toLowerCase());m>0&&l.appendChild(document.createTextNode(g.text.substring(0,m)));var r=$(document.createElement("strong"));
r.appendChild(document.createTextNode(g.text.substring(m,m+a.length)));r.addClassName("token_field_completion_item_highlight");l.appendChild(r);m<g.text.length&&l.appendChild(document.createTextNode(g.text.substring(m+a.length)));n==0&&l.addClassName("token_field_completion_item_selected");l.observe("mousedown",function(){this.addCompletionAsAtom(g)}.bind(this),true);e.appendChild(l)}}.bind(this));else{b=$(document.createElement("div"));b.innerHTML=_("Ingen treff");b.addClassName("token_field_completion_meta");
e.appendChild(b)}document.body.appendChild(e);this.completionBox=e}},selectNextCompletion:function(){if(this.completionBox){var a=Element.getElementsBySelector(this.completionBox,".token_field_completion_item_selected")[0]||this.completionBox.firstChild,b=a.nextSibling||this.completionBox.firstChild;a.removeClassName("token_field_completion_item_selected");b.addClassName("token_field_completion_item_selected")}},selectPreviousCompletion:function(){if(this.completionBox){var a=Element.getElementsBySelector(this.completionBox,
".token_field_completion_item_selected")[0]||this.completionBox.lastChild,b=a.previousSibling||this.completionBox.lastChild;a.removeClassName("token_field_completion_item_selected");b.addClassName("token_field_completion_item_selected")}},selectedCompletion:function(){var a=null;if(this.completionBox){var b=Element.getElementsBySelector(this.completionBox,".token_field_completion_item_selected")[0];if(b)a=b._cookie}return a},addCompletionAsAtom:function(a){var b=false;if(a=a||this.selectedCompletion()){var c=
$(document.createElement("a"));c.href="#";c.className="token_field_atom";c.tabIndex=-1;c.observe("click",function(e){this.selectAtomByElement(c);Event.stop(e)}.bind(this));if(a.iconUrl){b=$(document.createElement("img"));b.addClassName("token_field_atom_image");b.src=a.iconUrl;b.alt="";c.appendChild(b)}c.appendChild(document.createTextNode(a.text));var d=$(document.createElement("img"));d.src="/images/forms/token_field_close.png";d.className="token_field_atom_close";d.observe("mouseover",function(){d.src=
"/images/forms/token_field_close_hover.png"}.bind(this));d.observe("mouseout",function(){d.src="/images/forms/token_field_close.png"}.bind(this));d.observe("click",function(){this.removeAtomByElement(c)}.bind(this));c.appendChild(d);b=$(document.createElement("input"));b.type="hidden";b.name=this.options.fieldName;b.value=a.id;c.appendChild(b);this.element.insertBefore(c,this.inputElement);this.inputElement.value="";b=true;this.atomsChanged()}return b},selectAtomByElement:function(a){this.deselectAtoms();
a&&a.addClassName("token_field_atom_selected");this.aboutToEnableFakeInput=true;this.fakeInputElement.disabled="";this.fakeInputElement.focus()},selectNextAtom:function(){var a=Element.getElementsBySelector(this.element,".token_field_atom_selected")[0];if(a){var b=a.nextSibling;if(b.hasClassName("token_field_atom")){a.removeClassName("token_field_atom_selected");b.addClassName("token_field_atom_selected")}else this.activate()}},selectPreviousAtom:function(){var a=Element.getElementsBySelector(this.element,
".token_field_atom_selected")[0];if(a){var b=a.previousSibling;if(b.hasClassName("token_field_atom")){a.removeClassName("token_field_atom_selected");b.addClassName("token_field_atom_selected")}}},selectLastAtom:function(){var a=Element.getElementsBySelector(this.element,".token_field_atom").last();a&&this.selectAtomByElement(a)},deselectAtoms:function(){Element.getElementsBySelector(this.element,".token_field_atom.token_field_atom_selected").each(function(a){a.removeClassName("token_field_atom_selected")})},
removeAtomByElement:function(a){a.remove();this.atomsChanged()},removeSelectedAtom:function(){var a=Element.getElementsBySelector(this.element,".token_field_atom.token_field_atom_selected").first();a?this.removeAtomByElement(a):this.selectLastAtom()},atomsChanged:function(){this.hideCompletions();this.adaptSize()},wrapInSpan:function(a,b){var c=$(document.createElement("span"));c.className=b;c.appendChild(a);return c},setProgressing:function(a){a?this.containerElement.addClassName("token_field_progressing"):
this.containerElement.removeClassName("token_field_progressing")}};
var ObscuringElements={hide:function(a){this.show();this.findAll(a).each(function(b){b.style.visibility="hidden";this.hiddenElements.push(b)}.bind(this))},show:function(){this.hiddenElements&&this.hiddenElements.each(function(a){a.style.visibility=""});this.hiddenElements=[]},findAll:function(a){var b=[];b=b.concat($$("object"));b=b.concat($$("embed")).select(function(c){return Element.visible(c)&&c.parentNode&&c.parentNode.nodeType==1&&c.parentNode.tagName.toUpperCase()!="OBJECT"});b=b.concat($$("input[type!=hidden]"));
b=b.concat($$("select"));if(a)b=b.select(a);return b}},BalloonGroups={},Balloons={all:[],lastHitBalloon:null,close:function(a){this.each(function(b){b.close(a)})},reposition:function(){this.each(function(a){a.reposition()})},find:function(a){return this.all.find(a)},closeByElement:function(a){var b=this.all.find(function(c){return c.getFrameElement().id==a});if(b){b.close();return true}else return false},findByElement:function(a){return this.all.find(function(b){return b.getFrameElement().id==a})},
register:function(a){this.all.push(a);this.balloonsChanged()},unregister:function(a){this.all=this.all.without(a);this.balloonsChanged()},each:function(a){return this.all.each(a)},findHitByEvent:function(a){var b=null;Balloons.each(function(c){if(c.isWithin(a)){b=c;throw $break;}});return b},start:function(){Event.observe(document,"click",function(a){(this.lastHitBalloon=a=this.findHitByEvent(a))||Balloons.close()}.bind(this));Event.observe(window,"resize",function(){Balloons.reposition()});navigator.userAgent.match(/Gecko/)&&
Event.observe(window,"scroll",function(){Balloons.reposition()});Event.observe(window,"keypress",function(a){a.keyCode==27&&Balloons.close()},true)},balloonsChanged:function(){this.all.length>0?ObscuringElements.hide(function(a){return!this.all.find(function(b){b=b.getFrameElement();return a.childOf(b)})}.bind(this)):ObscuringElements.show()}},Balloon=Class.create({initialize:function(a){this.options=a;this.group=a.group||"default";this.tail=typeof a.tail=="undefined"?"pyramid":a.tail;this.trigger=
typeof a.trigger=="undefined"?null:a.trigger;this.origin=typeof a.origin=="undefined"?null:a.origin;this.position=a.position;if(!this.position)this.position=new Balloon.Position.Vertical;this.onShow=a.onShow;this.onMayShow=a.onMayShow;this.onHide=a.onHide;this.onBeforeHide=a.onBeforeHide;this.onCreate=a.onCreate;this.progressLabel=a.progressLabel;this.width=a.width;this.url=a.url;this.parameters=a.parameters||{};this.dontCache=a.dontCache;this.id=a.id;this.loaded=false;this.closeable=a.closeable!=
false;this.timeout=a.timeout;this.className=a.className;this.overlayClass=a.overlayClass;this.frameElement=this.progressElement=this.overlayElement=null;this.contentElement=$(a.content);this.progressing=false;this.observers=[];this.assetHost=a.assetHost||"";this.requestType=!a.requestType&&typeof ORIGO!="undefined"&&typeof ORIGO.EMBED!=="undefined"?"embed":a.requestType||"ajax";this.requestType=="embed"&&this.assetHost!=""&&Balloon.Tails.setAssetHost(this.assetHost);this.contentElement&&this.contentElement.hide();
this.contentBody=a.contentHtml;a.trigger&&this.attach(a.trigger)},attach:function(a,b){b=b||"click";a=$(a);this.detach();this.trigger=a;this.observe(a,b,function(c){b=="click"?this.toggle():this.open();Event.stop(c)}.bind(this));b=="focus"&&this.observe(a,"blur",function(){window.setTimeout(function(){Balloons.lastHitBalloon!=this&&this.delayedClose();Balloons.lastHitBalloon=null}.bind(this),100)}.bind(this))},detach:function(){if(this.trigger&&this.observingEvent){this.unobserve(this.trigger);this.trigger=
null}},delayedClose:function(){window.setTimeout(function(){this.close()}.bind(this),100)},toggle:function(){this.isOpen()?this.close():this.open()},open:function(){if(!this.isOpen()){if(this.onMayShow)if(!this.onMayShow(this))return;if(this.group){var a=BalloonGroups[this.group];a&&a.close();BalloonGroups[this.group]=this}this.create();Position.prepare();Element.setOpacity(this.frameElement,1);Element.show(this.frameElement);if(this.tailElement){Element.setOpacity(this.tailElement,1);Element.show(this.tailElement)}(a=
$(this.trigger))&&a.addClassName("active");(a=$(this.origin))&&a.addClassName("active");this.reposition();this.onShow&&this.onShow(this);Balloons.register(this);this.url&&!this.loaded&&!this.loading&&this.loadFromUrl(this.url);this.timeout&&window.setTimeout(function(){this.close()}.bind(this),this.timeout)}},close:function(){if(this.isOpen()){Balloons.unregister(this);var a=false;if(this.onBeforeHide)a=this.onBeforeHide(panel)==false;if(!a){this.onHide&&function(){this.onHide(this)}.bind(this);this.frameElement.hide();
this.tailElement&&this.tailElement.hide()}(a=$(this.trigger))&&a.removeClassName("active");(a=$(this.origin))&&a.removeClassName("active");if(this.overlayElement){this.overlayElement.parentNode&&this.overlayElement.parentNode.removeChild(this.overlayElement);this.overlayElement=null}if(this.dontCache&&this.contentElement){this.contentElement.parentNode&&this.contentElement.parentNode.removeChild(this.contentElement);this.contentElement=null;this.loaded=false}}},isOpen:function(){return this.frameElement!=
null&&Element.visible(this.frameElement)},isWithin:function(a){a=Event.element(a);return this.contentElement!=null&&($(this.contentElement)==a||Element.childOf(a,$(this.contentElement)))||this.trigger!=null&&($(this.trigger)==a||Element.childOf(a,$(this.trigger)))},reposition:function(){this.frameElement&&this.position.position(this)},isLoaded:function(){return this.loaded},disableLoading:function(){this.url=null;this.loaded=false},setContentHtml:function(a){this.contentBody=a},getContentElement:function(){this.create();
return this.contentElement},getFrameElement:function(){this.create();return this.frameElement},getOverlayElement:function(){this.create();return this.overlayElement},getTailElement:function(){this.create();return this.tailElement},getTailStyle:function(){return this.tail},create:function(){var a=false;if(!this.frameElement){a=true;this.frameElement=this.createFrameElement();this.frameElement.style.display="none";if(this.width)this.frameElement.style.width=this.width+"px";this.appendElementToDocument(this.frameElement);
this.options.rounded&&Element.addClassName(this.frameElement,"balloon_rounded")}var b=this.frameElement;if(!this.progressElement){this.progressElement=this.createProgressElement();this.progressElement.style.display="none";b.appendChild(this.progressElement)}if(!this.contentElement){this.contentElement=this.createContentElement();if(this.contentBody)this.contentElement.innerHTML=this.contentBody}if(this.contentElement.parentNode!=b){this.contentElement.parentNode&&this.contentElement.parentNode.removeChild(this.contentElement);
b.appendChild(this.contentElement);$(this.contentElement).show()}if(!this.tailElement)if((this.trigger||this.origin)&&this.tail){this.tailElement=this.createTailElement(this.tail);this.tailElement.style.display="none";this.appendElementToDocument(this.tailElement)}if(this.overlayClass&&!this.overlayElement){this.overlayElement=document.createElement("div");this.overlayElement.className=this.overlayClass;this.appendElementToDocument(this.overlayElement)}a&&this.onCreate&&this.onCreate(this)},appendElementToDocument:function(a){if(this.requestType==
"embed")try{var b=document.getElementsByClassName("origo_embed");b&&b[0].appendChild(a)}catch(c){document.body.appendChild(a)}else document.body.appendChild(a)},loadFromUrl:function(a){this.loading=true;this.setProgress(true);var b=this.contentElement;if(this.requestType=="embed"){var c=(new Function("this.loading = false;\tthis.loaded = true;\tthis.setProgress(false);")).bind(this);if(a.substring(a.length-1,a.length)!="?"&&a.indexOf("?")==-1)a+="?";a=a+"&request_type=embed&update="+encodeURIComponent(b.id);
ORIGO.EMBED.AJAST.call(a,"js_callback",c)}else new Ajax.Updater({success:b},a,{asynchronous:true,evalScripts:true,method:"get",parameters:this.parameters,onFailure:function(d){Errors.reportForAjax(d,null);this.close()}.bind(this),onSuccess:function(){this.loaded=true}.bind(this),onComplete:function(){this.loading=false;this.setProgress(false)}.bind(this)})},setProgress:function(a){if(this.closeControlElement)a?Element.hide(this.closeControlElement):Element.show(this.closeControlElement);if(this.contentElement)a?
Element.hide(this.contentElement):Element.show(this.contentElement);if(this.progressElement)a?Element.show(this.progressElement):Element.hide(this.progressElement)},setTail:function(a){this.tail=a;this.reposition()},createFrameElement:function(){var a=document.createElement("div");if(this.id)a.id=this.id;var b="balloon";if(this.className){b+=" ";b+=this.className}a.className=b;if(this.closeable){this.closeControlElement=this.createCloseControlElement();a.appendChild(this.closeControlElement)}return a},
createContentElement:function(){var a=document.createElement("div");a.className="balloon_content";var b="balloon_content_"+(new Date).getTime();a.setAttribute("id",b);return a},createTailElement:function(a){a=Balloon.Tails.get(a).up;var b=document.createElement("img");b.src=a.image;b.className="balloon_tail";b.alt="";return b},createCloseControlElement:function(){var a=Balloon.Tails.assetHost||"",b=document.createElement("img");b.src=a+"/images/balloon/close.png";b.className="balloon_close_control";
b.alt="Lukk";b.title=b.alt;Event.observe(b,"click",function(c){this.close();Event.stop(c)}.bind(this));Event.observe(b,"selectstart",function(){return false});return b},createProgressElement:function(){var a=Balloon.Tails.assetHost||"",b=document.createElement("img");b.className="progress_indicator";b.src=a+"/images/progress/spinner_16.gif";b.style.width=16;b.style.height=16;b.alt=_("Vent litt");a=document.createElement("div");a.className="progress_message";a.appendChild(document.createTextNode(this.progressLabel||
""));a.appendChild(b);b=document.createElement("div");b.className="balloon_progress";b.appendChild(a);return b},observe:function(a,b,c){a.observe(b,c);this.observers[a]||(this.observers[a]=[]);this.observers[a].push([b,c])},unobserve:function(a){var b=this.observers[a];if(b){b.each(function(c){a.stopObserving(c[0],c[1])});delete this.observers[a]}}});Balloon.Position={};
Balloon.Position.Vertical=Class.create({initialize:function(a,b,c){this.adjustX=a||0;this.adjustY=b||0;this.alignment=c||Balloon.Position.Vertical.LEFT;this.positioned=false},position:function(a){var b=this.adjustX,c=this.adjustY,d=a.trigger?$(a.trigger):null,e=a.origin?$(a.origin):d,g=a.getTailElement(),n=a.getFrameElement(),l=a.getOverlayElement();if(g){a=Balloon.Tails.get(a.getTailStyle()).up;g.src=a.image;g.style.width=a.width+"px";g.style.height=a.height+"px"}if(!this.positioned)if(n.style.position!=
"absolute"){n.style.top="-500px";n.style.position="absolute";if(g){g.style.top="-500px";g.style.position="absolute"}}var m=absoluteOffset(e);a=absoluteOffset(e);var r=[],B=Element.getDimensions(n);if(this.alignment==Balloon.Position.Vertical.RIGHT){var z=Element.getDimensions(e);r[0]=m[0]+z.width-B.width;r[0]-=b}else{r[0]=m[0];r[0]+=b}if(g){b=Element.getDimensions(g);a[0]+=e.offsetWidth/2-b.width/2;a[1]+=e.offsetHeight;a[1]+=c;if(a[0]<r[0])a[0]=r[0];g.style.left=a[0]+"px";g.style.top=a[1]+"px";r[1]=
a[1];r[1]+=b.height-1}else{r[1]=m[1];r[1]+=e.offsetHeight+1;r[1]+=c}r[0]=Math.min(document.body.clientWidth-12-B.width,r[0]);r[0]=Math.max(12,r[0]);n.style.left=r[0]+"px";n.style.top=r[1]+"px";if(l&&d){c=Position.positionedOffset(d);g=Element.getDimensions(d);e=g.width-2;g=g.height-1;if(navigator.userAgent.match(/MSIE/)&&d.tagName.toUpperCase()!="INPUT"){e-=4;g-=2;c[1]+=2}l.style.position="absolute";l.style.left=c[0]+"px";l.style.top=c[1]+"px";l.style.width=e+"px";l.style.height=g+"px"}this.positioned=
true}});Balloon.Position.Vertical.LEFT=0;Balloon.Position.Vertical.RIGHT=1;
Balloon.Position.Horizontal=Class.create({initialize:function(a,b,c){this.adjustX=a||0;this.adjustY=b||0;this.alignment=c||Balloon.Position.Horizontal.LEFT},position:function(a){var b=this.adjustX,c=this.adjustY,d=a.trigger?$(a.trigger):null,e=d?$(a.trigger):$(a.origin),g=a.getTailElement(),n=a.getFrameElement(),l=a.getOverlayElement();if(g){a=Balloon.Tails.get(a.getTailStyle());a=this.alignment==Balloon.Position.Horizontal.RIGHT?a.left:a.right;g.src=a.image;g.style.width=a.width+"px";g.style.height=
a.height+"px"}if(n.style.position!="absolute"){n.style.top="-500px";n.style.position="absolute";if(g){g.style.top="-500px";g.style.position="absolute"}}a=absoluteOffset(e);var m=absoluteOffset(e),r=[],B=Element.getDimensions(n);if(g){var z=Element.getDimensions(g);if(this.alignment==Balloon.Position.Horizontal.RIGHT){b=Element.getDimensions(e);r[0]=a[0];r[0]+=b.width;r[0]+=z.width;r[1]=a[1];r[1]-=5;r[1]+=c;m[0]+=b.width;m[0]+=1;m[1]+=c}else{r[0]=a[0];r[0]+=b;r[0]-=B.width;r[0]-=z.width;r[1]=a[1];
r[1]-=5;r[1]+=c;m[0]-=z.width;m[0]-=1;m[1]+=c;if(m[1]<r[1])m[1]=r[1]+1}g.style.left=m[0]+"px";g.style.top=m[1]+"px"}else{if(this.alignment==Balloon.Position.Horizontal.RIGHT){b=Element.getDimensions(e);r[0]=a[0];r[0]+=b.width;r[1]=a[1]}else{r[0]=a[0];r[0]+=b;r[1]=a[1];r[1]+=e.offsetHeight+1}r[1]+=c}if(r[0]+B.width>document.body.clientWidth-12)r[0]=document.body.clientWidth-12-B.width;r[0]=Math.max(12,r[0]);n.style.left=r[0]+"px";n.style.top=r[1]+"px";if(l&&d){c=Position.positionedOffset(d);g=Element.getDimensions(d);
d=g.width-2;g=g.height-4;if(navigator.userAgent.match(/MSIE/)){d-=4;g-=2;c[1]+=2}l.style.position="absolute";l.style.left=c[0]+"px";l.style.top=c[1]+"px";l.style.width=d+"px";l.style.height=g+"px"}}});Balloon.Position.Horizontal.LEFT=0;Balloon.Position.Horizontal.RIGHT=1;
Balloon.Tails={tails:{},assetHost:"",register:function(a,b){this.tails[a]=b},get:function(a){return this.tails[a]},setAssetHost:function(a){if(this.assetHost==""){this.assetHost=a;for(var b in this.tails)for(var c in this.tails[b])this.tails[b][c].image=this.assetHost+this.tails[b][c].image}}};
Balloon.Tails.register("pyramid",{up:{image:"/images/balloon/balloon_tail_pyramid_up.png",width:52,height:17},down:{image:"/images/balloon/balloon_tail_pyramid_down.png",width:52,height:17},left:{image:"/images/balloon/balloon_tail_pyramid_left.png",width:17,height:34},right:{image:"/images/balloon/balloon_tail_pyramid_right.png",width:17,height:34}});Balloon.Tails.register("pyramid_with_shadow",{up:{image:"/images/balloon/balloon_tail_pyramid_up_shadowed_24.png",width:52,height:17}});
Balloon.Tails.register("slanted",{up:{image:"/images/balloon/balloon_tail_slanted_up.png",width:41,height:33},down:{image:"/images/balloon/balloon_tail_slanted_down.png",width:41,height:33}});Balloons.start();
var BorderSupport={shouldFixImages:function(){if(this.weFixImages==null){var a=false;if(navigator.userAgent.match(/MSIE [0-6]/)){a=parseFloat(navigator.appVersion.split("MSIE")[1]);a=a>=5.5&&a<7&&document.body.filters}this.weFixImages=a}return this.weFixImages},fixImage:function(a){if(this.shouldFixImages())if(a.width&&a.height&&a.width>0&&a.height>0){a.style.width=a.width+"px";a.style.height=a.height+"px";a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a.src+"', sizingMethod='scale')";
a.src="/images/blank.png"}return a},fixCell:function(a){if(this.shouldFixImages())if(a.style.backgroundImage){var b=a.style.backgroundImage.match(/url\((.*)\)/);a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b[1]+"', sizingMethod='scale')";a.style.backgroundImage="none"}return a}},Border=Class.create();
Border.prototype={initialize:function(a,b){this.spec=(new Hash(b)).toArray().map(function(r){return Border.LONG_TO_SHORT_OPTIONS[r[0]]+"="+r[1]}).join("_");var c=b.width||b.height,d=b.height||b.width,e=(b.width||b.height)-2;d=(b.height||b.width)-2;c=0;if(b.borderWidth&&b.borderColour)c=b.borderWidth;if(b.borderGradient)c=1;var g=e*2+1-c,n=d*2+1-c;e=g+c+1;d=n+c+1;if(b.shadow){g+=10;n+=10;var l=b.shadowPadding;if(!l&&l!=0)l=2;var m=b.shadowY||0;g=g+c*2+l*2;c=n+c*2+l*2;n=b.shadowMargin||0;e=Math.max(e,
Math.max(l+Math.abs(b.shadowX||0)*2)+g+2*n+2);d=Math.max(d,Math.max(l+Math.abs(m)*2)+c+2*n+2)}if(e%2==1)e+=1;if(d%2==1)d+=1;c=Math.floor(e/2);d=Math.floor(d/2);this.tileWidth=c;this.tileHeight=d;e=document.createElement("table");e.style.borderSpacing=0;e.style.borderCollapse="collapse";e.style.border="none";if(a=$(a)){l=null;if(document.defaultView&&document.defaultView.getComputedStyle)l=document.defaultView.getComputedStyle(a,"");else if(a.currentStyle)l=a.currentStyle;if(l){if(m=l.cssFloat||l.styleFloat){e.setAttribute("style",
"float: "+m);e.style.styleFloat=m;e.style.cssFloat=m}e.style.marginTop=l.marginTop;e.style.marginLeft=l.marginLeft;e.style.marginRight=l.marginRight;e.style.marginBottom=l.marginBottom;e.style.position=l.position;e.style.left=l.left;e.style.top=l.top;e.style.right=l.right;e.style.bottom=l.bottom}if(b.colour)a.style.backgroundColor="#"+b.colour;a.style.margin="0px";a.style.position="static";a.style.left="auto";a.style.top="auto";a.style.right="auto";a.style.bottom="auto";a.style.styleFloat="none";
a.style.cssFloat="none";if(a.parentNode){a.parentNode.insertBefore(e,a);a.remove()}this.content=a}a=document.createElement("thead");l=document.createElement("tr");m=document.createElement("td");m.style.padding="0";m.style.verticalAlign="bottom";g=document.createElement("img");g.src=this.getTile("tl");g.width=c;g.height=d;BorderSupport.fixImage(g);m.appendChild(g);l.appendChild(m);m=document.createElement("td");m.style.padding="0";m.style.background="url("+this.getTile("tm")+") repeat-x";m.style.height=
d;BorderSupport.fixCell(m);l.appendChild(m);m=document.createElement("td");m.style.padding="0";m.style.verticalAlign="bottom";g=document.createElement("img");g.src=this.getTile("tr");g.width=c;g.height=d;g=BorderSupport.fixImage(g);m.appendChild(g);l.appendChild(m);a.appendChild(l);e.appendChild(a);a=document.createElement("tbody");l=document.createElement("tr");m=document.createElement("td");m.style.padding="0";m.style.background="url("+this.getTile("l")+") repeat-y";m.width=c;BorderSupport.fixCell(m);
l.appendChild(m);m=document.createElement("td");m.style.padding="0";m.style.verticalAlign="top";if(b.colour)m.style.backgroundColor="#"+b.colour;this.content&&m.appendChild(this.content);this.container=m;l.appendChild(m);m=document.createElement("td");m.style.padding="0";m.style.background="url("+this.getTile("r")+") repeat-y";m.width=c;BorderSupport.fixCell(m);l.appendChild(m);a.appendChild(l);e.appendChild(a);if(!b.skipBottom){b=document.createElement("tfoot");a=document.createElement("tr");l=document.createElement("td");
l.style.padding="0";m=document.createElement("img");m.src=this.getTile("bl");m.width=c;m.height=d;m=BorderSupport.fixImage(m);l.appendChild(m);a.appendChild(l);l=document.createElement("td");l.style.padding="0";l.style.background="url("+this.getTile("bm")+") repeat-x";l.height=d;BorderSupport.fixCell(l);a.appendChild(l);l=document.createElement("td");l.style.padding="0";m=document.createElement("img");m.src=this.getTile("br");m.width=c;m.height=d;m=BorderSupport.fixImage(m);l.appendChild(m);a.appendChild(l);
b.appendChild(a);e.appendChild(b)}this.frame=e},getTile:function(a){return Application.assetHost("/-/cache/border/"+this.spec+"_t="+a+"_24.png")},getFrame:function(){return this.frame},getContent:function(){return this.content},getContainer:function(){return this.container},getTileWidth:function(){return this.tileWidth},getTileHeight:function(){return this.tileHeight}};
Border.LONG_TO_SHORT_OPTIONS={width:"w",height:"h",borderWidth:"bw",borderColour:"bc",borderGradient:"bgr",backgroundColour:"bg",colour:"c",shadow:"sw",shadowX:"sx",shadowY:"sy",shadowMargin:"sm",shadowPadding:"sp",shadowBlurRadius:"sbr",shadowBlurSigma:"sbs",tile:"t"};
var DatePicker=Class.create({initialize:function(a,b){this.options=b;this.horizontalPages=this.options.horizontalPages||2;this.date=a||new Date;this.selectedElement=null;this.pageMargin=5;this.buffer=1;this.scrollOffset=this.acceleration=this.speed=0;this.balloon=this.totalWidth=null;this.focusDate=this.date},create:function(){var a=$(document.createElement("table"));a.className="pages_table";var b=$(document.createElement("tbody"));a.appendChild(b);var c=$(document.createElement("tr"));b.appendChild(c);
if(!this.options.noArrows){b=$(document.createElement("td"));b.className="arrow_left";b.observe("click",function(e){this.scrollPrevious();var g=window.getSelection?window.getSelection():null;g&&g.removeAllRanges();Event.stop(e);return false}.bind(this));c.appendChild(b)}b=$(document.createElement("td"));b.className="pages_cell";c.appendChild(b);var d=$(document.createElement("div"));d.className="pages_container";d.style.position="relative";b.appendChild(d);this.pagesContainerElement=d;b=$(document.createElement("div"));
b.className="pages";this.pagesElement=b;this.pagesContainerElement.appendChild(this.pagesElement);if(!this.options.noArrows){b=$(document.createElement("td"));b.className="arrow_right";b.observe("click",function(e){this.scrollNext();var g=window.getSelection?window.getSelection():null;g&&g.removeAllRanges();Event.stop(e);return false}.bind(this));c.appendChild(b)}c=$(document.createElement("div"));c.className="date_picker";c.appendChild(a);return c},createPages:function(a,b){for(var c=[],d=a.getFullYear();d<=
b.getFullYear();d++)for(var e=0;e<12;e++){var g=new Date(d,e,1);if(g.getTime()>=a.getTime()&&g<=b.getTime()){g=this.createPage(g);c.push(g)}}return c},createPage:function(a){var b=$(document.createElement("div"));b.className="page";for(var c=new Date(a.getFullYear(),a.getMonth(),1);c.getDay()!=1;)c.setDate(c.getDate()-1);for(var d=new Date(a.getFullYear(),a.getMonth()+1,-1);d.getDay()<6;)d.setDate(d.getDate()+1);var e=$(document.createElement("table"));b.appendChild(e);var g=$(document.createElement("tbody"));
e.appendChild(g);e=$(document.createElement("tr"));var n=$(document.createElement("th"));n.colSpan=7;n.className="month_heading";n.appendChild(document.createTextNode(DatePicker.MONTH_NAMES[a.getMonth()]));n.appendChild(document.createTextNode(" "));n.appendChild(document.createTextNode(a.getFullYear()));e.appendChild(n);g.appendChild(e);e=[1,2,3,4,5,6,0];var l=$(document.createElement("tr"));e.each(function(F){var J=$(document.createElement("th"));J.className="day";if(F==0)J.className+=" holiday";
J.appendChild(document.createTextNode(DatePicker.DAY_NAMES[F].slice(0,1)));l.appendChild(J)});g.appendChild(l);for(var m=c,r=new Date,B=function(F){Event.element(F).addClassName("hover")},z=function(F){Event.element(F).removeClassName("hover")};m<=d;){var E=$(document.createElement("tr"));e.each(function(F){var J=$(document.createElement("td"));if(m.getMonth()==a.getMonth()){J.className="day";if(m.getFullYear()==r.getFullYear()&&m.getMonth()==r.getMonth()&&m.getDate()==r.getDate())J.className+=" today";
if(F==0)J.className+=" holiday";J.appendChild(document.createTextNode(m.getDate()));J.date=m;if(navigator.userAgent.match(/MSIE [0-6]/)){J.observe("mouseover",B);J.observe("mouseout",z)}J.observe("click",function(D){D=Event.element(D);this.selected(D.date,D)}.bind(this))}E.appendChild(J);m=new Date(m);m.setDate(m.getDate()+1)}.bind(this));g.appendChild(E)}return b},selected:function(a,b){if(this.selectedElement){this.selectedElement.removeClassName("selected");this.selectedElement=null}b.addClassName("selected");
this.selectedElement=b;this.date=a;this.options.onSelect&&this.options.onSelect(a);this.balloon&&this.balloon.close()},scrollToDate:function(a){if(a.getFullYear()!=this.focusDate.getFullYear()||a.getMonth()!=this.focusDate.getMonth()){var b=this.dateWithRelativeMonth(this.focusDate,-1),c=this.dateWithRelativeMonth(this.focusDate,this.horizontalPages+1);if(a<b||a>=c){this.focusDate=this.dateWithRelativeMonth(a,0);this.repopulate()}else this.scrollRelative(a<this.focusDate?-1:1)}},scrollRelative:function(a){if(a!=
0){a/=Math.abs(a);if(a<0)new Effect.ScrollElementTo(this.pagesContainerElement,{toX:this.scrollOffsetForPage(-1),duration:0.5,transition:Effect.Transitions.sinoidal,afterFinish:function(){$(this.pagesElement.lastChild).remove();this.focusDate=this.dateWithRelativeMonth(this.focusDate,a);this.pagesElement.insertBefore(this.createPage(this.dateWithRelativeMonth(this.focusDate,-this.buffer)),this.pagesElement.firstChild);this.pagesContainerElement.scrollLeft=this.scrollOffsetForPage(0)}.bind(this),queue:"end"});
else new Effect.ScrollElementTo(this.pagesContainerElement,{toX:this.scrollOffsetForPage(1),duration:0.5,transition:Effect.Transitions.sinoidal,afterFinish:function(){$(this.pagesElement.firstChild).remove();this.focusDate=this.dateWithRelativeMonth(this.focusDate,a);this.pagesElement.appendChild(this.createPage(this.dateWithRelativeMonth(this.focusDate,this.horizontalPages+this.buffer-1)));this.pagesContainerElement.scrollLeft=this.scrollOffsetForPage(0)}.bind(this),queue:"end"})}},scrollPrevious:function(){this.scrollRelative(-1)},
scrollNext:function(){this.scrollRelative(1)},scrollOffsetForPage:function(a){var b=this.pageMargin*2,c=(this.buffer+a)*this.pageWidth;c+=b/2;if(navigator.userAgent.match(/MSIE/)){if(a==1)c+=b/2;c+=b}if(a>=0)c+=b/2;return c},setBalloon:function(a){this.balloon=a},repopulate:function(){for(;this.pagesElement.firstChild;)this.pagesElement.removeChild(this.pagesElement.firstChild);this.populate()},populate:function(){if(!this.pageWidth){var a=this.createPage(this.date);this.pagesElement.appendChild(a);
this.pageWidth=a.getDimensions().width+this.pageMargin;this.pagesContainerElement.style.height=a.getDimensions().height+"px";this.pagesContainerElement.style.width=this.horizontalPages*this.pageWidth+"px";this.pagesElement.removeChild(a)}if(!this.pagesElement.firstChild){a=this.dateWithRelativeMonth(this.focusDate,-this.buffer);var b=this.dateWithRelativeMonth(this.focusDate,this.horizontalPages+this.buffer-1);this.createPages(a,b).each(function(c){this.pagesElement.appendChild(c)}.bind(this));this.pagesContainerElement.scrollLeft=
this.scrollOffsetForPage(0)}},dateWithRelativeMonth:function(a,b){return new Date(a.getFullYear(),a.getMonth()+b,1)},insertInto:function(a){$(a).appendChild(this.create());this.populate()}});DatePicker.DAY_NAMES=[_("s\u00f8ndag"),_("mandag"),_("tirsdag"),_("onsdag"),_("torsdag"),_("fredag"),_("l\u00f8rdag")];DatePicker.MONTH_NAMES=[_("januar"),_("februar"),_("mars"),_("april"),_("mai"),_("juni"),_("juli"),_("august"),_("september"),_("oktober"),_("november"),_("desember")];
DatePicker.attachBalloon=function(a,b){b=$(b);var c=document.createElement("img");c.className="date_picker_arrow";c.src="/images/forms/date_picker_button.png";c.alt="...";b.parentNode.insertBefore(c,b.nextSibling);var d=new Balloon({content:a.create(),className:"date_picker_balloon",closeable:true,position:new Balloon.Position.Vertical(-145,0),origin:b,tail:null,rounded:true,onMayShow:function(){return!b.disabled},onShow:function(){a.populate()}});d.attach(c);a.setBalloon(d);return a};
var DropDownGroups={},DropDowns={_all:[],close:function(a){this.each(function(b){b.close(a)})},find:function(a){return this._all.find(a)},register:function(a){this._all[this._all.length]=a},each:function(a){return this._all.each(a)}},DropDown=Class.create();
DropDown.prototype={initialize:function(a,b,c){this.panel=b;this.link=a;$(this.link).onclick=function(){this.toggle();return false}.bind(this);this.group=c.group;this.position=c.position;this.onShow=c.onShow;this.onHide=c.onHide;this.onAfterHide=c.onAfterHide;DropDowns.register(this)},toggle:function(){this.isOpen()?this.close():this.open()},open:function(){if(!this.isOpen()){var a=$(this.panel),b=$(this.link);if(this.group){var c=DropDownGroups[this.group];c&&c.close();DropDownGroups[this.group]=
this}a.parentElement.removeChild(a);document.body.appendChild(a);Element.addClassName(b,"active");this.position&&this.position(b,a);b=false;if(this.onShow)b=this.onShow(a)==false;b||Element.show(a)}},close:function(a){if(this.isOpen()){var b=$(this.panel),c=$(this.link),d=false;if(this.onHide)d=this.onHide(b)==false;if(!d)if(a){Element.hide(b);this.onAfterHide&&this.onAfterHide(b)}else new Effect.Fade(b,{duration:0.25,from:1,afterFinish:function(){this.onAfterHide&&this.onAfterHide(b)}.bind(this)});
Element.removeClassName(c,"active")}},isOpen:function(){return Element.visible($(this.panel))}};DropDown.Above=function(a,b,c){b||(b=0);c||(c=0);return function(d,e){var g=b,n=c;for(d=d;d;){g+=d.offsetLeft;n+=d.offsetTop;d=d.offsetParent}e.style.position="absolute";e.style.top=n-a+1+"px";e.style.left=g+"px"}};
DropDown.Below=function(a,b){a||(a=0);b||(b=0);return function(c,d){for(var e=Element.getDimensions(d),g=a,n=b,l=c;l;){g+=l.offsetLeft;n+=l.offsetTop;l=l.offsetParent}n+=c.clientHeight;n-=1;if(g+e.width>=document.width-10)g=document.width-e.width-10;d.style.position="absolute";d.style.top=n+"px";d.style.left=g+"px"}};
DropDown.BelowFlushRight=function(a,b){a||(a=0);b||(b=0);return function(c,d){d.style.position="absolute";d.style.top=b+c.offsetTop+c.offsetHeight-1+"px";d.style.left=a+c.offsetLeft+c.offsetWidth-Element.getDimensions(d)+"px"}};Event.observe(document,"click",function(a){var b=Event.element(a),c=false;DropDowns.each(function(d){c=c||b==$(d.panel)||b==$(d.link)||Element.childOf(b,$(d.panel))||Element.childOf(b,$(d.link))});c||DropDowns.close()});Event.observe(window,"resize",function(){DropDowns.close(true)});
Event.observe(window,"blur",function(){});Effect.ScrollElementTo=Class.create(Effect.Base,{initialize:function(a,b){this.element=$(a);this.start(b||{})},setup:function(){this.scrollStartX=this.element.scrollLeft;this.scrollStartY=this.element.scrollTop;this.deltaX=this.options.toX-this.scrollStartX;this.deltaY=this.options.toY-this.scrollStartY},update:function(a){this.element.scrollLeft=this.scrollStartX+a*this.deltaX;this.element.scrollTop=this.scrollStartY+a*this.deltaY}});
Effect.MoveAbsolutely=Class.create(Effect.Base,{initialize:function(a,b){this.element=$(a);this.start(b||{})},setup:function(){this.element.makePositioned();var a=parseFloat(this.element.getStyle("left")||"0"),b=parseFloat(this.element.getStyle("top")||"0");this.startX=this.options.fromX||a;this.startY=this.options.fromY||b;this.deltaX=(this.options.toX||a)-this.startX;this.deltaY=(this.options.toY||b)-this.startY},update:function(a){if(this.options.fromX||this.options.toX)this.element.style.left=
this.startX+a*this.deltaX+"px";if(this.options.fromY||this.options.toY)this.element.style.top=this.startY+a*this.deltaY+"px"}});
var Errors={exceptionHandler:function(a,b){this.reportForAjax(a,b.toString())},descriptionFromRequest:function(a,b){var c=null;if(a.getResponseHeader)c=a.getResponseHeader("X-Error-Message");c=c||b;if(c===null&&a.statusText&&a.statusText!="OK")c=a.statusText;if(!c)if(a.status==503)c=_("Vi oppgraderer Origo akkurat n\u00e5. Dette kan ta et minutt eller to.");else{c=_("Beklager, noe gikk galt ved kontakt med tjeneren");if(a.status&&a.status!=500){c+=" (feilkode ";c+=a.status;c+=")"}}c+=".";return c},
reportException:function(a){a=a.message;if(a===null||a==="")a=_("(Ingen feilmelding)");alert(_("En feil skjedde: %s",a))},reportForAjax:function(a,b){alert(this.descriptionFromRequest(a,b))},reportForEmbed:function(){alert(_("Beklager, noe gikk galt ved kontakt med tjeneren"))},logException:function(a){if(typeof console!="undefined")try{console.log(a)}catch(b){}},log:function(a){typeof console!="undefined"&&console.log(a.toString())}},TextileEditing=Class.create({initialize:function(a){this._fieldElement=
$(a)},bold:function(){var a=Form.getSelection(this._fieldElement)||prompt(_("Skriv tekst som skal legges inn som uthevet"),"");a&&Form.insertIntoTextField(this._fieldElement,"*"+a+"*",{focusAfter:true})},italic:function(){var a=Form.getSelection(this._fieldElement)||prompt(_("Skriv tekst som skal legges inn i kursiv"),"");a&&Form.insertIntoTextField(this._fieldElement,"_"+a+"_",{focusAfter:true})},continuationBreak:function(){if(/<!--mer.*--\>/.match(this._fieldElement.value))alert(_("Du har allerede et ingress-skille ('<!--mer--\>') i teksten din."));
else{var a=prompt(_("Skriv tekst som skal brukes til \u00e5 lage 'Les mer'-lenken som g\u00e5r til innholdssiden. Om du ikke skriver noe her vil 'Les mer' brukes."),""),b="mer";if(a&&a!=="")b+=" "+a;Form.insertIntoTextField(this._fieldElement,"\n\n<!--"+b+"--\>\n\n",{deselectBefore:true,focusAfter:true})}},link:function(){var a=Form.getSelection(this._fieldElement)||prompt(_("Skriv lenketeksten"),"");if(a){var b=prompt(_("Skriv adressen som skal lenkes til"),"http://");if(b){Form.insertIntoTextField(this._fieldElement,
'"'+a+'":'+b,{focusAfter:true});new Tooltip(this._fieldElement,{content:_('Lenken har blitt lagt inn som en spesiell formatkode. Sjekk lenken "Om formatkoder" over tekstfeltet for hjelp og inspirasjon.'),horizontalAlignment:"center",popup:true})}}},addImage:function(a,b){a.length||(a=$A([a]));if(a.length>0){var c;c=b=="left"?" venstre 250x":b=="right"?" h\u00f8yre 250x":"";var d="";if(b=="slideshow"){d+="[bildeserie]\n";a.each(function(e){d+="!bilde "+e.id+c+"!\n"});d+="[/bildeserie]"}else if(b==
"grid"){d+="[bilderutenett 3]\n";a.each(function(e){d+="!bilde "+e.id+c+"!\n"});d+="[/bilderutenett]"}else a.each(function(e){if(d.length>0)d+="\n";d+="!bilde "+e.id+c+"!"});Form.insertIntoTextField(this._fieldElement,d,{deselectBefore:true,padding:"\n\n",selectAfter:true,focusAfter:true});new Tooltip(this._fieldElement,{content:_('Bildene (eller bildet) du har lagt inn har blitt satt inn i teksten som spesielle bildekoder. Du kan flytte p\u00e5 disse og endre p\u00e5 dem for \u00e5 forandre utseendet. Sjekk lenken "Om formatkoder" over tekstfeltet for mer nyttig informasjon.'),
horizontalAlignment:"center",verticalAlign:"bottom",popup:true})}},observeImages:function(a,b){a=$(a);b=$(b);if(!this.selectorElement){var c=$(document.createElement("div"));c.hide();c.addClassName("textile_image_selector");var d=$(document.createElement("p"));d.appendChild(document.createTextNode(_("Velg hvilket bilde som skal brukes i sammendrag, feeds, lokalavisen osv.")));c.appendChild(d);this.imageListElement=$(document.createElement("ul"));this.imageListElement.addClassName("textile_image_selector_images");
c.appendChild(this.imageListElement);d=$(document.createElement("div"));d.addClassName("clear");c.appendChild(d);a.parentNode.insertBefore(c,a.nextSibling);this.selectorElement=c}var e=function(){var n=b.value||undefined;this.imageListElement.select("li").each(function(l){l._imageId==n?l.addClassName("selected"):l.removeClassName("selected")})}.bind(this),g=function(n){function l(z){var E=$(document.createElement("img"));E.src=Application.assetHost("/-/image/preview/"+z+"_h0_48x48.jpg");E.alt="";
var F=new Element("li");F._imageId=z;return E.wrap(F)}var m=this.imageListElement;for(this.selectorElement[n.length>0?"show":"hide"]();m.firstChild;)m.removeChild(m.firstChild);var r=function(z){b.value=z;e()},B=(new Element("p")).insert(_("Ikke bruk bilde")).wrap("li");B.observe("click",r.curry(""));m.appendChild(B);n.each(function(z){var E=l(z);E.observe("click",r.curry(z));m.appendChild(E)});e()}.bind(this);c=function(){var n=$A(),l=true;return function(){var m=$A();a.value.scan(/!bilde (\d+)/,
function(r){m.push(r[1])});m.uniq().sort();if(m.length!=n.length||n.intersect(m).length!=m.length){if(!l&&n.length==0)b.value=m.first();g(m)}n=m;l=false}}();c();window.setInterval(c,1E3)}}),LiveValidation=Class.create({initialize:function(a,b){this.options=b;this.containerElement=$(a);this.messageElement=this.containerElement.select(".live_validation_message")[0];this.delay=500;this.attachedElements=[];window.setInterval(function(){this._attachContainer()}.bind(this),this.delay)},_attachContainer:function(){var a=
false;this.containerElement.select("input, textarea, select").each(function(b){if(!b._internal)if(this._attachElement(b))a=true}.bind(this));this.attachedElements.clone().each(function(b){if(!this._mayAttachElement(b)){this.attachedElements=this.attachedElements.without(b);a=true}}.bind(this));a&&this._update()},_nodeInDocument:function(a){for(;a.parentNode!=null;)a=a.parentNode;return a==document},_mayAttachElement:function(a){return this._nodeInDocument(a)&&a.ancestors().all(function(b){return b.visible()})},
_attachElement:function(a){var b=false;if(!this.attachedElements.include(a)&&this._mayAttachElement(a)){this.attachedElements.push(a);if(this.options.validateOn=="blur")new FocusBasedFieldElementObserver(a,this._update.bind(this));else new DelayedFieldElementObserver(a,this.delay,this._update.bind(this));if(a.value)b=true}return b},_update:function(){if(this.request&&this.request.transport){try{this.request.transport.abort()}catch(a){}this.messageElement.removeClassName("spinner");this.messageElement.innerHTML=
"";this.messageElement.hide()}var b=Form.getForm(this.containerElement),c=function(){var d=$(document.createElement("a"));d.addClassName("small");d.appendChild(document.createTextNode(_("Pr\u00f8v igjen")));d.href="#";d.observe("click",function(e){this._update();e.stop()}.bind(this));this.messageElement.appendChild(document.createTextNode(" "));this.messageElement.appendChild(d)}.bind(this);this.request=new Ajax.Request(this.options.url,{parameters:Form.serialize(b)+"&"+this.options.parameters,evalScripts:false,
onLoading:function(){this.containerElement.removeClassName("live_validation_rejected");this.containerElement.removeClassName("live_validation_accepted");this.messageElement.addClassName("spinner");this.messageElement.innerHTML=this.options.progressLabel;this.messageElement.show();window.setTimeout(function(){this.messageElement.visible()&&this.messageElement.hasClassName("spinner")&&this.messageElement.select("a").length==0&&c()}.bind(this),3500)}.bind(this),onFailure:function(d){this.messageElement.removeClassName("spinner");
Errors.reportForAjax(d);c()}.bind(this),onSuccess:function(d){if(d=eval("("+d.responseText+")")){if(d.error){this.containerElement.addClassName("live_validation_rejected");this.containerElement.removeClassName("live_validation_accepted");this.messageElement.innerHTML=d.error}else if(d.reset)this.messageElement.innerHTML="";else{this.containerElement.removeClassName("live_validation_rejected");this.containerElement.addClassName("live_validation_accepted");this.messageElement.innerHTML=this.options.acceptLabel}if(this.messageElement.childNodes.length==
0)this.messageElement.innerHTML="&nbsp;"}}.bind(this),onComplete:function(){this.messageElement.removeClassName("spinner")}.bind(this),onException:function(d,e){this.messageElement.removeClassName("spinner");Errors.log(e);c()}.bind(this)})}}),DelayedFieldElementObserver=Class.create({initialize:function(a,b,c){this.element=$(a);this.delay=b;this.callback=c;this.oldValue=this.getValue();switch(this.element.type.toLowerCase()){case "checkbox":case "radio":this.element.observe("click",this.scheduleCallback.bind(this));
break;case "hidden":window.setInterval(this.changed.bind(this),this.delay);break;default:this.element.observe("keydown",this.scheduleCallback.bind(this));this.element.observe("change",this.changed.bind(this));window.setInterval(this.changed.bind(this),this.delay);break}},getValue:function(){switch(this.element.type.toLowerCase()){case "checkbox":case "radio":return this.element.checked;default:return this.element.value}},changed:function(){var a=this.getValue();if(this.element.type.toLowerCase()==
"radio"||a!=this.oldValue){this.oldValue=a;this.cancel();this.callback()}},scheduleCallback:function(){this.cancel();this.timeoutId=window.setTimeout(this.changed.bind(this),this.delay)},cancel:function(){if(this.timeoutId){window.clearTimeout(this.timeoutId);this.timeoutId=null}}}),FocusBasedFieldElementObserver=Class.create({initialize:function(a,b){this.element=$(a);this.callback=b;this.oldValue=this.getValue();this.element.observe("blur",this.changed.bind(this))},getValue:function(){switch(this.element.type.toLowerCase()){case "checkbox":case "radio":return this.element.checked;
default:return this.element.value}},changed:function(){if(this.getValue()!=this.oldValue){this.oldValue=this.getValue();this.callback()}}}),DynamicTextAreaResizing=Class.create({initialize:function(a,b){this.fieldElement=$(a);if(b){this.minHeight=b.minHeight;this.maxHeight=b.maxHeight}this.setup()},setup:function(){this.fieldElement.style.resize="none";this.fieldElement.observe("keyup",this.resizeToFit.bind(this));this.fieldElement.observe("focus",this.resizeToFit.bind(this));if(this.minHeight)this.resizeToFit();
else if(this.fieldElement.rows&&parseInt(this.fieldElement.rows)>0){this._measureHeightByRows(this.fieldElement.rows,function(b){this.minHeight=b;this.resizeToFit()}.bind(this));this.fieldElement.removeAttribute("rows")}else{var a=this.fieldElement.getDimensions().height;if(a>1)this.minHeight=a;else this._measureHeightByRows(3,function(b){this.minHeight=b;this.resizeToFit()}.bind(this))}},resizeToFit:function(){var a=document.body.scrollTop&&document.body.scrollTop>0?document.body:document.documentElement,
b;if(navigator.userAgent.match("AppleWebKit/[0-9]+")){b=a.scrollTop;this.fieldElement.style.height="0px"}var c=this.fieldElement.scrollHeight;if(this.maxHeight)c=Math.min(c,this.maxHeight);if(this.minHeight)c=Math.max(c,this.minHeight);this.fieldElement.style.overflow=this.fieldElement.scrollHeight>c?"auto":"hidden";this.fieldElement.style.height=c+"px";if(b)a.scrollTop=b;return true},_measureHeightByRows:function(a,b){var c=this._cloneStyles(this.fieldElement,$(document.createElement("div")));c.style.visibility=
"hidden";c.style.position="absolute";for(var d="",e=0;e<a;e++)d+="<br/>";c.innerHTML=d;this.fieldElement.parentNode.appendChild(c);this._measureDeferred(c,b,5)},_measureDeferred:function(a,b,c){window.setTimeout(function(){var d=a.getDimensions().height;if(d>0){a.parentNode.removeChild(a);b(d)}else this._measureDeferred(a,b,500)}.bind(this),c)},_cloneStyles:function(a,b){b.style.fontFamily=a.getStyle("font-family");b.style.fontSize=a.getStyle("font-size");b.style.lineHeight=a.getStyle("line-height");
b.style.paddingTop=a.getStyle("padding-top");b.style.paddingRight=a.getStyle("padding-right");b.style.paddingBottom=a.getStyle("padding-bottom");b.style.paddingLeft=a.getStyle("padding-left");b.style.borderTopWidth=a.getStyle("border-top-width");b.style.borderRightWidth=a.getStyle("border-right-width");b.style.borderBottomWidth=a.getStyle("border-bottom-width");b.style.borderLeftWidth=a.getStyle("border-left-width");b.style.borderTopColor=a.getStyle("border-top-color");b.style.borderRightColor=a.getStyle("border-right-color");
b.style.borderBottomColor=a.getStyle("border-bottom-color");b.style.borderLeftColor=a.getStyle("border-left-color");b.style.borderTopStyle=a.getStyle("border-top-style");b.style.borderRightStyle=a.getStyle("border-right-style");b.style.borderBottomStyle=a.getStyle("border-bottom-style");b.style.borderLeftStyle=a.getStyle("border-left-style");b.style.overflow=a.getStyle("overflow");b.style.resize="none";return b}}),TextAreaCharacterCounter=Class.create({initialize:function(a,b,c){this.fieldElement=
$(a);this.counterElement=$(b);this.maximumCharacters=c.maximumCharacters;this.errorClassName=c.errorClassName||"limit_exceeded";this.setup()},setup:function(){this.fieldElement.observe("keydown",this.update.bind(this));this.fieldElement.observe("keyup",this.update.bind(this));this.fieldElement.observe("change",this.update.bind(this));this.counterElement.style.cursor=this.fieldElement.getStyle("cursor");this.counterElement.observe("click",function(){this.fieldElement.focus()}.bind(this));this.update()},
update:function(){var a=this.maximumCharacters-this.fieldElement.value.length;a>0?this.counterElement.removeClassName(this.errorClassName):this.counterElement.addClassName(this.errorClassName);this.counterElement.innerHTML=a==0?_("N\u00e5 er det fullt!"):a>=0?_("%d tegn ledig",a):_("%d tegn for mange!",-a)}});
Object.extend(Form,{getForm:function(a){for(a=$(a);a;){if(a.nodeType==Node.ELEMENT_NODE&&a.tagName.toUpperCase()=="FORM")return a;a=a.parentNode}return null},getCaretPosition:function(a){if(a=$(a))if(document.selection){a.focus();document.selection.createRange().duplicate();return Math.abs(document.selection.createRange().moveStart("character",-a.value.length))}else return a.selectionStart>=0?(position=a.selectionStart):a.value.length},getSelection:function(a){if(a=$(a))if(document.selection){a.focus();
return document.selection.createRange().text}else return a.selectionStart>=0?a.value.substring(a.selectionStart,a.selectionEnd):null},insertIntoTextField:function(a,b,c){var d;if(a=$(a))if(b){c=c||{};var e=c.position;if(e===null||typeof e=="undefined")e=Form.getCaretPosition(a);if(c.deselectBefore)if(document.selection)document.selection.createRange();else typeof a.setSelectionRange!="undefined"&&a.setSelectionRange(0,0);else if(document.selection){d=document.selection.createRange();d.text="";d.moveStart("character",
0)}else if(typeof a.setSelectionRange!="undefined"){d=a.selectionStart;a.value=a.value.substring(0,a.selectionStart)+a.value.substring(a.selectionEnd,a.value.length);a.setSelectionRange(d,d)}d=0;var g=c.padding||"";if(e>0&&!a.value.substring(e-2).startsWith(g)){b=g+b;d+=g.length}if(e<a.value.length&&!a.value.substring(e).startsWith(g))b+=g;if(document.selection){a.focus();d=document.selection.createRange();d.text=b;d.moveStart("character",b.length)}else if(a.selectionStart>=0){a.value=a.value.substring(0,
e)+b+a.value.substring(e);if(typeof a.setSelectionRange!="undefined")if(c.selectAfter)a.setSelectionRange(e+d,e+b.length);else{e+=b.length;a.setSelectionRange(e,e)}}else a.value+=b;c.focusAfter&&a.focus();a.onchange&&a.onchange()}}});
Form.serializeRailsHash=function(a,b){var c=function(e,g){if(e){var n=g.match(/^([^\[]+)(\[.*)/);return n?e+"["+n[1]+"]"+n[2]:e+"["+g+"]"}else return g},d=[];a.each(function(e){var g=c(b,e[0]);e=e[1];Object.isArray(e)?e._each(function(n){d.push(encodeURIComponent(g)+"[]="+encodeURIComponent(n))}):d.push(encodeURIComponent(g)+"="+encodeURIComponent(e))}.bind(this));return d};
Form.parseRailsInputs=function(a,b){var c,d,e=new Hash,g=b?new RegExp("^"+b+"\\[(\\w+)\\](.*)"):/./;Form.getElements(a).each(function(n){if(!n.disabled&&n.type!="submit"&&n.name){c=n.name;if(d=$(n).getValue())if(n=c.match(g)){var l=n[2]||"";if(l.substring(l.length-2,l.length)=="[]")l=l.substring(0,l.length-2);c=n[1]+l;if(n=e.get(c)){if(!Object.isArray(n)){n=[n];e.set(c,n)}n.push(d)}else e.set(c,d)}}});return e};
var TagFields={toggle:function(a,b,c){a=$(a);var d=" "+a.value+" ",e=d.search(" "+b+" ");if(e>=0)a.value=(d.substring(0,e)+d.substring(e+b.length+1,d.length)).strip();else Form.insertIntoTextField(a,b,{position:a.value.length,padding:" ",deselectBefore:true,selectAfter:true});a.focus();$(c).toggleClassName("selected")}},FormModalityManager=Class.create();
FormModalityManager.prototype={initialize:function(a){this.form=$(a);this.enabled=false;this.warningMessage=this.previousUnloadHandler=null;$(document.body).observe("click",this._handleClick.bind(this))},begin:function(){if(!this.enabled){this.enabled=true;this.data=Form.serialize(this.form);this.form.select("input[type=submit], button").each(function(a){a.observe("click",function(){this.defer()}.bind(this))}.bind(this));this.previousBeforeUnloadHandler=window.onbeforeunload;window.onbeforeunload=
this._beforeUnloadHandler.bind(this)}},end:function(){if(this.enabled){this.enabled=false;this.data=null;if(window.onbeforeunload==this._beforeBeforeUnloadHandler){window.onbeforeunload=this.previousBeforeUnloadHandler;this.previousBeforeUnloadHandler=null}}},defer:function(){if(this.enabled){this.end();window.setTimeout(this.begin.bind(this),3E3)}},setWarningMessage:function(a){this.warningMessage=a},isFormModified:function(){return Form.serialize(this.form)!=this.data},_handleClick:function(a){if(this.enabled&&
a.target){a=$(a.target);if(a.descendantOf(this.form)&&(a.tagName.toLowerCase()=="button"||a.tagName.toLowerCase()=="input"&&(a.type||"").toLowerCase()=="submit"))this.defer()}},_beforeUnloadHandler:function(){if(this.previousUnloadHandler){var a=this.previousBeforeUnloadHandler.apply(this,arguments);if(a)return a}if(this.enabled&&this.isFormModified()){(a=this.warningMessage)||(a=_("Dersom du g\u00e5r videre vil du miste endringene dine."));return a}}};
var Button={create:function(a,b){var c=$(document.createElement("button"));this.configureElement(c,b);var d=$(document.createElement("span"));d.className="button_label";if(b=b.icon){var e=$(document.createElement("img"));e.src=Application.assetHost("/images/action_icons/"+b+".png");e.alt="";d.appendChild(e);a&&a!=""&&d.appendChild(document.createTextNode(" "))}a&&a!=""&&d.appendChild(document.createTextNode(a));c.appendChild(d);return c},linkTo:function(a,b,c){var d=$(document.createElement("a"));
d.href=b;this.configureElement(d,c);b=$(document.createElement("span"));b.className="button_label";b.appendChild(document.createTextNode(a));d.appendChild(b);return d},linkToFunction:function(a,b,c){var d;if(navigator.userAgent.match(/MSIE/)){d=$(document.createElement("a"));d.href="#";d.observe("click",function(e){b(e);Event.stop(e)});d.appendChild(document.createTextNode(a))}else{d=$(document.createElement("a"));d.href="#";d.observe("click",function(e){b(e);Event.stop(e)});this.configureElement(d,
c);c=$(document.createElement("span"));c.className="button_label";typeof a=="string"?c.appendChild(document.createTextNode(a)):c.appendChild(a);d.appendChild(c)}return d},configureElement:function(a,b){b=$H(b||{});var c=b.get("size")||"normal";b=b.get("color")||"grey";a.setAttribute("class","button "+c+"_button "+c+"_"+b+"_button "+b+"_button")}};
Button.disableTemporarily=function(a,b){a=$(a);b=b||{};if(!a.disabled){var c=a.select(".button_label")[0];window.setTimeout(function(){a._temporaryDisablingAttributes={label:c.innerHTML,disabled:a.disabled,width:a.style.width};c.innerHTML=b.progressTitle||_("Vent litt\u2026");if(a.getDimensions().width<a._temporaryDisablingAttributes.width)a.style.width=a.getDimensions().width+"px";a.disabled="disabled";a.addClassName("disabled")},10);window.setTimeout(function(){var d=a._temporaryDisablingAttributes;
if(d){a.removeClassName("disabled");a.disabled=d.disabled;a.style.width=d.width;c.innerHTML=d.label;a._temporaryDisablingAttributes=null}},b.timeout||15E3)}return true};var EditableText=Class.create();
EditableText.prototype={initialize:function(a){this.options=a;this.value=this.previousValue=this.options.value||"";this.content=this.options.content||this.value||"";this.editing=false;this.type=this.options.type||"field";this.hiddenField=this.progressIndicator=null;if(this.options.elementId)this.attach(this.options.elementId);else this.options.container&&this.attach(this.options.container)},attach:function(a){a=$(a);this.detach();this.element=a;this.element.addClassName("editable_text");Event.observe(a,
"click",function(b){this.edit();Event.stop(b)}.bind(this));Event.observe(a,"mouseover",function(){!this.deleted&&!this.isEditing()&&Element.addClassName(this.element,"editable_text_hover")}.bind(this));Event.observe(a,"mouseout",function(){!this.deleted&&!this.isEditing()&&Element.removeClassName(this.element,"editable_text_hover")}.bind(this));if(!this.options.url&&!this.hiddenField){a=$(document.createElement("input"));a.name=this.options.name;a.type="hidden";a.value=this.value;this.hiddenField=
a;this.element.parentNode.appendChild(this.hiddenField)}this.reset()},detach:function(){},edit:function(){if(!this.deleted)if(!this.isEditing()){for(var a=$(this.element),b=a.getDimensions().height;a.firstChild;)a.removeChild(a.firstChild);Element.removeClassName(a,"editable_text_placeholder");Element.removeClassName(a,"editable_text_hover");var c;if(this.options.url){c=$(document.createElement("form"));c.method="POST";c.action=this.options.url}var d=$(document.createElement("div"));d.className="editable_text_fields";
var e;if(this.type=="field"){e=$(document.createElement("input"));e.className="field";e.type="text";e.value=this.value}else{e=$(document.createElement("textarea"));e.className="field";e.cols=30;e.rows=4;e.style.height=(b<150?150:b)+"px";e.appendChild(document.createTextNode(this.value))}e.observe("keypress",function(n){if(Event.getKey(n)==Event.KEY_RETURN)if(this.type=="field"){Event.stop(n);this.value=e.value;this.save()}if(n.keyCode==27){this.cancel();Event.stop(n)}}.bind(this));d.appendChild(e);
b=document.createElement("div");b.className="button_bar button_bar_left";var g=Button.create(_("Lagre"),{color:"green",size:"small"});Event.observe(g,"click",function(n){this.value=e.value;this.save();Event.stop(n);return false}.bind(this));b.appendChild(g);g=Button.create(_("Avbryt"),{color:"grey",size:"small"});Event.observe(g,"click",function(n){this.cancel();Event.stop(n);return false}.bind(this));b.appendChild(g);if(this.options.deleteUrl){g=Button.create(_("Slett"),{color:"grey",size:"small"});
Event.observe(g,"click",function(n){window.confirm(_("Er du sikker?"))&&this.doDelete();Event.stop(n);return false}.bind(this));b.appendChild(g)}g=document.createElement("img");g.alt=_("Lagrer\u2026");g.src="/images/progress/spinner_16.gif";g.title="";g.className="progress_indicator";g.style.display="none";b.appendChild(g);this.progressIndicator=g;d.appendChild(b);if(c){c.appendChild(d);a.appendChild(c)}else a.appendChild(d);Field.focus(e);this.editing=true}},save:function(){if(!this.deleted)if(this.editing)if(this.options.url)if(this.value!=
this.previousValue){this.progressIndicator&&Element.show(this.progressIndicator);this.saving=true;var a=encodeURIComponent(this.options.name)+"="+encodeURIComponent(this.value);if(this.options.parameters){a+="&";a+=this.options.parameters}new Ajax.Request(this.options.url,{parameters:a,evalScripts:false,onFailure:function(b){Errors.reportForAjax(b)}.bind(this),onSuccess:function(b){this.previousValue=this.value;this.content=(b=b.responseText)?b.stripScripts():"";this.reset()}.bind(this),onComplete:function(){this.saving=
false;this.progressIndicator&&Element.hide(this.progressIndicator)}.bind(this),onException:function(b,c){this.saving=false;Errors.log(c)}.bind(this)})}else this.cancel();else{this.content=this.value;if(this.hiddenField)this.hiddenField.value=this.value;this.reset()}},cancel:function(){this.deleted||this.editing&&this.reset()},doDelete:function(){this.progressIndicator&&Element.show(this.progressIndicator);this.saving=true;new Ajax.Request(this.options.deleteUrl,{onFailure:function(a){Errors.reportForAjax(a)}.bind(this),
onSuccess:function(a){a=a.responseText;this.value="";this.deletedText=a?a.stripScripts():"";this.deleted=true;this.element.removeClassName("editable_text");this.reset()}.bind(this),onComplete:function(){this.saving=false;this.progressIndicator&&Element.hide(this.progressIndicator)}.bind(this),onException:function(a,b){this.saving=false;Errors.log(b)}.bind(this)})},reset:function(){var a=$(this.element);if(this.deleted){a.innerHTML=this.deletedText;Element.removeClassName(a,"editable_text_placeholder")}else if(this.value===
""){a.innerHTML=this.options.placeholderText||a.title;Element.addClassName(a,"editable_text_placeholder")}else{if(this.content)a.innerHTML=this.content;else a.appendChild(document.createTextNode(this.value));Element.removeClassName(a,"editable_text_placeholder")}this.progressIndicator=null;this.editing=false},isEditing:function(){return this.editing}};
var Tooltip=Class.create({initialize:function(a,b){if(this.element=$(a)){this.options=b||{};var c;if(this.options.content)c=this.options.content;else if(this.element.title){c=this.element.title;this.element.title=""}else if(this.element.attributes["data-tooltip"])c=this.element.attributes["data-tooltip"].value;if(c){this._verticalAlign=this.options.verticalAlign||this.element.getAttribute("data-tooltip-valign")||"top";this._horizontalAlign=this.options.horizontalAlign||this.element.getAttribute("data-tooltip-halign")||
"center";this.boxElement=$(document.createElement("div"));this.boxElement.addClassName("tooltip");this.options.style&&this.boxElement.addClassName("tooltip_"+this.options.style);this.boxElement.addClassName("tooltip_valign_"+this._verticalAlign);this.boxElement.addClassName("tooltip_halign_"+this._horizontalAlign);this.boxElement.style.position="absolute";this.boxElement.style.left="0px";this.boxElement.style.top="-20000px";this.boxElement.style.display="none";this.boxElement.observe("click",this.hide.bind(this));
a=$(document.createElement("div"));a.className="text";a.innerHTML=c;this.boxElement.appendChild(a);if(this.options.popup)this._mode="popup";else{c=this.element.tagName.toLowerCase();if(c=="textarea"||c=="input"||c=="select"){this.element.observe("focus",this.show.bind(this));this.element.observe("blur",this.hide.bind(this));this._mode="focus"}else this._mode="hover"}this._sticky=this.boxElement.select("a").length>0;this.visible=false;this._enabled=true;if(this._mode=="hover"&&!this._sticky){this.element.observe("mouseenter",
this.show.bind(this));$(document.body).observe("mousemove",this._mouseMove.bind(this))}this._mode=="popup"&&this.show()}}},show:function(){if(!this.visible&&this._enabled){this.boxElement.style.width=Math.min(Math.max(this.element.getDimensions().width,250),400)+"px";Application.overlayElement(function(a){a.appendChild(this.boxElement)}.bind(this));this.boxElement.show();this.visible=true;window.setTimeout(function(){this.boxElement.style.left=this._horizontalAlign=="left"?this.element.cumulativeOffset().left+
"px":this.element.cumulativeOffset().left+this.element.getDimensions().width/2-this.boxElement.getDimensions().width/2+"px";this.boxElement.style.top=this._verticalAlign=="bottom"?this.element.cumulativeOffset().top+this.element.getDimensions().height+1+"px":this.element.cumulativeOffset().top-this.boxElement.getDimensions().height-1+"px"}.bind(this),10)}},hide:function(){if(this.visible){this.visible=false;this.boxElement.hide();document.body.stopObserving("mousemove",this._mouseMove.bind(this));
this.element.stopObserving("keypress",this.hide.bind(this))}},enable:function(){this._enabled=true},disable:function(){this._enabled=false;this.hide()},_mouseMove:function(a){a=Event.element(a);if(this._mode=="hover")a==this.element||Element.childOf(a,this.element)||a==this.boxElement||Element.childOf(a,this.boxElement)||this.hide();else if(!(a==this.element||Element.childOf(a,this.element))||a==this.boxElement||Element.childOf(a,this.boxElement))this.hide()}});Tooltip.setupDocument=function(){Application.onDocumentReady(function(){$$("*[data-tooltip]").each(function(a){new Tooltip(a)})})};
var Lightbox=Class.create();
Lightbox.prototype={initialize:function(a,b){this._contentElement=$(a);this._flashObjects=[];this.options=b||{};if(this.options.closeOnEscapeKey)this.keyObserver=function(c){c.charCode==0&&this.hide()}.bind(this)},prepare:function(){var a=this._showBackground();this._createProgress().show();a&&this._start()},show:function(){this._showBackground();if(!(this._containerElement&&this._containerElement.visible())){if(this._progressElement){this._progressElement.remove();this._progressElement=null}this.options.onBeforeShow&&
this.options.onBeforeShow();this._contentElement.parentNode&&this._contentElement.parentNode.removeChild(this._contentElement);var a=this._createContainer();if(this._contentElement.parentNode!=a){a.appendChild(this._contentElement);if(this.content){this._contentElement.innerHTML=this.content;this.content=null}this._contentElement.show()}a.style.left="-50000px";a.style.top="-50000px";a.show();var b=$(document.createElement("input"));b.type="text";b.style.position="absolute";b.style.visibility="hidden";
b.style.top=(document.documentElement.scrollTop||document.body.scrollTop)+"px";a.appendChild(b);this._hideFlashObjects();window.setTimeout(function(){this.reposition();b.focus();b.remove();this.options.onShow&&this.options.onShow();this._containerElement.show()}.bind(this),10)}},hide:function(){if(!(this.options.onMayHide&&!this.options.onMayHide())){this.options.onHide&&this.options.onHide();this._stop();this.backgroundElement&&new Effect.Fade(this.backgroundElement,{duration:0.3,afterFinish:function(){this.backgroundElement&&
this.backgroundElement.remove();this.backgroundElement=null}.bind(this)});if(this._progressElement){this._progressElement.remove();this._progressElement=null}this._containerElement&&this._containerElement.hide();this._showFlashObjects()}},reposition:function(){var a=this._containerElement;if(a){var b=20;if(a.clientHeight<Window.getDimensions().height)b=Math.max(Window.getDimensions().height/2-a.clientHeight/2,b);a.style.left=Math.max(Window.getDimensions().width/2-a.clientWidth/2,0)+"px";a.style.top=
this.options.fixed?b+"px":b+(document.documentElement.scrollTop||document.body.scrollTop)+"px"}},_createContainer:function(){if(!this._containerElement){var a=$(document.createElement("div"));a.addClassName("lightbox");this.options.borderless&&a.addClassName("lightbox_borderless");a.style.zIndex=50001;a.style.display="none";a.style.position=this.options.fixed?"fixed":"absolute";if(!this.options.noClickToClose){a.title=_("Klikk for \u00e5 lukke");a.onclick=function(){this.hide()}.bind(this)}Application.overlayElement().appendChild(a);
if(this.options.closeIcon){var b=document.createElement("img");b.src=Application.assetHost("/images/modal_close_24.png");b.style.position="absolute";b.style.top="-10px";b.style.right="-10px";b.style.zIndex=50002;b.alt=_("Lukk");b.onmouseover=function(){this.src=Application.assetHost("/images/modal_close_hover_24.png")};b.onmouseout=function(){this.src=Application.assetHost("/images/modal_close_24.png")};b.onclick=function(){this.hide()}.bind(this);a.appendChild(b)}this._containerElement=a}return this._containerElement},
_createProgress:function(){if(!this._progressElement){this._progressElement=$(document.createElement("div"));this._progressElement.addClassName("lightbox_progress");this._progressElement.style.position="absolute";this._progressElement.style.left="-10000px";Application.overlayElement().appendChild(this._progressElement);this._progressElement.style.position="fixed";this._progressElement.style.left=Math.max(Window.getDimensions().width/2-this._progressElement.clientWidth/2,0)+"px";this._progressElement.style.top=
Math.max(Window.getDimensions().height/2-this._progressElement.clientHeight/2,0)+(document.documentElement.scrollTop||document.body.scrollTop)+"px"}return this._progressElement},_createBackground:function(){if(!this.backgroundElement){var a=$(document.createElement("div"));a.style.position="fixed";a.style.top=0;a.style.left=0;a.style.width="100%";a.style.height="100%";a.style.background=this.options.background||"#000";a.style.zIndex=5E4;a.style.display="none";a.observe("click",this.hide.bind(this));
a.observe("mousemove",function(b){b.stop()});document.body.appendChild(a);this.backgroundElement=a}return this.backgroundElement},_showBackground:function(){var a=this._createBackground();if(!a.visible()){new Effect.Appear(a,{duration:0.3,to:this.options.opacity||0.7});this._start();return true}},_start:function(){this.keyObserver&&Event.observe(window,"keypress",this.keyObserver,true);navigator.userAgent.match(/MSIE [0-7]/)&&Event.observe(window,"scroll",this.reposition.bind(this));Event.observe(window,
"resize",this.reposition.bind(this));this._contentElement.observe("DOMSubtreeModified",this.reposition.bind(this))},_stop:function(){this.keyObserver&&Event.stopObserving(window,"keypress",this.keyObserver);navigator.userAgent.match(/MSIE [0-7]/)&&Event.observe(window,"scroll",this.reposition.bind(this));Event.stopObserving(window,"resize",this.reposition.bind(this));Event.stopObserving(this._contentElement,"DOMSubtreeModified",this.reposition.bind(this))},_hideFlashObjects:function(){$$("object, embed").each(function(a){if(!a.descendantOf(this._contentElement)){a.style.visibility=
"hidden";this._flashObjects.push(a)}}.bind(this))},_showFlashObjects:function(){for(;this._flashObjects.length>0;)this._flashObjects.pop().style.visibility=""}};
var Modal=Lightbox,ImageStripPager=Class.create({initialize:function(a,b,c){this.url=a;this.container=$(b);this.pager=new BufferedHorizontalPager($(this.container).select(".image_strip_scrollable")[0],{cellWidth:72,visibleCount:3,bufferCount:3,scrollCount:3,initialCells:c.initialCells,onChanged:function(){var d=this.container.select(".image_strip_arrow_left")[0];this.pager.canMovePrevious()?d.removeClassName("disabled"):d.addClassName("disabled");d=this.container.select(".image_strip_arrow_right")[0];
this.pager.canMoveNext()?d.removeClassName("disabled"):d.addClassName("disabled")}.bind(this),onPopulate:function(d,e,g,n){new Ajax.Request(this.url,{parameters:"id="+d+"&context="+(g==-1?"after":"before")+"&count="+e,method:"GET",onLoading:function(){this.container.select(".image_strip_progress")[0].show()}.bind(this),onSuccess:function(l,m){if(m=m||this.evaluateJson(l)){var r=[];m.images.each(function(B){r[r.length]={content:B.html,identifier:B.id}});n(r,m.first,m.last)}}.bind(this),onComplete:function(){this.container.select(".image_strip_progress")[0].hide()}.bind(this),
onException:function(l,m){Errors.log(m)}.bind(this)})}.bind(this)});this.container.select(".image_strip_arrow_left")[0].observe("click",function(){this.pager.movePrevious()}.bind(this));this.container.select(".image_strip_arrow_right")[0].observe("click",function(){this.pager.moveNext()}.bind(this))},evaluateJson:function(a){var b=null;if((a=a.responseText)&&a.toString().strip().length>0)b=eval("("+a+")");return b}}),BufferedHorizontalPager=Class.create({initialize:function(a,b){this.scrollableElement=
$(a);this.options=b||{};this.options.scrollSpeed=this.options.scrollSpeed||0.3;this.visibleCount=this.options.visibleCount||3;this.scrollCount=this.options.scrollCount||this.visibleCount;this.bufferCount=this.options.bufferCount||this.visibleCount*2;this.cellWidth=this.options.cellWidth||72;this.containerElement=$(document.createElement("div"));this.containerElement.style.overflow="hidden";this.containerElement.style.whiteSpace="nowrap";this.containerElement.style.height="100%";this.scrolling=false;
this.scrollIndex=0;this.cellElements=[];this.cellFilled=[];this.cellIdentifiers=[];this.lastId=this.firstId=null;this.stateCount=0;this.options.initialCells.each(function(c,d){var e=this._createCell();e.innerHTML=c.content;this.cellElements[d]=e;this.cellIdentifiers[d]=c.identifier;this.cellFilled[d]=true;if(c.first)this.firstId=c.identifier;if(c.last)this.lastId=c.identifier;this.containerElement.appendChild(e)}.bind(this));this._clearElement(this.scrollableElement);this._updateSize();this.scrollableElement.appendChild(this.containerElement);
this.scrollableElement.scrollLeft=0;window.setTimeout(function(){this.options.onChanged&&this.options.onChanged()}.bind(this),1)},canMovePrevious:function(){return this.firstId?this.cellIdentifiers.indexOf(this.firstId)<this.scrollIndex:true},canMoveNext:function(){return this.lastId?this.cellIdentifiers.indexOf(this.lastId)>this.scrollIndex+this.visibleCount:true},movePrevious:function(a){if(this.canMovePrevious()){a=a||this.scrollCount;var b=this.scrollIndex-a;if(b<0){this._prependCells(-b);b=0}for(var c=
b;c<b+a;){if(this.cellFilled[c])break;c++}if(c>b){var d=++this.stateCount;this.options.onPopulate(this.cellIdentifiers[c],c-b,-1,function(e,g,n){if(this.stateCount==d&&e.length>0){b=c-e.length;for(var l=0;l<e.length;l++){var m=b+l;this.cellElements[m].innerHTML=e[l].content;this.cellIdentifiers[m]=e[l].identifier;this.cellFilled[m]=true}if(g)this.firstId=e[0].identifier;if(n)this.lastId=e[e.length-1].identifier;this._scrollToIndex(b)}}.bind(this))}else this._scrollToIndex(b)}},moveNext:function(a){if(this.canMoveNext()){a=
a||this.scrollCount;var b=this.scrollIndex+this.visibleCount+a;if(b>=this.cellElements.length){this._appendCells(b-this.cellElements.length);b=this.scrollIndex+this.visibleCount+a}for(var c=b;c>this.scrollIndex;){if(this.cellFilled[c])break;c--}c+=1;if(b>c){var d=++this.stateCount;this.options.onPopulate(this.cellIdentifiers[c-1],b-c,1,function(e,g,n){if(this.stateCount==d&&e.length>0){for(var l=0;l<e.length;l++){var m=c+l;this.cellElements[m].innerHTML=e[l].content;this.cellIdentifiers[m]=e[l].identifier;
this.cellFilled[m]=true}if(g)this.firstId=e[0].identifier;if(n)this.lastId=e[e.length-1].identifier;this._scrollToIndex(b-e.length)}}.bind(this))}else this._scrollToIndex(b-a)}},_prependCells:function(a){if(a>0){for(var b=0;b<a;b++){var c=this._createCell();this.cellElements.unshift(c);this.cellIdentifiers.unshift(null);this.cellFilled.unshift(false);this.containerElement.insertBefore(c,this.containerElement.firstChild)}this._updateSize();this._scrollToIndex(this.scrollIndex+a,true)}},_appendCells:function(a){if(a>
0){for(var b=0;b<a;b++){var c=this._createCell();this.cellElements.push(c);this.cellIdentifiers.push(null);this.cellFilled.push(false);this.containerElement.appendChild(c)}this._updateSize()}},_clearElement:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)},_scrollToIndex:function(a,b){if(!this.scrolling){this.scrollIndex=a;a=this.scrollIndex*this.cellWidth;if(b)this.scrollableElement.scrollLeft=a;else{this.scrolling=true;new Effect.ScrollElementTo(this.scrollableElement,{toX:a,duration:this.options.scrollSpeed,
transition:Effect.Transitions.sinoidal,queue:"end",afterFinish:function(){this.scrolling=false}.bind(this)})}}},_createCell:function(){var a=$(document.createElement("div"));a.style.width=this.cellWidth+"px";a.style.height="100%";a.style.styleFloat="left";a.style.cssFloat="left";a.style.overflow="hidden";a.style.whiteSpace="nowrap";return a},_updateSize:function(){this.containerElement.style.width=this.cellElements.length*this.cellWidth+"px"}}),SimpleHorizontalPager=Class.create({initialize:function(a,
b){this.scrollableElement=$(a);this.scrollableElement.scrollLeft=0;this.scrollableElement.style.overflow="hidden";this.scrollableElement.style.position="relative";this.options=b||{};this.scrollSpeed=this.scrollSpeed||0.3;this.scrolling=false;this.scrollIndex=this.options.initialIndex||0;this._nodes=$A();Application.onDocumentReady(function(){this._updateNodes();window.setInterval(this._updateNodes.bind(this),500)}.bind(this))},getScrollIndex:function(){return this.scrollIndex},canMovePrevious:function(){return this.scrollIndex>
0},canMoveNext:function(){return this.scrollIndex<this._itemCount-1},movePrevious:function(a){if(a==null)a=1;this.canMovePrevious()&&this.moveTo(Math.max(0,this.scrollIndex-a))},moveNext:function(a){if(a==null)a=1;this.canMoveNext()&&this.moveTo(Math.min(this.scrollIndex+a,this._itemCount))},moveTo:function(a,b){var c=this.options.smoothScroll;if(typeof b=="boolean")c=!b;if(!this.scrolling&&a!=this.scrollIndex){var d=this._nodes[this.scrollIndex];this.scrollIndex=a;if(a=this._nodes[this.scrollIndex]){this.options.onChanged&&
this.options.onChanged();b=this.scrollIndex*this._scrollableWidth;if(!isNaN(b)){a.style.visibility="";if(c){this.scrolling=true;new Effect.Parallel([new Effect.Opacity(d,{to:0,duration:this.scrollSpeed*0.5}),new Effect.Opacity(a,{to:1,duration:this.scrollSpeed/2}),new Effect.ScrollElementTo(this.scrollableElement,{toX:b,duration:this.scrollSpeed,transition:Effect.Transitions.sinoidal})],{duration:this.scrollSpeed,queue:"end",afterFinish:function(){d.style.visibility="hidden";this.scrolling=false}.bind(this)})}else{this.scrollableElement.scrollLeft=
b;if(d)d.style.visibility="hidden"}}}}},_changed:function(){this.options.onChanged&&this.options.onChanged()},_updateNodes:function(){for(var a=-1,b=0;b<this.scrollableElement.childNodes.length;b++){var c=$(this.scrollableElement.childNodes[b]);if(c&&c.nodeType==Node.ELEMENT_NODE&&c.visible()){c=c.getDimensions().height;a=Math.max(a,c)}}if(a!=this._currentHeight&&a>0){this._currentHeight=a;this.scrollableElement.style.height=a+"px"}b=this.scrollableElement.getDimensions().width;if(b!=this._scrollableWidth&&
b>0)this._scrollableWidth=b;if((a=this.options.cellWidth||this._scrollableWidth)&&a>0){this._itemCount=0;this._nodes=$A();for(b=0;b<this.scrollableElement.childNodes.length;b++)if((c=$(this.scrollableElement.childNodes[b]))&&c.nodeType==Node.ELEMENT_NODE&&c.visible()){c.style.position="absolute";c.style.visibility=this._itemCount==this.scrollIndex?"visible":"hidden";c.style.width=a+"px";c.style.left=this._itemCount*a+"px";c.style.top="0px";this._nodes[this._itemCount++]=c}this.containerWidth=this._itemCount*
a;this.scrollableElement.scrollLeft=this.scrollIndex*this._scrollableWidth;this.options.onChanged&&this.options.onChanged()}}}),SimpleSlideshow=Class.create();
SimpleSlideshow.prototype={initialize:function(a,b,c,d,e,g,n,l){this.containerElement=$(a);this.images=a.select("img");this.imageWidth=b;this.counterElement=e;this.count=this.images.length;this.captionElement=n;this.captions=l;this.titleElement=g;this.containerElement.observe("click",function(){this.hideTitle()}.bind(this));this.titleElement.observe("click",function(){this.hideTitle()}.bind(this));this.counterElement.hide();this.targetIndex=0;this.arrowLeftElement=$(c);this.arrowLeftElement.observe("click",
function(m){this.jumpToPrevious();m.stopPropagation()}.bind(this));this.arrowRightElement=$(d);this.arrowRightElement.observe("click",function(m){this.jumpToNext();m.stopPropagation()}.bind(this));this.counterEffect=null;this.jumpTo(0)},hideTitle:function(){this.titleElement.hide()},jumpTo:function(a){if(a>=0&&a<this.count){a>0&&this.hideTitle();this.targetIndex=a;this.targetIndex==0?this.arrowLeftElement.hide():this.arrowLeftElement.show();this.targetIndex==this.count-1?this.arrowRightElement.hide():
this.arrowRightElement.show();this.captionElement.innerHTML=(this.captions[this.targetIndex]||"")+"&nbsp;";this.counterElement.innerHTML=this.targetIndex+1+" / "+this.count;this.counterElement.show();new Effect.ScrollElementTo(this.containerElement,{toX:this.targetIndex*this.imageWidth,duration:0.3,transition:Effect.Transitions.sinoidal,afterFinish:this.finishedScrolling.bind(this)})}},jumpToNext:function(){this.jumpTo(this.targetIndex+1)},jumpToPrevious:function(){this.jumpTo(this.targetIndex-1)},
finishedScrolling:function(){this.counterTimeout&&window.clearTimeout(this.counterTimeout);this.counterTimeout=window.setTimeout(function(){this.counterElement.hide()}.bind(this),500)}};var spring_site="test",_cy_="undefined";
if(!this.spring)var spring=function(){function a(){if("https"==document.location.href.slice(0,5))return"https://ssl-";return"http://"}function b(y,h){if(!h){h=y;y={r:document.referrer};D=h}var j=h.s?h.s:y.s;j||(j=h.site?h.site:y.site?y.site:m);F[j]||(F[j]=[]);F[j].push([y,h]);J=1;return this}function c(y){J||b({});var h;for(s in F)for(var j=F[s];j.length>0;){h=",";for(var f=[];j.length>0;){h+=e(g(j.shift(),f),f);if(h.length>B)break;if(j.length>0)h+="+"}h=d(h+";",s,y)}F={};return h}function d(y,h,
j){y=a()+(h?h:m)+"."+r+"/j0="+y;h=y+"?lt="+(new Date).getTime().toString(36)+"&x="+screen.width+"x"+screen.height+"x"+screen.colorDepth;if(j)j==1&&document.write('<img src="'+h+'"" width="1" height=""1">');else(new Image).src=h;z&&alert(h);return y}function e(y,h){for(i in h)if(h[i]==y)return"~"+i;h.push(y);return y}function g(y,h){var j,f,k;j=/[+&,;=~]/g;h||(h=[]);switch(typeof y){case "string":return j.test(y)?escape(y).replace(j,function(p){var o=E[p];if(o)return o;return p}):escape(y);case "number":return isFinite(y)?
String(y):"null";case "boolean":case "null":return String(y);case "object":if(!y)return"null";j=[];if(typeof y.length==="number"&&!y.propertyIsEnumerable("length")){k=y.length;for(f=0;f<k;f+=1)j.push(e(g(y[f],h),h)||"null");return","+j.join("+")+";"}for(f in y)if(typeof f==="string")if(f!="site")(k=g(y[f],h))&&j.push(e(g(f,h)+"="+k,h));return","+j.join("+")+";"}return""}function n(y,h,j){b(y,h);return c(j)}var l=_cy_,m=spring_site,r="tns-cs.net",B=typeof spring_ms!=l?spring_ms:2048,z=typeof spring_debug!=
l?spring_debug:null,E={"+":"%2B",",":"%2C",";":"%3B","=":"%3D","~":"%7E"},F={},J=null,D={};return{a:b,add:b,c:n,commit:n}}();
var Tab=Class.create({initialize:function(a,b,c){this.id=a;this.itemElement=$(b);this.panelElement=$(c)},setActive:function(a){if(a){this.panelElement.show();this.itemElement.addClassName("active")}else this.itemElement.removeClassName("active")}}),TabViewController=Class.create({initialize:function(a,b){this.options=b||{};this.element=$(a);this.tabs=[];this.currentTab=null;this.pager=new SimpleHorizontalPager(this.element.select(".tab_view_panels")[0],{smoothScroll:false});this._started=false;Application.onDocumentReady(this._start.bind(this))},
registerTab:function(a,b,c){a=new Tab(a,b,c);this.tabs.push(a);this.currentTab||this.goToTab(a);return a},currentTab:function(){return this.currentTab},goToTab:function(a){if(this.currentTab){this.currentTab.setActive(false);this.currentTab=null}(this.currentTab=a instanceof Tab?a:this.tabs.find(function(b){return b.id==a}))&&this._started&&this._moveToCurrent();this._changed()},_moveToCurrent:function(){if(this.currentTab){this.pager.moveTo(this.tabs.indexOf(this.currentTab));this.currentTab.setActive(true)}},
_start:function(){this._goToTabFromDocumentLocation();this._moveToCurrent();this._markErrors();this._started=true;this._changed()},_goToTabFromDocumentLocation:function(){if(this.options.useLocationAnchor){if(!this._anchorInputElement){var a=Form.getForm(this.element);if(a){this._anchorInputElement=$(document.createElement("input"));this._anchorInputElement.type="hidden";this._anchorInputElement.name="anchor";a.appendChild(this._anchorInputElement)}}(a=window.location.toString().match(/^(.*)#([^#]+)$/))&&
a[2]&&this.goToTab(a[2])}},_changed:function(){if(this._started&&this.options.useLocationAnchor){var a=window.location.toString().match(/^(.*)#([^#]+)$/);if(a&&a[1]){if(a[2]!=this.currentTab.id)newLocation=a[1]+"#"+this.currentTab.id}else newLocation=window.location.toString().gsub(/#+$/,"")+"#"+this.currentTab.id;if(newLocation)window.location=newLocation}if(this._anchorInputElement)this._anchorInputElement.value=this.currentTab?this.currentTab.id:null;typeof GoogleMapsSupport!="undefined"&&GoogleMapsSupport.checkAllResize()},
_markErrors:function(){this.tabs._each(function(a){Element.getElementsBySelector(a.panelElement,".field_with_errors, .field_error").length>0&&a.itemElement.addClassName("tab_with_errors")}.bind(this))}}),TabView=Class.create({initialize:function(a){this.options=a||{};this._element=$(document.createElement("div"));this._element.addClassName("tab_view");this._barElement=$(document.createElement("div"));this._barElement.addClassName("tab_view_tab_bar");this._itemsElement=$(document.createElement("ol"));
this._itemsElement.addClassName("tab_view_tabs");this._barElement.appendChild(this._itemsElement);this._element.appendChild(this._barElement);this._panelsElement=$(document.createElement("div"));this._panelsElement.addClassName("tab_view_panels");this._element.appendChild(this._panelsElement);this.controller=new TabViewController(this._element,{useLocationAnchor:this.options.useLocationAnchor})},addTab:function(a,b,c){c.parentNode&&c.parentNode.removeChild(c);var d=$(document.createElement("div"));
d.addClassName("tab_view_panel_content");d.appendChild(c);c=$(document.createElement("div"));c.style.visibility="hidden";c.addClassName("tab_view_panel");c.appendChild(d);this._panelsElement.appendChild(c);d=$(document.createElement("li"));var e=$(document.createElement("a"));e.href="#";e.appendChild(document.createTextNode(b));e.observe("click",function(g){g.stop();this.controller.goToTab(a)}.bind(this));d.appendChild(e);this._itemsElement.appendChild(d);this.controller.registerTab(a,d,c)},insertInto:function(a){this._parentElement&&
this._parentElement.removeChild(this._element);this._parentElement=a;this._parentElement.appendChild(this._element)}}),TimePicker=Class.create();
TimePicker.prototype={initialize:function(a,b){this.value=a;this.options=b;this.balloon=null},create:function(){var a=$(document.createElement("div")),b=$(document.createElement("span"));b.className="time";b.observe("click",function(g){this.selected(null);Event.stop(g)}.bind(this));b.appendChild(document.createTextNode(_("Ingen")));a.appendChild(b);for(var c=0;c<=23;c++)for(var d=0;d<60;d+=30){var e=this.formatTime(c,d);b=$(document.createElement("span"));b.className="time";b.time=e;b.observe("click",
function(g){this.selected(Event.element(g).time);Event.stop(g)}.bind(this));b.appendChild(document.createTextNode(e));a.appendChild(b)}return a},selected:function(a){this.value=a;this.options.onSelect&&this.options.onSelect(a);this.balloon&&this.balloon.close()},formatTime:function(a,b){return this.zeroPad(a,2)+":"+this.zeroPad(b,2)},zeroPad:function(a,b){for(a=a.toString();a.length<b;)a="0"+a;return a},setBalloon:function(a){this.balloon=a}};
TimePicker.attachBalloon=function(a,b){b=$(b);var c=document.createElement("img");c.className="time_picker_arrow";c.src="/images/forms/time_picker_button_24.png";c.alt="...";b.parentNode.insertBefore(c,b.nextSibling);var d=new Balloon({content:a.create(),className:"time_picker_balloon",closeable:false,position:new Balloon.Position.Vertical(0,-2),origin:b,tail:null,onMayShow:function(){return!b.disabled}});d.attach(c);a.setBalloon(d);return a};
function link_share(a,b,c){var d;switch(c){case "facebook":d=window.open("http://www.facebook.com/sharer.php?u="+encodeURIComponent(b)+"&t="+encodeURIComponent(a),c,"location=no,status=no,scrollbars=yes,resizable=yes,directories=no,toolbar=no,menubar=no,width=649,height=480");break;case "twitter":d=window.open("http://www.twitter.com/share?u="+encodeURIComponent(b)+"&title="+encodeURIComponent(a),c,"location=no,status=no,scrollbars=yes,resizable=yes,directories=no,toolbar=no,menubar=no,width=649,height=480");
break;case "google":d=window.open("http://www.google.com/bookmarks/mark?op=edit&bkmk="+encodeURIComponent(b)+"&title="+encodeURIComponent(a),c,"location=no,status=no,scrollbars=yes,resizable=yes,directories=no,toolbar=no,menubar=no,width=649,height=480");break}d.focus();return false}var DHTMLGoodies={};if(!String.trim)String.prototype.trim=function(){return this.replace(/^\s+|\s+$/,"")};
DHTMLGoodies.ChessFen=function(a){this.pieceType="cases";this.squareSize=45;this.isOldMSIE=navigator.userAgent.toLowerCase().match(/msie\s[0-6]/gi)?true:false;this.isOpera=navigator.userAgent.toLowerCase().indexOf("opera")>=0?true:false;this.parentRef=document.body;this.imageFolder="images/";this.flipBoardWhenBlackToMove=this.boardLabels=true;a&&this.__setInitProps(a);this.init()};
DHTMLGoodies.ChessFen.prototype={__setInitProps:function(a){if(a.imageFolder)this.imageFolder=a.imageFolder;if(a.squareSize)this.squareSize=a.squareSize;if(a.boardLabels||a.boardLabels===false)this.boardLabels=a.boardLabels;if(a.flipBoardWhenBlackToMove||a.flipBoardWhenBlackToMove===false)this.flipBoardWhenBlackToMove=a.flipBoardWhenBlackToMove;if(a.pieceType)this.pieceType=a.pieceType},setSquareSize:function(a){this.squareSize=a},setPieceType:function(a){this.pieceType=a},init:function(){},setFlipBoardWhenBlackToMove:function(a){this.flipBoardWhenBlackToMove=
a},getWhoToMove:function(){return this.whoToMove},setBoardLabels:function(a){this.boardLabels=a},__setWhoToMove:function(a){this.whoToMove=a.split(/\s/g)[1].trim()},loadFen:function(a,b){this.__setWhoToMove(a);b=this.__getEl(b);b.innerHTML="";var c=document.createElement("DIV");c.className="ChessBoard"+this.squareSize;c.style.position="relative";var d=document.createElement("DIV");d.className="ChessBoardInner"+this.squareSize;if(this.boardLabels){this.__addBoardLabels(c);c.appendChild(d);d.style.position=
"absolute";d.style.top="0px";d.style.right="0px";b.appendChild(c)}else{d.style.position="relative";b.appendChild(d)}this.__loadFen(a,d)},__addBoardLabels:function(a){for(var b=1;b<=8;b++){var c=document.createElement("DIV");c.style.position="absolute";c.style.right=(8-b)*this.squareSize+"px";c.style.bottom="0px";c.innerHTML="ABCDEFGH".substr(b-1,1);c.style.textAlign="center";c.style.width=this.squareSize+"px";a.appendChild(c);c.className="ChessBoardLabel ChessBoardLabel"+this.squareSize;var d=document.createElement("DIV");
d.style.position="absolute";d.style.left="0px";d.style.top=(8-b)*this.squareSize+"px";d.innerHTML=b;d.style.height=this.squareSize+"px";d.style.lineHeight=this.squareSize+"px";a.appendChild(d);d.className="ChessBoardLabel ChessBoardLabel"+this.squareSize;if(this.whoToMove=="b"&&this.flipBoardWhenBlackToMove){d.innerHTML=9-b;c.innerHTML="ABCDEFGH".substr(8-b,1)}}},__loadFen:function(a,b){a=a.split(/\s/g)[0];for(var c=0,d=0;d<a.length;d++){var e=a.substr(d,1);if(e.match(/[A-Z]/i)){var g=this.__getBoardPosByCol(c),
n=document.createElement("DIV");n.style.position="absolute";n.style.left=g.x+"px";n.style.top=g.y+"px";if(e.match(/[A-Z]/))var l="w";if(e.match(/[a-z]/))l="b";g=document.createElement("IMG");g.src=this.imageFolder+this.pieceType+this.squareSize+l+e.toLowerCase()+".png";self.status=this.imageFolder+this.pieceType+this.squareSize+l+e.toLowerCase()+".png";n.appendChild(g);n.className="ChessPiece"+this.squareSize;b.appendChild(n);c++;this.isOldMSIE&&!this.isOpera&&this.correctPng(g)}if(e.match(/[0-8]/))c+=
e/1}},__getBoardPosByCol:function(a){for(var b=0;a>=8;){b++;a-=8}var c={};if(this.whoToMove=="b"&&this.flipBoardWhenBlackToMove){a=7-a;b=7-b}c.x=a*this.squareSize;c.y=b*this.squareSize;return c},__getEl:function(a){if(typeof a=="string"){if(document.getElementById(a))return document.getElementById(a);if(document.forms[a])return document.forms[a];if(document[a])return document[a];if(window[a])return window[a]}return a},correctPng:function(a){a=a=this.__getEl(a);a.outerHTML="<span style=\"position:absolute;display:inline-block;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+
a.src+"',sizingMethod='scale');width:"+a.width+";height:"+a.height+'"></span>'}};var ObjectFinder=Class.create();
ObjectFinder.prototype={initialize:function(a,b){this.searchField=$(a);this.searchField.observe("blur",this.scheduleSearch.bind(this));this.options=b||{};this.request=null;this.lastQuery="";this.scheduled=null},scheduleSearch:function(){var a=this.searchField.value.strip();if(a!=this.lastQuery&&(!this.selectedHit||this.selectedHit.title!=a)){this.cancelSearch();this.unselect();if(this.scheduled){window.clearTimeout(this.scheduled);this.scheduled=null}if(a.length>0)this.scheduled=window.setTimeout(function(){this.search(a)}.bind(this),
this.options.delay||1E3);else this.depopulate()}},cancelSearch:function(){if(this.request){this.lastQuery=null;this.setRequest(null)}},searchNow:function(){var a=this.searchField.value.strip();a!=""&&this.search(a)},search:function(a){this.lastQuery=a;var b=$(this.searchField.id+"_progress_indicator");this.setRequest(new Ajax.Request(this.options.url,{method:"get",asynchronous:true,evalScripts:true,parameters:encodeURIComponent(this.options.parameter)+"="+a,onLoading:function(){b&&b.show()}.bind(this),
onFailure:function(c){Errors.reportForAjax(c)}.bind(this),onSuccess:function(c,d){c=d||this.evaluateJson(c);this.populate(a,c)}.bind(this),onComplete:function(){b&&b.hide()}.bind(this),onException:function(c,d){Errors.log(d)}.bind(this)}))},evaluateJson:function(a){var b=null;if((a=a.responseText)&&a.toString().strip().length>0)b=eval("("+a+")");return b},depopulate:function(){for(var a=$(this.options.hitContainer||this.options.fieldContainer.nextSibling);a.firstChild;)a.removeChild(a.firstChild);
a.hide();this.selectionElement=null},populate:function(a,b){this.depopulate();if(this.options.maxHits&&b.length>this.options.maxHits){this.display_max_hits_warning=true;b=b.slice(0,this.options.maxHits)}var c=$(this.options.hitContainer||this.options.fieldContainer.nextSibling),d=this.createHitHeader(a,b);d&&c.appendChild(d);d=$(document.createElement("table"));d.className="hit_table";c.appendChild(d);var e=$(document.createElement("tbody"));d.appendChild(e);var g=null;b.each(function(n,l){if(l%1==
0){g=$(document.createElement("tr"));e.appendChild(g)}l=$(document.createElement("td"));var m=$(document.createElement("div"));m.className="hit";m.innerHTML=n.html;l.appendChild(m);g.appendChild(l)}.bind(this));(a=this.createHitFooter(a,b))&&c.appendChild(a);c.show()},createHitHeader:function(a,b){var c=$(document.createElement("div"));if(this.display_max_hits_warning){c.className="max_hits";c.innerHTML=_("Vi kunne ikke vise alle treffene. Skriv litt mer for \u00e5 snevre inn s\u00f8ket.")}else if(b.length==
0)if(this.options.allowCreation){c.className="create_offer";if(this.options.willBeCreated){a=_("<strong>%s</strong> vil bli opprettet. Vil du fylle ut mer informasjon?",a);b=_("Ja takk!")}else{if(this.options.required){c.className="no_results";a=_("Beklager, <strong>%s</strong> fant vi ikke.",a)}else a=_("Du kan opprette <strong>%s</strong> om du vil.",a);b=_("Opprett stedet")}c.innerHTML=a;c.appendChild(document.createTextNode(" "));b=Button.linkToFunction(b,function(){this.showForm();return false}.bind(this),
{color:"green"});c.appendChild(b)}else{c.className="no_results";c.innerHTML=_("Beklager, ingen treff p\u00e5 <strong>%s</strong>.",a)}else if(this.options.allowCreation){c.className="hit_header";c.appendChild(document.createTextNode(this.getHitHeaderText(b)))}return c},getHitHeaderText:function(a){return a.length==1?_("Mente du dette?"):_("Mente du en av disse?")},createHitFooter:function(a,b){if(this.options.allowCreation)if(b.length>0){a=$(document.createElement("div"));a.className="hit_footer";
a.appendChild(document.createTextNode(_("Stod det ikke der?")));a.appendChild(document.createTextNode(" "));b=Button.linkToFunction(this.getHitFooterText(),function(){this.showForm();return false}.bind(this),{color:"green"});a.appendChild(b);return a}},getHitFooterText:function(){return _("Opprett nytt sted")},showForm:function(){var a=$(this.options.createForm);if(a){Form.getElements(a).each(function(b){b.disabled=""});if(!a.visible()){$(this.options.fieldContainer).hide();$(this.options.hitContainer).hide();
a.show();if(a=(new Selector("input[type=text]")).findElements(a)[0]){if(a.value=="")a.value=this.searchField.value;a.focus()}$(this.options.klass);field.value="";field.disabled="true";GoogleMapsSupport.checkAllResize()}this.searchField.blur();this.searchField.disabled="true"}},unselect:function(){this.depopulate();$(this.options.fieldContainer).show();this.searchField.disabled="";this.searchField.focus()},makeSelection:function(a){var b=$(document.createElement("div")),c=$(document.createElement("img"));
c.src="/images/action_icons/remove_24.png";c.alt=_("Fjern valg");c.title=c.alt;var d=$(document.createElement("a"));d.href="#";d.observe("click",function(e){this.unselect();this.searchField.value="";Event.stop(e)}.bind(this));d.className="picker_change_link";d.appendChild(c);b.appendChild(d);c=$(document.createElement("span"));c.innerHTML=a.html;this.stripHighlight(c);b.appendChild(c);return b},stripHighlight:function(a){(new Selector("strong.highlight")).findElements(a).each(function(b){for(var c=
$(document.createElement("span"));b.firstChild;){var d=b.firstChild;b.removeChild(d);c.appendChild(d)}b.parentNode.replaceChild(c,b);throw $break;})},setRequest:function(a){if(this.request){if(this.request.transport)try{this.request.transport.abort()}catch(b){}this.request=null}this.request=a}};
var WizardStep=Class.create({initialize:function(a,b){this.number=a;this.stepElement=b;this.enabled=true},enable:function(){this.stepElement.style.visibility="visible"},disable:function(){this.stepElement.style.visibility="hidden"},setHasNext:function(a){this.stepElement.select(".wizard_step_next_button").each(function(b){b.style.display=a?"":"none"});this.stepElement.select(".wizard_step_finish_button").each(function(b){b.style.display=!a?"":"none"})},isAutoAccept:function(){return this.stepElement.select(".live_validation_auto_accept").length>
0},entered:function(){this._entered=true;this.stepElement.show();this.stepElement.select(".live_validation_auto_accept").each(function(a){a.addClassName("live_validation_accepted")})},update:function(){var a=this.isValid();this.stepElement.select(".wizard_step_next_button").each(function(b){b.setOpacity(a?1:0.3)})},isExplicitlyInvalid:function(){return this.stepElement.select(".live_validation.live_validation_rejected").length>0},isValid:function(){if(!this._entered)return false;var a=0,b=0,c=0;this.stepElement.select(".live_validation").each(function(d){if(d.getWidth()>
0){if(d.hasClassName("live_validation_accepted"))b++;else c++;a++}});return b==a&&c==0}}),WizardController=Class.create({initialize:function(a){this.stepsElement=$(a);this.steps=[];this.currentIndex=0;this.pager=new SimpleHorizontalPager(this.stepsElement.select(".wizard_items")[0],{smoothScroll:false});this.setup()},setup:function(){for(var a=0;a<999;a++){var b=this.stepsElement.select(".wizard_step_"+(a+1))[0];if(!b)break;var c=new WizardStep(a,b);c.title=b.title;c.setHasNext(true);this.steps.push(c)}this.steps.length>
0&&this.steps[this.steps.length-1].setHasNext(false);window.setInterval(this.update.bind(this),1E3);this.goToStep(0)},currentStep:function(){return this.steps[this.currentIndex]},lastStep:function(){return this.steps[this.steps.length-1]},goToStep:function(a){if(this.checkIfMayJumpTo(a)){for(var b=this.currentIndex;b<=a;b++)this.steps[b].entered();this.currentIndex=a;this.pager.moveTo(a);new Effect.ScrollElementTo(document.documentElement.scrollTop?document.documentElement:document.body,{toY:this.stepsElement.cumulativeOffset().top,
duration:0.5});this.moved()}},goPrevious:function(){this.currentIndex>0&&this.goToStep(this.currentIndex-1)},goNext:function(){this.currentIndex<this.steps.length-1&&this.checkIfMayJumpTo(this.currentIndex+1)&&this.goToStep(this.currentIndex+1)},checkIfMayJumpTo:function(a){for(var b=this.currentIndex;b<a;b++){var c=this.steps[b];if(!(c.isAutoAccept()||c.isValid())){this.goToStep(b);alert(_("Du m\u00e5 fylle ut feltene riktig f\u00f8r du kan g\u00e5 videre."));return false}}return true},moved:function(){this.stepsElement.select(".wizard_step_previous_button").each(function(a){a.style.display=
this.currentIndex>0?"":"none"}.bind(this));this.stepsElement.select(".wizard_navigation li").each(function(a){a.removeClassName("active")});this.stepsElement.select(".wizard_navigation li.wizard_navigation_for_step_"+(this.currentIndex+1)).each(function(a){a.addClassName("active")});this.update()},update:function(){for(var a=null,b=0;b<this.steps.length;b++){var c=this.steps[b];b==0||a?c.enable():c.disable();c.update();this.stepsElement.select(".wizard_navigation li.wizard_navigation_for_step_"+(b+
1)).each(function(d){if(c.isValid()){d.addClassName("valid");d.removeClassName("invalid")}else if(c.isExplicitlyInvalid()){d.addClassName("invalid");d.removeClassName("valid")}else{d.removeClassName("valid");d.removeClassName("invalid")}});if(a==null||a)a=c.isValid()}}}),GlobalMenu=Class.create({initialize:function(){this.logo=$("global_header_logo");this.logo.observe("mouseover",this.showIfGotFocus.bind(this));this.logo.observe("click",this.toggle.bind(this));this.hasFocus=true;Event.observe(window,
"focus",function(){this.hasFocus=true}.bind(this));Event.observe(window,"blur",function(){this.hasFocus=false}.bind(this));this.menu=$("global_menu_container");this._handleMouseMoveObserver=this._handleMouseMove.bind(this);this.screenshotCount=16;this.screenshotIndex=0;this.firstTime=true;$(document.documentElement).observe("mousemove",this._handleMouseMoveObserver)},toggle:function(){this.showing?this.hide():this.show()},showIfGotFocus:function(){this.hasFocus&&this.show()},show:function(){if(!this.showing){this.showing=
true;ObscuringElements.hide(function(b){return!(b==this.menu||b.childOf(this.menu))}.bind(this));this.logo.addClassName("active");this.menu.show();this._goToNextScreenshot();this.animationIntervalId=window.setInterval(this._goToNextScreenshot.bind(this),3E3);if(this.firstTime){this.firstTime=false;var a=$("global_menu_sandboxes_container");a&&new Ajax.Request("/-/user/top_sandboxes",{method:"GET",onLoading:function(){a.addClassName("global_menu_sandboxes_loading")},onSuccess:function(b,c){if(c=c||
eval("("+b.responseText+")")){var d=$(document.createElement("ul"));c.each(function(e){var g=$(document.createElement("li")),n=$(document.createElement("a"));n.setAttribute("href",e.url);n.appendChild(document.createTextNode(e.title));g.appendChild(n);d.appendChild(g)});a.appendChild(d)}},onComplete:function(){a.removeClassName("global_menu_sandboxes_loading")},onException:function(){a.innerHTML=_("Noe gikk galt i lastingen.")}})}}},hide:function(){if(this.showing){this.showing=false;ObscuringElements.show();
if(this.animationIntervalId){window.clearInterval(this.animationIntervalId);this.animationIntervalId=null}this.menu.hide();this.logo.removeClassName("active")}},_handleMouseMove:function(a){if(this.showing)this._within(this.menu,a.pointerX(),a.pointerY())||this._within(this.logo,a.pointerX(),a.pointerY())||this.hide()},_within:function(a,b,c){var d=a.cumulativeOffset();a=a.getDimensions();return b>=d.left&&b<d.left+a.width&&c>=d.top&&c<d.top+a.height},_goToNextScreenshot:function(){var a=$("global_menu_brag_screenshots");
if(a){if(a.select("img").length==0)for(var b=1;b<=16;b++){var c=$(document.createElement("img"));c.src=Application.assetHost("/images/screenshots/brag/"+b+".png");c.style.display="none";a.appendChild(c)}for(a=this.screenshotIndex;a==this.screenshotIndex;)this.screenshotIndex=Math.floor(Math.random()*this.screenshotCount);new Effect.Fade($$("#global_menu_brag_screenshots img")[a],{duration:1,to:0});new Effect.Appear($$("#global_menu_brag_screenshots img")[this.screenshotIndex],{duration:1,to:1})}}}),
Actionables=Class.create({initialize:function(){this._element=$("actionables");this._count=this._index=0;this._itemElements=[]},render:function(){this._element.select("li").each(function(a){a.hide();this._itemElements.push(a)}.bind(this));this._count=this._itemElements.length;this._setCurrentElement(this._itemElements[0]);this._changed();return this},action:function(a,b){window.location=b},dismiss:function(a){new Ajax.Request("/-/site/dismiss_actionable/"+a,{method:"POST",onLoading:function(){$("actionables_content").addClassName("progressing")}.bind(this),
onSuccess:function(){var b=this._element.select("li#actionable_"+a)[0];if(b){this._itemElements=this._itemElements.without(b);this._index+=1;this._changed();this._setCurrentElement(this._itemElements[0])}}.bind(this),onComplete:function(){$("actionables_content").removeClassName("progressing")}.bind(this),onFailure:function(b){Errors.reportForAjax(b)},onException:function(b){Errors.reportForAjax(b)}})},_setCurrentElement:function(a){this._currentElement&&new Effect.BlindUp(this._currentElement,{duration:0.5,
queue:"end"});(this._currentElement=a)&&new Effect.BlindDown(this._currentElement,{duration:0.5,queue:"end"})},_changed:function(){if(this._index<this._count){if(this._count>1){$("actionables_header").innerHTML="<span>"+_("%d av %d meldinger",this._index+1,this._count)+"</span>";$("actionables_header").show()}else $("actionables_header").hide();this._element.show()}else this._element.hide()}}),BasicCompleter=Class.create();
BasicCompleter.prototype={initialize:function(a,b){b=b||{};this.url=a;this.matches=null;this.loading=false;this.pendingCompletion=null;this.alwaysQuery=b.alwaysQuery!=false},beginComplete:function(a,b){a=this._normalizeText(a);if(!this.matches&&this.pendingCompletion!=a&&a.length>0){this.pendingCompletion=a;if(this.alwaysQuery&&this.loading){this.request&&this.request.transport&&this.request.transport.abort();this.request=null;this.loading=false}if(!this.loading)this.request=new Ajax.Request(this.url,
{evalScripts:false,parameters:"q="+a,onFailure:function(c){Errors.reportForAjax(c)}.bind(this),onLoading:function(){this.loading=true}.bind(this),onSuccess:function(c){if(c=this.evaluateJson(c)){this.matches=c.names;b(this.completePending());if(this.alwaysQuery)this.matches=null}}.bind(this),onComplete:function(){this.loading=false}.bind(this),onException:function(c,d){Errors.log(d)}.bind(this)});return true}else{b(this.complete(a));return false}},completePending:function(){var a=this.pendingCompletion||
"";this.pendingCompletion=null;return this.complete(a)},complete:function(a){var b=[];if(a.length>0&&this.matches){a=a.toLowerCase();this.matches._each(function(d){if(d.name.toLowerCase().indexOf(a)==0){d.text=d.name;b.push(d)}});this.matches._each(function(d){if(d.name.toLowerCase().indexOf(a)>0){d.text=d.name;b.push(d)}});if(b.length>20){var c=b.length-20;b=b.slice(0,20);b.push(new TokenCompletionContinuation(c))}}return b},evaluateJson:function(a){var b=null;if((a=a.responseText)&&a.toString().strip().length>
0)try{b=eval("("+a+")")}catch(c){Errors.log(c)}return b},_normalizeText:function(a){return a.toString().strip()}};BasicCompleter.getInstance=function(a){if(!this.instances)this.instances=$H();var b=this.instances[a];b||(b=this.instances[a]=new BasicCompleter(a));return b};current_tracker_request={};
function trackers_openCategory(a,b,c,d,e){current_tracker_request[b]&&current_tracker_request[b].transport.abort();if(a){$(d).innerHTML="";$$("."+b+" .tracker_category").each(function(g){g.removeClassName("selected")});c&&$$("."+c)[0].addClassName("selected")}$(d).insert({bottom:'<div class="tracker_items_loading"><img src="/images/progress/lights.gif"/></div>'});e.component_class=b;e.content_id=d;current_tracker_request[b]=new Ajax.Updater({success:d},"/-/tracker/embedded_list",{asynchronous:true,
parameters:e,evalScripts:true,insertion:a?null:Insertion.Bottom,onSuccess:function(){$$("."+b+" .tracker_items_loading")[0].remove();delete current_tracker_request[b]}})};
